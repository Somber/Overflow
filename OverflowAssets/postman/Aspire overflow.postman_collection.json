{
	"info": {
		"_postman_id": "c7349ae4-428e-4d8c-8479-88cb9e57bc33",
		"name": "Aspire overflow",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json",
		"_exporter_id": "2726016",
		"_collection_link": "https://restless-satellite-764890.postman.co/workspace/Aspire~b40557b9-057f-4725-865b-640779163f11/collection/2726016-c7349ae4-428e-4d8c-8479-88cb9e57bc33?action=share&source=collection_link&creator=2726016"
	},
	"item": [
		{
			"name": "Section 2 Identity",
			"item": [
				{
					"name": "Login as bob",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"const user = pm.response.json();",
									"",
									"pm.test(\"Has properties\", function () {",
									"    pm.expect(user).to.have.property('access_token');",
									"});",
									"",
									"if (pm.test(\"Has properties\")) {",
									"    pm.globals.set('bob_token', user.access_token);",
									"}"
								],
								"type": "text/javascript",
								"packages": {}
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [],
						"body": {
							"mode": "urlencoded",
							"urlencoded": [
								{
									"key": "username",
									"value": "bob",
									"type": "text"
								},
								{
									"key": "password",
									"value": "Pa$$w0rd",
									"type": "text"
								},
								{
									"key": "client_id",
									"value": "postman",
									"type": "text"
								},
								{
									"key": "grant_type",
									"value": "password",
									"type": "text"
								},
								{
									"key": "client_secret",
									"value": "zWJYJbQJ2ygrDvDxFSdhs8MSroFlGZcs",
									"type": "text",
									"disabled": true
								}
							]
						},
						"url": {
							"raw": "{{identityApi}}/realms/overflow/protocol/openid-connect/token",
							"host": [
								"{{identityApi}}"
							],
							"path": [
								"realms",
								"overflow",
								"protocol",
								"openid-connect",
								"token"
							]
						}
					},
					"response": []
				},
				{
					"name": "Get well known config",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{identityApi}}/realms/overflow/.well-known/openid-configuration",
							"host": [
								"{{identityApi}}"
							],
							"path": [
								"realms",
								"overflow",
								".well-known",
								"openid-configuration"
							]
						}
					},
					"response": []
				}
			]
		},
		{
			"name": "Section 3 Question Svc",
			"item": [
				{
					"name": "Login as bob",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"const user = pm.response.json();",
									"",
									"pm.test(\"Has properties\", function () {",
									"    pm.expect(user).to.have.property('access_token');",
									"});",
									"",
									"if (pm.test(\"Has properties\")) {",
									"    pm.globals.set('bob_token', user.access_token);",
									"}"
								],
								"type": "text/javascript",
								"packages": {}
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [],
						"body": {
							"mode": "urlencoded",
							"urlencoded": [
								{
									"key": "username",
									"value": "bob",
									"type": "text"
								},
								{
									"key": "password",
									"value": "Pa$$w0rd",
									"type": "text"
								},
								{
									"key": "client_id",
									"value": "postman",
									"type": "text"
								},
								{
									"key": "grant_type",
									"value": "password",
									"type": "text"
								},
								{
									"key": "client_secret",
									"value": "zWJYJbQJ2ygrDvDxFSdhs8MSroFlGZcs",
									"type": "text",
									"disabled": true
								}
							]
						},
						"url": {
							"raw": "{{identityApi}}/realms/overflow/protocol/openid-connect/token",
							"host": [
								"{{identityApi}}"
							],
							"path": [
								"realms",
								"overflow",
								"protocol",
								"openid-connect",
								"token"
							]
						}
					},
					"response": []
				},
				{
					"name": "GetWeatherForecast",
					"protocolProfileBehavior": {
						"disableBodyPruning": true
					},
					"request": {
						"auth": {
							"type": "noauth"
						},
						"method": "GET",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"title\": \"{{$randomLoremWords}}\",\n    \"content\": \"{{escapedContent}}\",\n    \"tags\": [\"aspire\", \"fake\"]\n}"
						},
						"url": {
							"raw": "{{questionsApi}}/weatherforecast",
							"host": [
								"{{questionsApi}}"
							],
							"path": [
								"weatherforecast"
							]
						}
					},
					"response": []
				},
				{
					"name": "GetHealth",
					"protocolProfileBehavior": {
						"disableBodyPruning": true
					},
					"request": {
						"auth": {
							"type": "noauth"
						},
						"method": "GET",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"title\": \"{{$randomLoremWords}}\",\n    \"content\": \"{{escapedContent}}\",\n    \"tags\": [\"aspire\", \"fake\"]\n}"
						},
						"url": {
							"raw": "{{questionsApi}}/health",
							"host": [
								"{{questionsApi}}"
							],
							"path": [
								"health"
							]
						}
					},
					"response": []
				},
				{
					"name": "GetAlive",
					"protocolProfileBehavior": {
						"disableBodyPruning": true
					},
					"request": {
						"auth": {
							"type": "noauth"
						},
						"method": "GET",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"title\": \"{{$randomLoremWords}}\",\n    \"content\": \"{{escapedContent}}\",\n    \"tags\": [\"aspire\", \"fake\"]\n}"
						},
						"url": {
							"raw": "{{questionsApi}}/alive",
							"host": [
								"{{questionsApi}}"
							],
							"path": [
								"alive"
							]
						}
					},
					"response": []
				},
				{
					"name": "GetWeatherForecast With Auth",
					"protocolProfileBehavior": {
						"disableBodyPruning": true
					},
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{bob_token}}",
									"type": "string"
								}
							]
						},
						"method": "GET",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"title\": \"{{$randomLoremWords}}\",\n    \"content\": \"{{escapedContent}}\",\n    \"tags\": [\"aspire\", \"fake\"]\n}"
						},
						"url": {
							"raw": "{{questionsApi}}/weatherforecast",
							"host": [
								"{{questionsApi}}"
							],
							"path": [
								"weatherforecast"
							]
						}
					},
					"response": []
				},
				{
					"name": "Post question",
					"event": [
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									"const raw = pm.variables.replaceIn(\"{{$randomLoremParagraphs}}\");",
									"",
									"// Split on newlines, wrap each line in <p> tags, then join",
									"const html = raw",
									"  .split('\\n')",
									"  .filter(p => p.trim().length > 0)",
									"  .map(p => `<p>${p}</p>`)",
									"  .join('');",
									"",
									"pm.environment.set(\"escapedContent\", JSON.stringify(html).slice(1, -1));",
									"",
									"const allTags = [\"aspire\", \"dotnet\", \"keycloak\", \"wolverine\", \"ef-core\", \"postgresql\", \"signalr\", \"microservices\", \"nextjs\", \"typescript\"];",
									"",
									"// Pick 1 or 2 tags at random",
									"const shuffled = allTags.sort(() => 0.5 - Math.random());",
									"const selectedTags = shuffled.slice(0, Math.floor(Math.random() * 2) + 1);",
									"",
									"// Set as environment variable for use in body",
									"pm.environment.set('selectedTags', JSON.stringify(selectedTags));"
								],
								"type": "text/javascript",
								"packages": {}
							}
						},
						{
							"listen": "test",
							"script": {
								"exec": [
									"const question = pm.response.json();",
									"",
									"pm.test(\"Has properties\", function () {",
									"    pm.expect(question).to.have.property('id');",
									"});",
									"",
									"if (pm.test(\"Has properties\")) {",
									"    pm.globals.set('questionId', question.id);",
									"}"
								],
								"type": "text/javascript",
								"packages": {}
							}
						}
					],
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{bob_token}}",
									"type": "string"
								}
							]
						},
						"method": "POST",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"title\": \"{{$randomPhrase}}\",\n    \"content\": \"{{escapedContent}}\",\n    \"tags\": {{selectedTags}}\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{questionsApi}}/questions",
							"host": [
								"{{questionsApi}}"
							],
							"path": [
								"questions"
							]
						}
					},
					"response": []
				},
				{
					"name": "Post question missing fields",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Is bad request\", function () {",
									"    pm.response.to.have.status(400)",
									"});"
								],
								"type": "text/javascript",
								"packages": {}
							}
						},
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									"const raw = pm.variables.replaceIn(\"{{$randomLoremParagraphs}}\");",
									"",
									"// Split on newlines, wrap each line in <p> tags, then join",
									"const html = raw",
									"  .split('\\n')",
									"  .filter(p => p.trim().length > 0)",
									"  .map(p => `<p>${p}</p>`)",
									"  .join('');",
									"",
									"pm.environment.set(\"escapedContent\", JSON.stringify(html).slice(1, -1));",
									"",
									"const allTags = [\"aspire\", \"dotnet\", \"keycloak\", \"wolverine\", \"ef-core\", \"postgresql\", \"signalr\", \"microservices\", \"nextjs\", \"typescript\"];",
									"",
									"// Pick 1 or 2 tags at random",
									"const shuffled = allTags.sort(() => 0.5 - Math.random());",
									"const selectedTags = shuffled.slice(0, Math.floor(Math.random() * 2) + 1);",
									"",
									"// Set as environment variable for use in body",
									"pm.environment.set('selectedTags', JSON.stringify(selectedTags));"
								],
								"type": "text/javascript",
								"packages": {}
							}
						}
					],
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{bob_token}}",
									"type": "string"
								}
							]
						},
						"method": "POST",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"title\": \"{{$randomPhrase}}\",\n    \"content\": \"\",\n    \"tags\": []\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{questionsApi}}/questions",
							"host": [
								"{{questionsApi}}"
							],
							"path": [
								"questions"
							]
						}
					},
					"response": []
				},
				{
					"name": "Post question with fake tag",
					"event": [
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									"const raw = pm.variables.replaceIn(\"{{$randomLoremParagraphs}}\");",
									"",
									"// Split on newlines, wrap each line in <p> tags, then join",
									"const html = raw",
									"  .split('\\n')",
									"  .filter(p => p.trim().length > 0)",
									"  .map(p => `<p>${p}</p>`)",
									"  .join('');",
									"",
									"pm.environment.set(\"escapedContent\", JSON.stringify(html).slice(1, -1));",
									"",
									"const allTags = [\"aspire\", \"dotnet\", \"keycloak\", \"wolverine\", \"ef-core\", \"postgresql\", \"signalr\", \"microservices\", \"nextjs\", \"typescript\"];",
									"",
									"// Pick 1 or 2 tags at random",
									"const shuffled = allTags.sort(() => 0.5 - Math.random());",
									"const selectedTags = shuffled.slice(0, Math.floor(Math.random() * 2) + 1);",
									"",
									"// Set as environment variable for use in body",
									"pm.environment.set('selectedTags', JSON.stringify(selectedTags));"
								],
								"type": "text/javascript",
								"packages": {}
							}
						},
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"is bad request\", function () {",
									"    pm.response.to.have.status(400);",
									"});",
									"",
									"if (pm.test(\"Has bad request ms\")) {",
									"    pm.response.to.have.body('Invalid tags: fake')",
									"}"
								],
								"type": "text/javascript",
								"packages": {}
							}
						}
					],
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{bob_token}}",
									"type": "string"
								}
							]
						},
						"method": "POST",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"title\": \"{{$randomPhrase}}\",\n    \"content\": \"{{escapedContent}}\",\n    \"tags\": [\"aspire\", \"fake\"]\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{questionsApi}}/questions",
							"host": [
								"{{questionsApi}}"
							],
							"path": [
								"questions"
							]
						}
					},
					"response": []
				},
				{
					"name": "Get Questions",
					"request": {
						"auth": {
							"type": "noauth"
						},
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{questionsApi}}/questions",
							"host": [
								"{{questionsApi}}"
							],
							"path": [
								"questions"
							]
						}
					},
					"response": []
				},
				{
					"name": "Get Question by ID",
					"protocolProfileBehavior": {
						"disableBodyPruning": true
					},
					"request": {
						"auth": {
							"type": "noauth"
						},
						"method": "GET",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"title\": \"{{$randomLoremWords}}\",\n    \"content\": \"{{$randomLoremParagraphs}}\"\n}"
						},
						"url": {
							"raw": "{{questionsApi}}/questions/{{questionId}}",
							"host": [
								"{{questionsApi}}"
							],
							"path": [
								"questions",
								"{{questionId}}"
							]
						}
					},
					"response": []
				},
				{
					"name": "Get Questions By Tag",
					"request": {
						"auth": {
							"type": "noauth"
						},
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{questionsApi}}/questions?tag=aspire",
							"host": [
								"{{questionsApi}}"
							],
							"path": [
								"questions"
							],
							"query": [
								{
									"key": "tag",
									"value": "aspire"
								}
							]
						}
					},
					"response": []
				},
				{
					"name": "Get tags",
					"request": {
						"auth": {
							"type": "noauth"
						},
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{questionsApi}}/tags",
							"host": [
								"{{questionsApi}}"
							],
							"path": [
								"tags"
							]
						}
					},
					"response": []
				},
				{
					"name": "Update question",
					"event": [
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									"const raw = pm.variables.replaceIn(\"{{$randomLoremParagraphs}}\");",
									"",
									"// Split on newlines, wrap each line in <p> tags, then join",
									"const html = raw",
									"  .split('\\n')",
									"  .filter(p => p.trim().length > 0)",
									"  .map(p => `<p>${p}</p>`)",
									"  .join('');",
									"",
									"pm.environment.set(\"escapedContent\", JSON.stringify(html).slice(1, -1));",
									"",
									"const allTags = [\"aspire\", \"dotnet\", \"keycloak\", \"wolverine\", \"ef-core\", \"postgresql\", \"signalr\", \"microservices\", \"nextjs\", \"typescript\"];",
									"",
									"// Pick 1 or 2 tags at random",
									"const shuffled = allTags.sort(() => 0.5 - Math.random());",
									"const selectedTags = shuffled.slice(0, Math.floor(Math.random() * 2) + 1);",
									"",
									"// Set as environment variable for use in body",
									"pm.environment.set('selectedTags', JSON.stringify(selectedTags));"
								],
								"type": "text/javascript",
								"packages": {}
							}
						},
						{
							"listen": "test",
							"script": {
								"exec": [
									""
								],
								"type": "text/javascript",
								"packages": {}
							}
						}
					],
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{bob_token}}",
									"type": "string"
								}
							]
						},
						"method": "PUT",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"title\": \"{{$randomPhrase}} updated!!\",\n    \"content\": \"{{escapedContent}} which has been updated\",\n    \"tags\": {{selectedTags}}\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{questionsApi}}/questions/{{questionId}}",
							"host": [
								"{{questionsApi}}"
							],
							"path": [
								"questions",
								"{{questionId}}"
							]
						}
					},
					"response": []
				},
				{
					"name": "Delete question",
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{bob_token}}",
									"type": "string"
								}
							]
						},
						"method": "DELETE",
						"header": [],
						"url": {
							"raw": "{{questionsApi}}/questions/{{questionId}}",
							"host": [
								"{{questionsApi}}"
							],
							"path": [
								"questions",
								"{{questionId}}"
							]
						}
					},
					"response": []
				}
			]
		},
		{
			"name": "Section 4 Search Svc",
			"item": [
				{
					"name": "Login as bob",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"const user = pm.response.json();",
									"",
									"pm.test(\"Has properties\", function () {",
									"    pm.expect(user).to.have.property('access_token');",
									"});",
									"",
									"if (pm.test(\"Has properties\")) {",
									"    pm.globals.set('bob_token', user.access_token);",
									"}"
								],
								"type": "text/javascript",
								"packages": {}
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [],
						"body": {
							"mode": "urlencoded",
							"urlencoded": [
								{
									"key": "username",
									"value": "bob",
									"type": "text"
								},
								{
									"key": "password",
									"value": "Pa$$w0rd",
									"type": "text"
								},
								{
									"key": "client_id",
									"value": "postman",
									"type": "text"
								},
								{
									"key": "grant_type",
									"value": "password",
									"type": "text"
								},
								{
									"key": "client_secret",
									"value": "zWJYJbQJ2ygrDvDxFSdhs8MSroFlGZcs",
									"type": "text",
									"disabled": true
								}
							]
						},
						"url": {
							"raw": "{{identityApi}}/realms/overflow/protocol/openid-connect/token",
							"host": [
								"{{identityApi}}"
							],
							"path": [
								"realms",
								"overflow",
								"protocol",
								"openid-connect",
								"token"
							]
						}
					},
					"response": []
				},
				{
					"name": "Post question",
					"event": [
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									"const raw = pm.variables.replaceIn(\"{{$randomLoremParagraphs}}\");",
									"",
									"// Split on newlines, wrap each line in <p> tags, then join",
									"const html = raw",
									"  .split('\\n')",
									"  .filter(p => p.trim().length > 0)",
									"  .map(p => `<p>${p}</p>`)",
									"  .join('');",
									"",
									"pm.environment.set(\"escapedContent\", JSON.stringify(html).slice(1, -1));",
									"",
									"const allTags = [\"aspire\", \"dotnet\", \"keycloak\", \"wolverine\", \"ef-core\", \"postgresql\", \"signalr\", \"microservices\", \"nextjs\", \"typescript\"];",
									"",
									"// Pick 1 or 2 tags at random",
									"const shuffled = allTags.sort(() => 0.5 - Math.random());",
									"const selectedTags = shuffled.slice(0, Math.floor(Math.random() * 2) + 1);",
									"",
									"// Set as environment variable for use in body",
									"pm.environment.set('selectedTags', JSON.stringify(selectedTags));"
								],
								"type": "text/javascript",
								"packages": {}
							}
						},
						{
							"listen": "test",
							"script": {
								"exec": [
									"const question = pm.response.json();",
									"",
									"pm.test(\"Has properties\", function () {",
									"    pm.expect(question).to.have.property('id');",
									"});",
									"",
									"if (pm.test(\"Has properties\")) {",
									"    pm.globals.set('questionId', question.id);",
									"}"
								],
								"type": "text/javascript",
								"packages": {}
							}
						}
					],
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{bob_token}}",
									"type": "string"
								}
							]
						},
						"method": "POST",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"title\": \"{{$randomPhrase}}\",\n    \"content\": \"{{escapedContent}}\",\n    \"tags\": {{selectedTags}}\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{questionsApi}}/questions",
							"host": [
								"{{questionsApi}}"
							],
							"path": [
								"questions"
							]
						}
					},
					"response": []
				},
				{
					"name": "Post question Demo",
					"event": [
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									"const raw = pm.variables.replaceIn(\"{{$randomLoremParagraphs}}\");",
									"",
									"// Split on newlines, wrap each line in <p> tags, then join",
									"const html = raw",
									"  .split('\\n')",
									"  .filter(p => p.trim().length > 0)",
									"  .map(p => `<p>${p}</p>`)",
									"  .join('');",
									"",
									"pm.environment.set(\"escapedContent\", JSON.stringify(html).slice(1, -1));",
									"",
									"const allTags = [\"aspire\", \"dotnet\", \"keycloak\", \"wolverine\", \"ef-core\", \"postgresql\", \"signalr\", \"microservices\", \"nextjs\", \"typescript\"];",
									"",
									"// Pick 1 or 2 tags at random",
									"const shuffled = allTags.sort(() => 0.5 - Math.random());",
									"const selectedTags = shuffled.slice(0, Math.floor(Math.random() * 2) + 1);",
									"",
									"// Set as environment variable for use in body",
									"pm.environment.set('selectedTags', JSON.stringify(selectedTags));"
								],
								"type": "text/javascript",
								"packages": {}
							}
						},
						{
							"listen": "test",
							"script": {
								"exec": [
									"const question = pm.response.json();",
									"",
									"pm.test(\"Has properties\", function () {",
									"    pm.expect(question).to.have.property('id');",
									"});",
									"",
									"if (pm.test(\"Has properties\")) {",
									"    pm.globals.set('questionId', question.id);",
									"}"
								],
								"type": "text/javascript",
								"packages": {}
							}
						}
					],
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{bob_token}}",
									"type": "string"
								}
							]
						},
						"method": "POST",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"title\": \"Rabbit demo\",\n    \"content\": \"The quick brown fox jumped over the lazy dog\",\n    \"tags\": {{selectedTags}}\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{questionsApi}}/questions",
							"host": [
								"{{questionsApi}}"
							],
							"path": [
								"questions"
							]
						}
					},
					"response": []
				},
				{
					"name": "Get questions with search",
					"protocolProfileBehavior": {
						"disableBodyPruning": true
					},
					"request": {
						"auth": {
							"type": "noauth"
						},
						"method": "GET",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"title\": \"{{$randomLoremWords}}\",\n    \"content\": \"{{escapedContent}}\",\n    \"tags\": {{selectedTags}}\n}"
						},
						"url": {
							"raw": "{{searchApi}}/search?query=rabbit",
							"host": [
								"{{searchApi}}"
							],
							"path": [
								"search"
							],
							"query": [
								{
									"key": "query",
									"value": "rabbit"
								}
							]
						}
					},
					"response": []
				},
				{
					"name": "Get questions with [tag] search",
					"protocolProfileBehavior": {
						"disableBodyPruning": true
					},
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{bob_token}}",
									"type": "string"
								}
							]
						},
						"method": "GET",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"title\": \"{{$randomLoremWords}}\",\n    \"content\": \"{{escapedContent}}\",\n    \"tags\": {{selectedTags}}\n}"
						},
						"url": {
							"raw": "{{searchApi}}/search?query=[keycloak]aut",
							"host": [
								"{{searchApi}}"
							],
							"path": [
								"search"
							],
							"query": [
								{
									"key": "query",
									"value": "[keycloak]aut"
								}
							]
						}
					},
					"response": []
				},
				{
					"name": "Update question",
					"event": [
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									"const raw = pm.variables.replaceIn(\"{{$randomLoremParagraphs}}\");",
									"",
									"// Split on newlines, wrap each line in <p> tags, then join",
									"const html = raw",
									"  .split('\\n')",
									"  .filter(p => p.trim().length > 0)",
									"  .map(p => `<p>${p}</p>`)",
									"  .join('');",
									"",
									"pm.environment.set(\"escapedContent\", JSON.stringify(html).slice(1, -1));",
									"",
									"const allTags = [\"aspire\", \"dotnet\", \"keycloak\", \"wolverine\", \"ef-core\", \"postgresql\", \"signalr\", \"microservices\", \"nextjs\", \"typescript\"];",
									"",
									"// Pick 1 or 2 tags at random",
									"const shuffled = allTags.sort(() => 0.5 - Math.random());",
									"const selectedTags = shuffled.slice(0, Math.floor(Math.random() * 2) + 1);",
									"",
									"// Set as environment variable for use in body",
									"pm.environment.set('selectedTags', JSON.stringify(selectedTags));"
								],
								"type": "text/javascript",
								"packages": {}
							}
						},
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Has 204 status code\", function () {",
									"    pm.response.to.have.status(204);",
									"});"
								],
								"type": "text/javascript",
								"packages": {}
							}
						}
					],
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{bob_token}}",
									"type": "string"
								}
							]
						},
						"method": "PUT",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"title\": \"{{$randomPhrase}} updated!!\",\n    \"content\": \"{{escapedContent}} which has been updated\",\n    \"tags\": {{selectedTags}}\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{questionsApi}}/questions/{{questionId}}",
							"host": [
								"{{questionsApi}}"
							],
							"path": [
								"questions",
								"{{questionId}}"
							]
						}
					},
					"response": []
				},
				{
					"name": "Delete question",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Has 204 status code\", function () {",
									"    pm.response.to.have.status(204);",
									"});"
								],
								"type": "text/javascript",
								"packages": {}
							}
						}
					],
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{bob_token}}",
									"type": "string"
								}
							]
						},
						"method": "DELETE",
						"header": [],
						"url": {
							"raw": "{{questionsApi}}/questions/{{questionId}}",
							"host": [
								"{{questionsApi}}"
							],
							"path": [
								"questions",
								"{{questionId}}"
							]
						}
					},
					"response": []
				},
				{
					"name": "Get similar title search",
					"protocolProfileBehavior": {
						"disableBodyPruning": true
					},
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{bob_token}}",
									"type": "string"
								}
							]
						},
						"method": "GET",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"title\": \"{{$randomLoremWords}}\",\n    \"content\": \"{{escapedContent}}\",\n    \"tags\": {{selectedTags}}\n}"
						},
						"url": {
							"raw": "{{searchApi}}/search/similar-titles?query=then you can navigate",
							"host": [
								"{{searchApi}}"
							],
							"path": [
								"search",
								"similar-titles"
							],
							"query": [
								{
									"key": "query",
									"value": "then you can navigate"
								}
							]
						}
					},
					"response": []
				}
			]
		},
		{
			"name": "Section 5 Answer Challenge",
			"item": [
				{
					"name": "Login as bob",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"const user = pm.response.json();",
									"",
									"pm.test(\"Has properties\", function () {",
									"    pm.expect(user).to.have.property('access_token');",
									"});",
									"",
									"if (pm.test(\"Has properties\")) {",
									"    pm.globals.set('bob_token', user.access_token);",
									"}"
								],
								"type": "text/javascript",
								"packages": {}
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [],
						"body": {
							"mode": "urlencoded",
							"urlencoded": [
								{
									"key": "username",
									"value": "bob",
									"type": "text"
								},
								{
									"key": "password",
									"value": "Pa$$w0rd",
									"type": "text"
								},
								{
									"key": "client_id",
									"value": "postman",
									"type": "text"
								},
								{
									"key": "grant_type",
									"value": "password",
									"type": "text"
								},
								{
									"key": "client_secret",
									"value": "zWJYJbQJ2ygrDvDxFSdhs8MSroFlGZcs",
									"type": "text",
									"disabled": true
								}
							]
						},
						"url": {
							"raw": "{{identityApi}}/realms/overflow/protocol/openid-connect/token",
							"host": [
								"{{identityApi}}"
							],
							"path": [
								"realms",
								"overflow",
								"protocol",
								"openid-connect",
								"token"
							]
						}
					},
					"response": []
				},
				{
					"name": "Post question",
					"event": [
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									"const raw = pm.variables.replaceIn(\"{{$randomLoremParagraphs}}\");",
									"",
									"// Split on newlines, wrap each line in <p> tags, then join",
									"const html = raw",
									"  .split('\\n')",
									"  .filter(p => p.trim().length > 0)",
									"  .map(p => `<p>${p}</p>`)",
									"  .join('');",
									"",
									"pm.environment.set(\"escapedContent\", JSON.stringify(html).slice(1, -1));",
									"",
									"const allTags = [\"aspire\", \"dotnet\", \"keycloak\", \"wolverine\", \"ef-core\", \"postgresql\", \"signalr\", \"microservices\", \"nextjs\", \"typescript\"];",
									"",
									"// Pick 1 or 2 tags at random",
									"const shuffled = allTags.sort(() => 0.5 - Math.random());",
									"const selectedTags = shuffled.slice(0, Math.floor(Math.random() * 2) + 1);",
									"",
									"// Set as environment variable for use in body",
									"pm.environment.set('selectedTags', JSON.stringify(selectedTags));"
								],
								"type": "text/javascript",
								"packages": {}
							}
						},
						{
							"listen": "test",
							"script": {
								"exec": [
									"const question = pm.response.json();",
									"",
									"pm.test(\"Has properties\", function () {",
									"    pm.expect(question).to.have.property('id');",
									"});",
									"",
									"if (pm.test(\"Has properties\")) {",
									"    pm.globals.set('questionId', question.id);",
									"    pm.globals.set('questionTitle', question.title);",
									"}"
								],
								"type": "text/javascript",
								"packages": {}
							}
						}
					],
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{bob_token}}",
									"type": "string"
								}
							]
						},
						"method": "POST",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"title\": \"{{$guid}}\",\n    \"content\": \"{{escapedContent}}\",\n    \"tags\": {{selectedTags}}\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{questionsApi}}/questions",
							"host": [
								"{{questionsApi}}"
							],
							"path": [
								"questions"
							]
						}
					},
					"response": []
				},
				{
					"name": "Post answer",
					"event": [
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									"const raw = pm.variables.replaceIn(\"{{$randomLoremParagraphs}}\");",
									"",
									"// Split on newlines, wrap each line in <p> tags, then join",
									"const html = raw",
									"  .split('\\n')",
									"  .filter(p => p.trim().length > 0)",
									"  .map(p => `<p>${p}</p>`)",
									"  .join('');",
									"",
									"pm.environment.set(\"escapedContent\", JSON.stringify(html).slice(1, -1));"
								],
								"type": "text/javascript",
								"packages": {}
							}
						},
						{
							"listen": "test",
							"script": {
								"exec": [
									"const answer = pm.response.json();",
									"",
									"pm.test(\"Has properties\", function () {",
									"    pm.expect(answer).to.have.property('id');",
									"});",
									"",
									"if (pm.test(\"Has properties\")) {",
									"    pm.globals.set('answerId', answer.id);",
									"}"
								],
								"type": "text/javascript",
								"packages": {}
							}
						}
					],
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{bob_token}}",
									"type": "string"
								}
							]
						},
						"method": "POST",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"content\": \"{{escapedContent}}\",\n    \"questionId\": \"{{questionId}}\"\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{questionsApi}}/questions/{{questionId}}/answers",
							"host": [
								"{{questionsApi}}"
							],
							"path": [
								"questions",
								"{{questionId}}",
								"answers"
							]
						}
					},
					"response": []
				},
				{
					"name": "Get Question (answerCount=1)",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"const question = pm.response.json();",
									"",
									"pm.test(\"Has answerCount of 1\"), function () {",
									"    pm.expect(question.answerCount).to.eql(1);",
									"}",
									"",
									"pm.test(\"Has answers length of 1\"), function () {",
									"    pm.expect(question.answers).to.be.an(\"array\").that.has.lengthOf(1);",
									"}"
								],
								"type": "text/javascript",
								"packages": {}
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{questionsApi}}/questions/{{questionId}}",
							"host": [
								"{{questionsApi}}"
							],
							"path": [
								"questions",
								"{{questionId}}"
							]
						}
					},
					"response": []
				},
				{
					"name": "Get Question from Search (answerCount=1)",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"answerCount is 1\", function () {",
									"    const json = pm.response.json();",
									"    pm.expect(json[0].answerCount).to.eql(1);",
									"});"
								],
								"type": "text/javascript",
								"packages": {}
							}
						},
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									"setTimeout(function(){}, 1000);"
								],
								"type": "text/javascript",
								"packages": {}
							}
						}
					],
					"protocolProfileBehavior": {
						"disableBodyPruning": true
					},
					"request": {
						"auth": {
							"type": "noauth"
						},
						"method": "GET",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"title\": \"{{$randomLoremWords}}\",\n    \"content\": \"{{$randomLoremParagraphs}}\"\n}"
						},
						"url": {
							"raw": "{{searchApi}}/search?query={{questionTitle}}",
							"host": [
								"{{searchApi}}"
							],
							"path": [
								"search"
							],
							"query": [
								{
									"key": "query",
									"value": "{{questionTitle}}"
								}
							]
						}
					},
					"response": []
				},
				{
					"name": "Update answer for question",
					"event": [
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									"const raw = pm.variables.replaceIn(\"{{$randomLoremParagraphs}}\");",
									"",
									"// Split on newlines, wrap each line in <p> tags, then join",
									"const html = raw",
									"  .split('\\n')",
									"  .filter(p => p.trim().length > 0)",
									"  .map(p => `<p>${p}</p>`)",
									"  .join('');",
									"",
									"pm.environment.set(\"escapedContent\", JSON.stringify(html).slice(1, -1));"
								],
								"type": "text/javascript",
								"packages": {}
							}
						},
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Response returns 204\", function () {",
									"    pm.response.to.have.status(204);",
									"});"
								],
								"type": "text/javascript",
								"packages": {}
							}
						}
					],
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{bob_token}}",
									"type": "string"
								}
							]
						},
						"method": "PUT",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"content\": \"{{escapedContent}} updated\"\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{questionsApi}}/questions/{{questionId}}/answers/{{answerId}}",
							"host": [
								"{{questionsApi}}"
							],
							"path": [
								"questions",
								"{{questionId}}",
								"answers",
								"{{answerId}}"
							]
						}
					},
					"response": []
				},
				{
					"name": "Get Question (answer.content contains updated)",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Answer contains 'updated'\", function () {",
									"    const response = pm.response.json();",
									"    const answerContent = response.answers?.[0]?.content || \"\";",
									"    pm.expect(answerContent.includes(\"updated\")).to.be.true;",
									"});"
								],
								"type": "text/javascript",
								"packages": {}
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{questionsApi}}/questions/{{questionId}}",
							"host": [
								"{{questionsApi}}"
							],
							"path": [
								"questions",
								"{{questionId}}"
							]
						}
					},
					"response": []
				},
				{
					"name": "Accept answer for question",
					"event": [
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									"const raw = pm.variables.replaceIn(\"{{$randomLoremParagraphs}}\");",
									"",
									"// Split on newlines, wrap each line in <p> tags, then join",
									"const html = raw",
									"  .split('\\n')",
									"  .filter(p => p.trim().length > 0)",
									"  .map(p => `<p>${p}</p>`)",
									"  .join('');",
									"",
									"pm.environment.set(\"escapedContent\", JSON.stringify(html).slice(1, -1));"
								],
								"type": "text/javascript",
								"packages": {}
							}
						},
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Response returns 204\", function () {",
									"    pm.response.to.have.status(204);",
									"});"
								],
								"type": "text/javascript",
								"packages": {}
							}
						}
					],
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{bob_token}}",
									"type": "string"
								}
							]
						},
						"method": "POST",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{questionsApi}}/questions/{{questionId}}/answers/{{answerId}}/accept",
							"host": [
								"{{questionsApi}}"
							],
							"path": [
								"questions",
								"{{questionId}}",
								"answers",
								"{{answerId}}",
								"accept"
							]
						}
					},
					"response": []
				},
				{
					"name": "Get Question (hasAcceptedAnswer=true)",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"const response = pm.response.json();",
									"",
									"pm.test(\"Question has accepted answer\", function () {",
									"    pm.expect(response.hasAcceptedAnswer).to.eql(true);",
									"});",
									"",
									"pm.test(\"Answer has accepted property of true\", function () {",
									"    pm.expect(response.answers[0].accepted).to.be.true;",
									"})"
								],
								"type": "text/javascript",
								"packages": {}
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{questionsApi}}/questions/{{questionId}}",
							"host": [
								"{{questionsApi}}"
							],
							"path": [
								"questions",
								"{{questionId}}"
							]
						}
					},
					"response": []
				},
				{
					"name": "Get Question from Search (HasAcceptedAnswer=true)",
					"event": [
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									"setTimeout(function(){}, 1000);"
								],
								"type": "text/javascript",
								"packages": {}
							}
						},
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Has accepted answer is true\", function () {",
									"    const json = pm.response.json();",
									"    pm.expect(json[0].hasAcceptedAnswer).to.eql(true);",
									"});"
								],
								"type": "text/javascript",
								"packages": {}
							}
						}
					],
					"protocolProfileBehavior": {
						"disableBodyPruning": true
					},
					"request": {
						"auth": {
							"type": "noauth"
						},
						"method": "GET",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": ""
						},
						"url": {
							"raw": "{{searchApi}}/search?query={{questionTitle}}",
							"host": [
								"{{searchApi}}"
							],
							"path": [
								"search"
							],
							"query": [
								{
									"key": "query",
									"value": "{{questionTitle}}"
								}
							]
						}
					},
					"response": []
				},
				{
					"name": "Post another answer",
					"event": [
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									"const raw = pm.variables.replaceIn(\"{{$randomLoremParagraphs}}\");",
									"",
									"// Split on newlines, wrap each line in <p> tags, then join",
									"const html = raw",
									"  .split('\\n')",
									"  .filter(p => p.trim().length > 0)",
									"  .map(p => `<p>${p}</p>`)",
									"  .join('');",
									"",
									"pm.environment.set(\"escapedContent\", JSON.stringify(html).slice(1, -1));"
								],
								"type": "text/javascript",
								"packages": {}
							}
						},
						{
							"listen": "test",
							"script": {
								"exec": [
									"const answer = pm.response.json();",
									"",
									"pm.test(\"Has properties\", function () {",
									"    pm.expect(answer).to.have.property('id');",
									"});",
									"",
									"if (pm.test(\"Has properties\")) {",
									"    pm.globals.set('answerId', answer.id);",
									"}"
								],
								"type": "text/javascript",
								"packages": {}
							}
						}
					],
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{bob_token}}",
									"type": "string"
								}
							]
						},
						"method": "POST",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"content\": \"{{escapedContent}}\",\n    \"questionId\": \"{{questionId}}\"\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{questionsApi}}/questions/{{questionId}}/answers",
							"host": [
								"{{questionsApi}}"
							],
							"path": [
								"questions",
								"{{questionId}}",
								"answers"
							]
						}
					},
					"response": []
				},
				{
					"name": "Accept answer (fails returns 400)",
					"event": [
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									"const raw = pm.variables.replaceIn(\"{{$randomLoremParagraphs}}\");",
									"",
									"// Split on newlines, wrap each line in <p> tags, then join",
									"const html = raw",
									"  .split('\\n')",
									"  .filter(p => p.trim().length > 0)",
									"  .map(p => `<p>${p}</p>`)",
									"  .join('');",
									"",
									"pm.environment.set(\"escapedContent\", JSON.stringify(html).slice(1, -1));"
								],
								"type": "text/javascript",
								"packages": {}
							}
						},
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Response returns 400\", function () {",
									"    pm.response.to.have.status(400);",
									"});"
								],
								"type": "text/javascript",
								"packages": {}
							}
						}
					],
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{bob_token}}",
									"type": "string"
								}
							]
						},
						"method": "POST",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{questionsApi}}/questions/{{questionId}}/answers/{{answerId}}/accept",
							"host": [
								"{{questionsApi}}"
							],
							"path": [
								"questions",
								"{{questionId}}",
								"answers",
								"{{answerId}}",
								"accept"
							]
						}
					},
					"response": []
				},
				{
					"name": "Get Question from Search (AnswerCount = 2)",
					"event": [
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									"setTimeout(function(){}, 1000);"
								],
								"type": "text/javascript",
								"packages": {}
							}
						},
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"answerCount is 1\", function () {",
									"    const json = pm.response.json();",
									"    pm.expect(json[0].answerCount).to.eql(2);",
									"});",
									"",
									"pm.test(\"Has accepted answer is true\", function () {",
									"    const json = pm.response.json();",
									"    pm.expect(json[0].hasAcceptedAnswer).to.eql(true);",
									"});"
								],
								"type": "text/javascript",
								"packages": {}
							}
						}
					],
					"protocolProfileBehavior": {
						"disableBodyPruning": true
					},
					"request": {
						"auth": {
							"type": "noauth"
						},
						"method": "GET",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": ""
						},
						"url": {
							"raw": "{{searchApi}}/search?query={{questionTitle}}",
							"host": [
								"{{searchApi}}"
							],
							"path": [
								"search"
							],
							"query": [
								{
									"key": "query",
									"value": "{{questionTitle}}"
								}
							]
						}
					},
					"response": []
				},
				{
					"name": "Delete answer for question",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Response returns 204\", function () {",
									"    pm.response.to.have.status(204);",
									"});"
								],
								"type": "text/javascript",
								"packages": {}
							}
						}
					],
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{bob_token}}",
									"type": "string"
								}
							]
						},
						"method": "DELETE",
						"header": [],
						"url": {
							"raw": "{{questionsApi}}/questions/{{questionId}}/answers/{{answerId}}",
							"host": [
								"{{questionsApi}}"
							],
							"path": [
								"questions",
								"{{questionId}}",
								"answers",
								"{{answerId}}"
							]
						}
					},
					"response": []
				},
				{
					"name": "Get Question from Search (AnswerCount=1)",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"answerCount is 1\", function () {",
									"    const json = pm.response.json();",
									"    pm.expect(json[0].answerCount).to.eql(1);",
									"});"
								],
								"type": "text/javascript",
								"packages": {}
							}
						},
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									"setTimeout(function(){}, 1000);"
								],
								"type": "text/javascript",
								"packages": {}
							}
						}
					],
					"protocolProfileBehavior": {
						"disableBodyPruning": true
					},
					"request": {
						"auth": {
							"type": "noauth"
						},
						"method": "GET",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": ""
						},
						"url": {
							"raw": "{{searchApi}}/search?query={{questionTitle}}",
							"host": [
								"{{searchApi}}"
							],
							"path": [
								"search"
							],
							"query": [
								{
									"key": "query",
									"value": "{{questionTitle}}"
								}
							]
						}
					},
					"response": []
				}
			]
		},
		{
			"name": "Section 6 Deployment",
			"item": [
				{
					"name": "Error handling (question-svc)",
					"item": [
						{
							"name": "Get 400",
							"request": {
								"method": "GET",
								"header": [],
								"url": {
									"raw": "{{questionsApi}}/questions/errors?code=400",
									"host": [
										"{{questionsApi}}"
									],
									"path": [
										"questions",
										"errors"
									],
									"query": [
										{
											"key": "code",
											"value": "400"
										}
									]
								}
							},
							"response": []
						},
						{
							"name": "Get 401",
							"request": {
								"method": "GET",
								"header": [],
								"url": {
									"raw": "{{questionsApi}}/questions/errors?code=401",
									"host": [
										"{{questionsApi}}"
									],
									"path": [
										"questions",
										"errors"
									],
									"query": [
										{
											"key": "code",
											"value": "401"
										}
									]
								}
							},
							"response": []
						},
						{
							"name": "Get 403",
							"request": {
								"method": "GET",
								"header": [],
								"url": {
									"raw": "{{questionsApi}}/questions/errors?code=403",
									"host": [
										"{{questionsApi}}"
									],
									"path": [
										"questions",
										"errors"
									],
									"query": [
										{
											"key": "code",
											"value": "403"
										}
									]
								}
							},
							"response": []
						},
						{
							"name": "Get 404",
							"request": {
								"method": "GET",
								"header": [],
								"url": {
									"raw": "{{questionsApi}}/questions/errors?code=404",
									"host": [
										"{{questionsApi}}"
									],
									"path": [
										"questions",
										"errors"
									],
									"query": [
										{
											"key": "code",
											"value": "404"
										}
									]
								}
							},
							"response": []
						},
						{
							"name": "Get 500",
							"request": {
								"method": "GET",
								"header": [],
								"url": {
									"raw": "{{questionsApi}}/questions/errors?code=500",
									"host": [
										"{{questionsApi}}"
									],
									"path": [
										"questions",
										"errors"
									],
									"query": [
										{
											"key": "code",
											"value": "500"
										}
									]
								}
							},
							"response": []
						},
						{
							"name": "Get Validation Problem",
							"request": {
								"method": "GET",
								"header": [],
								"url": {
									"raw": "{{questionsApi}}/questions/errors?code=0",
									"host": [
										"{{questionsApi}}"
									],
									"path": [
										"questions",
										"errors"
									],
									"query": [
										{
											"key": "code",
											"value": "0"
										}
									]
								}
							},
							"response": []
						},
						{
							"name": "Test auth",
							"request": {
								"auth": {
									"type": "bearer",
									"bearer": [
										{
											"key": "token",
											"value": "eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJTTkUwallvOWhmc3hBT25VVUFXMVlUSG1GSk0zcDlwajRSMDRwNVV1T2drIn0.eyJleHAiOjE3NTQyMDEyNjMsImlhdCI6MTc1NDIwMTI1MywiYXV0aF90aW1lIjoxNzU0MTk3NTg3LCJqdGkiOiJvbnJ0YWM6MTdiMDQ4ZTUtZjRmNS00MzYzLWJmMzItOTQ3ZDczYmNjZGJlIiwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo2MDAxL3JlYWxtcy9vdmVyZmxvdyIsImF1ZCI6Im92ZXJmbG93Iiwic3ViIjoiYzA2ODM5YTMtZDk2NC00MDcwLWI2YTQtMjMyZTY0NThmM2Y3IiwidHlwIjoiQmVhcmVyIiwiYXpwIjoibmV4dGpzIiwic2lkIjoiZGE3MDJjMzItM2M1My00YWI5LWJlNzYtNmEzMzI5ZTcxMjNlIiwiYWNyIjoiMCIsImFsbG93ZWQtb3JpZ2lucyI6WyIiXSwic2NvcGUiOiJvcGVuaWQgcHJvZmlsZSBlbWFpbCIsImVtYWlsX3ZlcmlmaWVkIjp0cnVlLCJuYW1lIjoiQm9iIEJvYmJpdHkiLCJwcmVmZXJyZWRfdXNlcm5hbWUiOiJib2IiLCJnaXZlbl9uYW1lIjoiQm9iIiwiZmFtaWx5X25hbWUiOiJCb2JiaXR5IiwiZW1haWwiOiJib2JAdGVzdC5jb20ifQ.czKx_43JDWzN2ncU4E8nnkWL6pLo8gR619NC7bOldJh0AqbwHB_0hewoVUesuRthJATDfQBzpKqJvThn3OtPAlMhmo4-zdrNS4jPM70T7l35VI3yEhm93zgc1-XrKMATemacFqjl0nSriRFZKMsonAv-pIn2e6m7evMdUBQ0xMHRQ2Geqf4BuDteN3x8ca6e18CZ9mR3WD_HWqflD0eaDWuU-n1Kfa3Xav0lp3qwG_m1QJPOqeHksRv8mchz3VoOKB6gJpgmqpYGCeUlY0CEj-CEx3Vhsh7CpAVIwDiD_SuVkuEPaYiXwQbJc-4Q0g29tukch-hRU1CsNUtEs_grMQ",
											"type": "string"
										}
									]
								},
								"method": "GET",
								"header": [],
								"url": {
									"raw": "{{gateway}}/test/auth",
									"host": [
										"{{gateway}}"
									],
									"path": [
										"test",
										"auth"
									]
								}
							},
							"response": []
						}
					]
				},
				{
					"name": "Error handling (yarp)",
					"item": [
						{
							"name": "Get 400",
							"request": {
								"method": "GET",
								"header": [],
								"url": {
									"raw": "{{gateway}}/questions/errors?code=400",
									"host": [
										"{{gateway}}"
									],
									"path": [
										"questions",
										"errors"
									],
									"query": [
										{
											"key": "code",
											"value": "400"
										}
									]
								}
							},
							"response": []
						},
						{
							"name": "Get 401",
							"request": {
								"method": "GET",
								"header": [],
								"url": {
									"raw": "{{gateway}}/questions/errors?code=401",
									"host": [
										"{{gateway}}"
									],
									"path": [
										"questions",
										"errors"
									],
									"query": [
										{
											"key": "code",
											"value": "401"
										}
									]
								}
							},
							"response": []
						},
						{
							"name": "Get 403",
							"request": {
								"method": "GET",
								"header": [],
								"url": {
									"raw": "{{gateway}}/questions/errors?code=403",
									"host": [
										"{{gateway}}"
									],
									"path": [
										"questions",
										"errors"
									],
									"query": [
										{
											"key": "code",
											"value": "403"
										}
									]
								}
							},
							"response": []
						},
						{
							"name": "Get 404",
							"request": {
								"method": "GET",
								"header": [],
								"url": {
									"raw": "{{gateway}}/questions/errors?code=404",
									"host": [
										"{{gateway}}"
									],
									"path": [
										"questions",
										"errors"
									],
									"query": [
										{
											"key": "code",
											"value": "404"
										}
									]
								}
							},
							"response": []
						},
						{
							"name": "Get 500",
							"request": {
								"method": "GET",
								"header": [],
								"url": {
									"raw": "{{gateway}}/questions/errors?code=500",
									"host": [
										"{{gateway}}"
									],
									"path": [
										"questions",
										"errors"
									],
									"query": [
										{
											"key": "code",
											"value": "500"
										}
									]
								}
							},
							"response": []
						},
						{
							"name": "Get Validation Problem",
							"request": {
								"method": "GET",
								"header": [],
								"url": {
									"raw": "{{gateway}}/questions/errors?code=0",
									"host": [
										"{{gateway}}"
									],
									"path": [
										"questions",
										"errors"
									],
									"query": [
										{
											"key": "code",
											"value": "0"
										}
									]
								}
							},
							"response": []
						}
					]
				},
				{
					"name": "Answer Challenge Gateway",
					"item": [
						{
							"name": "Login as bob",
							"event": [
								{
									"listen": "test",
									"script": {
										"exec": [
											"const user = pm.response.json();",
											"",
											"pm.test(\"Has properties\", function () {",
											"    pm.expect(user).to.have.property('access_token');",
											"});",
											"",
											"if (pm.test(\"Has properties\")) {",
											"    pm.globals.set('bob_token', user.access_token);",
											"}"
										],
										"type": "text/javascript",
										"packages": {}
									}
								}
							],
							"request": {
								"method": "POST",
								"header": [],
								"body": {
									"mode": "urlencoded",
									"urlencoded": [
										{
											"key": "username",
											"value": "bob",
											"type": "text"
										},
										{
											"key": "password",
											"value": "Pa$$w0rd",
											"type": "text"
										},
										{
											"key": "client_id",
											"value": "postman",
											"type": "text"
										},
										{
											"key": "grant_type",
											"value": "password",
											"type": "text"
										},
										{
											"key": "client_secret",
											"value": "zWJYJbQJ2ygrDvDxFSdhs8MSroFlGZcs",
											"type": "text",
											"disabled": true
										}
									]
								},
								"url": {
									"raw": "{{identityApi}}/realms/overflow/protocol/openid-connect/token",
									"host": [
										"{{identityApi}}"
									],
									"path": [
										"realms",
										"overflow",
										"protocol",
										"openid-connect",
										"token"
									]
								}
							},
							"response": []
						},
						{
							"name": "Post question",
							"event": [
								{
									"listen": "prerequest",
									"script": {
										"exec": [
											"const raw = pm.variables.replaceIn(\"{{$randomLoremParagraphs}}\");",
											"",
											"// Split on newlines, wrap each line in <p> tags, then join",
											"const html = raw",
											"  .split('\\n')",
											"  .filter(p => p.trim().length > 0)",
											"  .map(p => `<p>${p}</p>`)",
											"  .join('');",
											"",
											"pm.environment.set(\"escapedContent\", JSON.stringify(html).slice(1, -1));",
											"",
											"const allTags = [\"aspire\", \"dotnet\", \"keycloak\", \"wolverine\", \"ef-core\", \"postgresql\", \"signalr\", \"microservices\", \"nextjs\", \"typescript\"];",
											"",
											"// Pick 1 or 2 tags at random",
											"const shuffled = allTags.sort(() => 0.5 - Math.random());",
											"const selectedTags = shuffled.slice(0, Math.floor(Math.random() * 2) + 1);",
											"",
											"// Set as environment variable for use in body",
											"pm.environment.set('selectedTags', JSON.stringify(selectedTags));"
										],
										"type": "text/javascript",
										"packages": {}
									}
								},
								{
									"listen": "test",
									"script": {
										"exec": [
											"const question = pm.response.json();",
											"",
											"pm.test(\"Has properties\", function () {",
											"    pm.expect(question).to.have.property('id');",
											"});",
											"",
											"if (pm.test(\"Has properties\")) {",
											"    pm.globals.set('questionId', question.id);",
											"    pm.globals.set('questionTitle', question.title);",
											"}"
										],
										"type": "text/javascript",
										"packages": {}
									}
								}
							],
							"request": {
								"auth": {
									"type": "bearer",
									"bearer": [
										{
											"key": "token",
											"value": "{{bob_token}}",
											"type": "string"
										}
									]
								},
								"method": "POST",
								"header": [],
								"body": {
									"mode": "raw",
									"raw": "{\n    \"title\": \"{{$guid}}\",\n    \"content\": \"{{escapedContent}}\",\n    \"tags\": {{selectedTags}}\n}",
									"options": {
										"raw": {
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "{{gateway}}/questions",
									"host": [
										"{{gateway}}"
									],
									"path": [
										"questions"
									]
								}
							},
							"response": []
						},
						{
							"name": "Post answer",
							"event": [
								{
									"listen": "prerequest",
									"script": {
										"exec": [
											"const raw = pm.variables.replaceIn(\"{{$randomLoremParagraphs}}\");",
											"",
											"// Split on newlines, wrap each line in <p> tags, then join",
											"const html = raw",
											"  .split('\\n')",
											"  .filter(p => p.trim().length > 0)",
											"  .map(p => `<p>${p}</p>`)",
											"  .join('');",
											"",
											"pm.environment.set(\"escapedContent\", JSON.stringify(html).slice(1, -1));"
										],
										"type": "text/javascript",
										"packages": {}
									}
								},
								{
									"listen": "test",
									"script": {
										"exec": [
											"const answer = pm.response.json();",
											"",
											"pm.test(\"Has properties\", function () {",
											"    pm.expect(answer).to.have.property('id');",
											"});",
											"",
											"if (pm.test(\"Has properties\")) {",
											"    pm.globals.set('answerId', answer.id);",
											"}"
										],
										"type": "text/javascript",
										"packages": {}
									}
								}
							],
							"request": {
								"auth": {
									"type": "bearer",
									"bearer": [
										{
											"key": "token",
											"value": "{{bob_token}}",
											"type": "string"
										}
									]
								},
								"method": "POST",
								"header": [],
								"body": {
									"mode": "raw",
									"raw": "{\n    \"content\": \"{{escapedContent}}\",\n    \"questionId\": \"{{questionId}}\"\n}",
									"options": {
										"raw": {
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "{{gateway}}/questions/{{questionId}}/answers",
									"host": [
										"{{gateway}}"
									],
									"path": [
										"questions",
										"{{questionId}}",
										"answers"
									]
								}
							},
							"response": []
						},
						{
							"name": "Get Question (answerCount=1)",
							"event": [
								{
									"listen": "test",
									"script": {
										"exec": [
											"const question = pm.response.json();",
											"",
											"pm.test(\"Has answerCount of 1\"), function () {",
											"    pm.expect(question.answerCount).to.eql(1);",
											"}",
											"",
											"pm.test(\"Has answers length of 1\"), function () {",
											"    pm.expect(question.answers).to.be.an(\"array\").that.has.lengthOf(1);",
											"}"
										],
										"type": "text/javascript",
										"packages": {}
									}
								}
							],
							"request": {
								"method": "GET",
								"header": [],
								"url": {
									"raw": "{{gateway}}/questions/{{questionId}}",
									"host": [
										"{{gateway}}"
									],
									"path": [
										"questions",
										"{{questionId}}"
									]
								}
							},
							"response": []
						},
						{
							"name": "Get Question from Search (answerCount=1)",
							"event": [
								{
									"listen": "test",
									"script": {
										"exec": [
											"pm.test(\"answerCount is 1\", function () {",
											"    const json = pm.response.json();",
											"    pm.expect(json[0].answerCount).to.eql(1);",
											"});"
										],
										"type": "text/javascript",
										"packages": {}
									}
								},
								{
									"listen": "prerequest",
									"script": {
										"exec": [
											"setTimeout(function(){}, 1000);"
										],
										"type": "text/javascript",
										"packages": {}
									}
								}
							],
							"protocolProfileBehavior": {
								"disableBodyPruning": true
							},
							"request": {
								"auth": {
									"type": "noauth"
								},
								"method": "GET",
								"header": [],
								"body": {
									"mode": "raw",
									"raw": "{\n    \"title\": \"{{$randomLoremWords}}\",\n    \"content\": \"{{$randomLoremParagraphs}}\"\n}"
								},
								"url": {
									"raw": "{{gateway}}/search?query={{questionTitle}}",
									"host": [
										"{{gateway}}"
									],
									"path": [
										"search"
									],
									"query": [
										{
											"key": "query",
											"value": "{{questionTitle}}"
										}
									]
								}
							},
							"response": []
						},
						{
							"name": "Update answer for question",
							"event": [
								{
									"listen": "prerequest",
									"script": {
										"exec": [
											"const raw = pm.variables.replaceIn(\"{{$randomLoremParagraphs}}\");",
											"",
											"// Split on newlines, wrap each line in <p> tags, then join",
											"const html = raw",
											"  .split('\\n')",
											"  .filter(p => p.trim().length > 0)",
											"  .map(p => `<p>${p}</p>`)",
											"  .join('');",
											"",
											"pm.environment.set(\"escapedContent\", JSON.stringify(html).slice(1, -1));"
										],
										"type": "text/javascript",
										"packages": {}
									}
								},
								{
									"listen": "test",
									"script": {
										"exec": [
											"pm.test(\"Response returns 204\", function () {",
											"    pm.response.to.have.status(204);",
											"});"
										],
										"type": "text/javascript",
										"packages": {}
									}
								}
							],
							"request": {
								"auth": {
									"type": "bearer",
									"bearer": [
										{
											"key": "token",
											"value": "{{bob_token}}",
											"type": "string"
										}
									]
								},
								"method": "PUT",
								"header": [],
								"body": {
									"mode": "raw",
									"raw": "{\n    \"content\": \"{{escapedContent}} updated\"\n}",
									"options": {
										"raw": {
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "{{gateway}}/questions/{{questionId}}/answers/{{answerId}}",
									"host": [
										"{{gateway}}"
									],
									"path": [
										"questions",
										"{{questionId}}",
										"answers",
										"{{answerId}}"
									]
								}
							},
							"response": []
						},
						{
							"name": "Get Question (answer.content contains updated)",
							"event": [
								{
									"listen": "test",
									"script": {
										"exec": [
											"pm.test(\"Answer contains 'updated'\", function () {",
											"    const response = pm.response.json();",
											"    const answerContent = response.answers?.[0]?.content || \"\";",
											"    pm.expect(answerContent.includes(\"updated\")).to.be.true;",
											"});"
										],
										"type": "text/javascript",
										"packages": {}
									}
								}
							],
							"request": {
								"method": "GET",
								"header": [],
								"url": {
									"raw": "{{gateway}}/questions/{{questionId}}",
									"host": [
										"{{gateway}}"
									],
									"path": [
										"questions",
										"{{questionId}}"
									]
								}
							},
							"response": []
						},
						{
							"name": "Accept answer for question",
							"event": [
								{
									"listen": "prerequest",
									"script": {
										"exec": [
											"const raw = pm.variables.replaceIn(\"{{$randomLoremParagraphs}}\");",
											"",
											"// Split on newlines, wrap each line in <p> tags, then join",
											"const html = raw",
											"  .split('\\n')",
											"  .filter(p => p.trim().length > 0)",
											"  .map(p => `<p>${p}</p>`)",
											"  .join('');",
											"",
											"pm.environment.set(\"escapedContent\", JSON.stringify(html).slice(1, -1));"
										],
										"type": "text/javascript",
										"packages": {}
									}
								},
								{
									"listen": "test",
									"script": {
										"exec": [
											"pm.test(\"Response returns 204\", function () {",
											"    pm.response.to.have.status(204);",
											"});"
										],
										"type": "text/javascript",
										"packages": {}
									}
								}
							],
							"request": {
								"auth": {
									"type": "bearer",
									"bearer": [
										{
											"key": "token",
											"value": "{{bob_token}}",
											"type": "string"
										}
									]
								},
								"method": "POST",
								"header": [],
								"body": {
									"mode": "raw",
									"raw": "",
									"options": {
										"raw": {
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "{{gateway}}/questions/{{questionId}}/answers/{{answerId}}/accept",
									"host": [
										"{{gateway}}"
									],
									"path": [
										"questions",
										"{{questionId}}",
										"answers",
										"{{answerId}}",
										"accept"
									]
								}
							},
							"response": []
						},
						{
							"name": "Get Question (hasAcceptedAnswer=true)",
							"event": [
								{
									"listen": "test",
									"script": {
										"exec": [
											"const response = pm.response.json();",
											"",
											"pm.test(\"Question has accepted answer\", function () {",
											"    pm.expect(response.hasAcceptedAnswer).to.eql(true);",
											"});",
											"",
											"pm.test(\"Answer has accepted property of true\", function () {",
											"    pm.expect(response.answers[0].accepted).to.be.true;",
											"})"
										],
										"type": "text/javascript",
										"packages": {}
									}
								}
							],
							"request": {
								"method": "GET",
								"header": [],
								"url": {
									"raw": "{{gateway}}/questions/{{questionId}}",
									"host": [
										"{{gateway}}"
									],
									"path": [
										"questions",
										"{{questionId}}"
									]
								}
							},
							"response": []
						},
						{
							"name": "Get Question from Search (HasAcceptedAnswer=true)",
							"event": [
								{
									"listen": "prerequest",
									"script": {
										"exec": [
											"setTimeout(function(){}, 1000);"
										],
										"type": "text/javascript",
										"packages": {}
									}
								},
								{
									"listen": "test",
									"script": {
										"exec": [
											"pm.test(\"Has accepted answer is true\", function () {",
											"    const json = pm.response.json();",
											"    pm.expect(json[0].hasAcceptedAnswer).to.eql(true);",
											"});"
										],
										"type": "text/javascript",
										"packages": {}
									}
								}
							],
							"protocolProfileBehavior": {
								"disableBodyPruning": true
							},
							"request": {
								"auth": {
									"type": "noauth"
								},
								"method": "GET",
								"header": [],
								"body": {
									"mode": "raw",
									"raw": ""
								},
								"url": {
									"raw": "{{gateway}}/search?query={{questionTitle}}",
									"host": [
										"{{gateway}}"
									],
									"path": [
										"search"
									],
									"query": [
										{
											"key": "query",
											"value": "{{questionTitle}}"
										}
									]
								}
							},
							"response": []
						},
						{
							"name": "Post another answer",
							"event": [
								{
									"listen": "prerequest",
									"script": {
										"exec": [
											"const raw = pm.variables.replaceIn(\"{{$randomLoremParagraphs}}\");",
											"",
											"// Split on newlines, wrap each line in <p> tags, then join",
											"const html = raw",
											"  .split('\\n')",
											"  .filter(p => p.trim().length > 0)",
											"  .map(p => `<p>${p}</p>`)",
											"  .join('');",
											"",
											"pm.environment.set(\"escapedContent\", JSON.stringify(html).slice(1, -1));"
										],
										"type": "text/javascript",
										"packages": {}
									}
								},
								{
									"listen": "test",
									"script": {
										"exec": [
											"const answer = pm.response.json();",
											"",
											"pm.test(\"Has properties\", function () {",
											"    pm.expect(answer).to.have.property('id');",
											"});",
											"",
											"if (pm.test(\"Has properties\")) {",
											"    pm.globals.set('answerId', answer.id);",
											"}"
										],
										"type": "text/javascript",
										"packages": {}
									}
								}
							],
							"request": {
								"auth": {
									"type": "bearer",
									"bearer": [
										{
											"key": "token",
											"value": "{{bob_token}}",
											"type": "string"
										}
									]
								},
								"method": "POST",
								"header": [],
								"body": {
									"mode": "raw",
									"raw": "{\n    \"content\": \"{{escapedContent}}\",\n    \"questionId\": \"{{questionId}}\"\n}",
									"options": {
										"raw": {
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "{{gateway}}/questions/{{questionId}}/answers",
									"host": [
										"{{gateway}}"
									],
									"path": [
										"questions",
										"{{questionId}}",
										"answers"
									]
								}
							},
							"response": []
						},
						{
							"name": "Accept answer (fails returns 400)",
							"event": [
								{
									"listen": "prerequest",
									"script": {
										"exec": [
											"const raw = pm.variables.replaceIn(\"{{$randomLoremParagraphs}}\");",
											"",
											"// Split on newlines, wrap each line in <p> tags, then join",
											"const html = raw",
											"  .split('\\n')",
											"  .filter(p => p.trim().length > 0)",
											"  .map(p => `<p>${p}</p>`)",
											"  .join('');",
											"",
											"pm.environment.set(\"escapedContent\", JSON.stringify(html).slice(1, -1));"
										],
										"type": "text/javascript",
										"packages": {}
									}
								},
								{
									"listen": "test",
									"script": {
										"exec": [
											"pm.test(\"Response returns 400\", function () {",
											"    pm.response.to.have.status(400);",
											"});"
										],
										"type": "text/javascript",
										"packages": {}
									}
								}
							],
							"request": {
								"auth": {
									"type": "bearer",
									"bearer": [
										{
											"key": "token",
											"value": "{{bob_token}}",
											"type": "string"
										}
									]
								},
								"method": "POST",
								"header": [],
								"body": {
									"mode": "raw",
									"raw": "",
									"options": {
										"raw": {
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "{{gateway}}/questions/{{questionId}}/answers/{{answerId}}/accept",
									"host": [
										"{{gateway}}"
									],
									"path": [
										"questions",
										"{{questionId}}",
										"answers",
										"{{answerId}}",
										"accept"
									]
								}
							},
							"response": []
						},
						{
							"name": "Get Question from Search (AnswerCount = 2)",
							"event": [
								{
									"listen": "prerequest",
									"script": {
										"exec": [
											"setTimeout(function(){}, 1000);"
										],
										"type": "text/javascript",
										"packages": {}
									}
								},
								{
									"listen": "test",
									"script": {
										"exec": [
											"pm.test(\"answerCount is 1\", function () {",
											"    const json = pm.response.json();",
											"    pm.expect(json[0].answerCount).to.eql(2);",
											"});",
											"",
											"pm.test(\"Has accepted answer is true\", function () {",
											"    const json = pm.response.json();",
											"    pm.expect(json[0].hasAcceptedAnswer).to.eql(true);",
											"});"
										],
										"type": "text/javascript",
										"packages": {}
									}
								}
							],
							"protocolProfileBehavior": {
								"disableBodyPruning": true
							},
							"request": {
								"auth": {
									"type": "noauth"
								},
								"method": "GET",
								"header": [],
								"body": {
									"mode": "raw",
									"raw": ""
								},
								"url": {
									"raw": "{{gateway}}/search?query={{questionTitle}}",
									"host": [
										"{{gateway}}"
									],
									"path": [
										"search"
									],
									"query": [
										{
											"key": "query",
											"value": "{{questionTitle}}"
										}
									]
								}
							},
							"response": []
						},
						{
							"name": "Delete answer for question",
							"event": [
								{
									"listen": "test",
									"script": {
										"exec": [
											"pm.test(\"Response returns 204\", function () {",
											"    pm.response.to.have.status(204);",
											"});"
										],
										"type": "text/javascript",
										"packages": {}
									}
								}
							],
							"request": {
								"auth": {
									"type": "bearer",
									"bearer": [
										{
											"key": "token",
											"value": "{{bob_token}}",
											"type": "string"
										}
									]
								},
								"method": "DELETE",
								"header": [],
								"url": {
									"raw": "{{gateway}}/questions/{{questionId}}/answers/{{answerId}}",
									"host": [
										"{{gateway}}"
									],
									"path": [
										"questions",
										"{{questionId}}",
										"answers",
										"{{answerId}}"
									]
								}
							},
							"response": []
						},
						{
							"name": "Get Question from Search (AnswerCount=1)",
							"event": [
								{
									"listen": "test",
									"script": {
										"exec": [
											"pm.test(\"answerCount is 1\", function () {",
											"    const json = pm.response.json();",
											"    pm.expect(json[0].answerCount).to.eql(1);",
											"});"
										],
										"type": "text/javascript",
										"packages": {}
									}
								},
								{
									"listen": "prerequest",
									"script": {
										"exec": [
											"setTimeout(function(){}, 1000);"
										],
										"type": "text/javascript",
										"packages": {}
									}
								}
							],
							"protocolProfileBehavior": {
								"disableBodyPruning": true
							},
							"request": {
								"auth": {
									"type": "noauth"
								},
								"method": "GET",
								"header": [],
								"body": {
									"mode": "raw",
									"raw": ""
								},
								"url": {
									"raw": "{{gateway}}/search?query={{questionTitle}}",
									"host": [
										"{{gateway}}"
									],
									"path": [
										"search"
									],
									"query": [
										{
											"key": "query",
											"value": "{{questionTitle}}"
										}
									]
								}
							},
							"response": []
						}
					]
				},
				{
					"name": "Answer Challenge Nginx",
					"item": [
						{
							"name": "Login as bob",
							"event": [
								{
									"listen": "test",
									"script": {
										"exec": [
											"const user = pm.response.json();",
											"",
											"pm.test(\"Has properties\", function () {",
											"    pm.expect(user).to.have.property('access_token');",
											"});",
											"",
											"if (pm.test(\"Has properties\")) {",
											"    pm.globals.set('bob_token', user.access_token);",
											"}"
										],
										"type": "text/javascript",
										"packages": {}
									}
								}
							],
							"request": {
								"method": "POST",
								"header": [],
								"body": {
									"mode": "urlencoded",
									"urlencoded": [
										{
											"key": "username",
											"value": "bob",
											"type": "text"
										},
										{
											"key": "password",
											"value": "Pa$$w0rd",
											"type": "text"
										},
										{
											"key": "client_id",
											"value": "postman",
											"type": "text"
										},
										{
											"key": "grant_type",
											"value": "password",
											"type": "text"
										},
										{
											"key": "client_secret",
											"value": "zWJYJbQJ2ygrDvDxFSdhs8MSroFlGZcs",
											"type": "text",
											"disabled": true
										}
									]
								},
								"url": {
									"raw": "{{identityNg}}/realms/overflow/protocol/openid-connect/token",
									"host": [
										"{{identityNg}}"
									],
									"path": [
										"realms",
										"overflow",
										"protocol",
										"openid-connect",
										"token"
									]
								}
							},
							"response": []
						},
						{
							"name": "Post question",
							"event": [
								{
									"listen": "prerequest",
									"script": {
										"exec": [
											"const raw = pm.variables.replaceIn(\"{{$randomLoremParagraphs}}\");",
											"",
											"// Split on newlines, wrap each line in <p> tags, then join",
											"const html = raw",
											"  .split('\\n')",
											"  .filter(p => p.trim().length > 0)",
											"  .map(p => `<p>${p}</p>`)",
											"  .join('');",
											"",
											"pm.environment.set(\"escapedContent\", JSON.stringify(html).slice(1, -1));",
											"",
											"const allTags = [\"aspire\", \"dotnet\", \"keycloak\", \"wolverine\", \"ef-core\", \"postgresql\", \"signalr\", \"microservices\", \"nextjs\", \"typescript\"];",
											"",
											"// Pick 1 or 2 tags at random",
											"const shuffled = allTags.sort(() => 0.5 - Math.random());",
											"const selectedTags = shuffled.slice(0, Math.floor(Math.random() * 2) + 1);",
											"",
											"// Set as environment variable for use in body",
											"pm.environment.set('selectedTags', JSON.stringify(selectedTags));"
										],
										"type": "text/javascript",
										"packages": {}
									}
								},
								{
									"listen": "test",
									"script": {
										"exec": [
											"const question = pm.response.json();",
											"",
											"pm.test(\"Has properties\", function () {",
											"    pm.expect(question).to.have.property('id');",
											"});",
											"",
											"if (pm.test(\"Has properties\")) {",
											"    pm.globals.set('questionId', question.id);",
											"    pm.globals.set('questionTitle', question.title);",
											"}"
										],
										"type": "text/javascript",
										"packages": {}
									}
								}
							],
							"request": {
								"auth": {
									"type": "bearer",
									"bearer": [
										{
											"key": "token",
											"value": "{{bob_token}}",
											"type": "string"
										}
									]
								},
								"method": "POST",
								"header": [],
								"body": {
									"mode": "raw",
									"raw": "{\n    \"title\": \"{{$guid}}\",\n    \"content\": \"{{escapedContent}}\",\n    \"tags\": {{selectedTags}}\n}",
									"options": {
										"raw": {
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "{{apiNg}}/questions",
									"host": [
										"{{apiNg}}"
									],
									"path": [
										"questions"
									]
								}
							},
							"response": []
						},
						{
							"name": "Post answer",
							"event": [
								{
									"listen": "prerequest",
									"script": {
										"exec": [
											"const raw = pm.variables.replaceIn(\"{{$randomLoremParagraphs}}\");",
											"",
											"// Split on newlines, wrap each line in <p> tags, then join",
											"const html = raw",
											"  .split('\\n')",
											"  .filter(p => p.trim().length > 0)",
											"  .map(p => `<p>${p}</p>`)",
											"  .join('');",
											"",
											"pm.environment.set(\"escapedContent\", JSON.stringify(html).slice(1, -1));"
										],
										"type": "text/javascript",
										"packages": {}
									}
								},
								{
									"listen": "test",
									"script": {
										"exec": [
											"const answer = pm.response.json();",
											"",
											"pm.test(\"Has properties\", function () {",
											"    pm.expect(answer).to.have.property('id');",
											"});",
											"",
											"if (pm.test(\"Has properties\")) {",
											"    pm.globals.set('answerId', answer.id);",
											"}"
										],
										"type": "text/javascript",
										"packages": {}
									}
								}
							],
							"request": {
								"auth": {
									"type": "bearer",
									"bearer": [
										{
											"key": "token",
											"value": "{{bob_token}}",
											"type": "string"
										}
									]
								},
								"method": "POST",
								"header": [],
								"body": {
									"mode": "raw",
									"raw": "{\n    \"content\": \"{{escapedContent}}\",\n    \"questionId\": \"{{questionId}}\"\n}",
									"options": {
										"raw": {
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "{{apiNg}}/questions/{{questionId}}/answers",
									"host": [
										"{{apiNg}}"
									],
									"path": [
										"questions",
										"{{questionId}}",
										"answers"
									]
								}
							},
							"response": []
						},
						{
							"name": "Get Question (answerCount=1)",
							"event": [
								{
									"listen": "test",
									"script": {
										"exec": [
											"const question = pm.response.json();",
											"",
											"pm.test(\"Has answerCount of 1\"), function () {",
											"    pm.expect(question.answerCount).to.eql(1);",
											"}",
											"",
											"pm.test(\"Has answers length of 1\"), function () {",
											"    pm.expect(question.answers).to.be.an(\"array\").that.has.lengthOf(1);",
											"}"
										],
										"type": "text/javascript",
										"packages": {}
									}
								}
							],
							"request": {
								"method": "GET",
								"header": [],
								"url": {
									"raw": "{{apiNg}}/questions/{{questionId}}",
									"host": [
										"{{apiNg}}"
									],
									"path": [
										"questions",
										"{{questionId}}"
									]
								}
							},
							"response": []
						},
						{
							"name": "Get Question from Search (answerCount=1)",
							"event": [
								{
									"listen": "test",
									"script": {
										"exec": [
											"pm.test(\"answerCount is 1\", function () {",
											"    const json = pm.response.json();",
											"    pm.expect(json[0].answerCount).to.eql(1);",
											"});"
										],
										"type": "text/javascript",
										"packages": {}
									}
								},
								{
									"listen": "prerequest",
									"script": {
										"exec": [
											"setTimeout(function(){}, 1000);"
										],
										"type": "text/javascript",
										"packages": {}
									}
								}
							],
							"protocolProfileBehavior": {
								"disableBodyPruning": true
							},
							"request": {
								"auth": {
									"type": "noauth"
								},
								"method": "GET",
								"header": [],
								"body": {
									"mode": "raw",
									"raw": "{\n    \"title\": \"{{$randomLoremWords}}\",\n    \"content\": \"{{$randomLoremParagraphs}}\"\n}"
								},
								"url": {
									"raw": "{{apiNg}}/search?query={{questionTitle}}",
									"host": [
										"{{apiNg}}"
									],
									"path": [
										"search"
									],
									"query": [
										{
											"key": "query",
											"value": "{{questionTitle}}"
										}
									]
								}
							},
							"response": []
						},
						{
							"name": "Update answer for question",
							"event": [
								{
									"listen": "prerequest",
									"script": {
										"exec": [
											"const raw = pm.variables.replaceIn(\"{{$randomLoremParagraphs}}\");",
											"",
											"// Split on newlines, wrap each line in <p> tags, then join",
											"const html = raw",
											"  .split('\\n')",
											"  .filter(p => p.trim().length > 0)",
											"  .map(p => `<p>${p}</p>`)",
											"  .join('');",
											"",
											"pm.environment.set(\"escapedContent\", JSON.stringify(html).slice(1, -1));"
										],
										"type": "text/javascript",
										"packages": {}
									}
								},
								{
									"listen": "test",
									"script": {
										"exec": [
											"pm.test(\"Response returns 204\", function () {",
											"    pm.response.to.have.status(204);",
											"});"
										],
										"type": "text/javascript",
										"packages": {}
									}
								}
							],
							"request": {
								"auth": {
									"type": "bearer",
									"bearer": [
										{
											"key": "token",
											"value": "{{bob_token}}",
											"type": "string"
										}
									]
								},
								"method": "PUT",
								"header": [],
								"body": {
									"mode": "raw",
									"raw": "{\n    \"content\": \"{{escapedContent}} updated\"\n}",
									"options": {
										"raw": {
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "{{apiNg}}/questions/{{questionId}}/answers/{{answerId}}",
									"host": [
										"{{apiNg}}"
									],
									"path": [
										"questions",
										"{{questionId}}",
										"answers",
										"{{answerId}}"
									]
								}
							},
							"response": []
						},
						{
							"name": "Get Question (answer.content contains updated)",
							"event": [
								{
									"listen": "test",
									"script": {
										"exec": [
											"pm.test(\"Answer contains 'updated'\", function () {",
											"    const response = pm.response.json();",
											"    const answerContent = response.answers?.[0]?.content || \"\";",
											"    pm.expect(answerContent.includes(\"updated\")).to.be.true;",
											"});"
										],
										"type": "text/javascript",
										"packages": {}
									}
								}
							],
							"request": {
								"method": "GET",
								"header": [],
								"url": {
									"raw": "{{apiNg}}/questions/{{questionId}}",
									"host": [
										"{{apiNg}}"
									],
									"path": [
										"questions",
										"{{questionId}}"
									]
								}
							},
							"response": []
						},
						{
							"name": "Accept answer for question",
							"event": [
								{
									"listen": "prerequest",
									"script": {
										"exec": [
											"const raw = pm.variables.replaceIn(\"{{$randomLoremParagraphs}}\");",
											"",
											"// Split on newlines, wrap each line in <p> tags, then join",
											"const html = raw",
											"  .split('\\n')",
											"  .filter(p => p.trim().length > 0)",
											"  .map(p => `<p>${p}</p>`)",
											"  .join('');",
											"",
											"pm.environment.set(\"escapedContent\", JSON.stringify(html).slice(1, -1));"
										],
										"type": "text/javascript",
										"packages": {}
									}
								},
								{
									"listen": "test",
									"script": {
										"exec": [
											"pm.test(\"Response returns 204\", function () {",
											"    pm.response.to.have.status(204);",
											"});"
										],
										"type": "text/javascript",
										"packages": {}
									}
								}
							],
							"request": {
								"auth": {
									"type": "bearer",
									"bearer": [
										{
											"key": "token",
											"value": "{{bob_token}}",
											"type": "string"
										}
									]
								},
								"method": "POST",
								"header": [],
								"body": {
									"mode": "raw",
									"raw": "",
									"options": {
										"raw": {
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "{{apiNg}}/questions/{{questionId}}/answers/{{answerId}}/accept",
									"host": [
										"{{apiNg}}"
									],
									"path": [
										"questions",
										"{{questionId}}",
										"answers",
										"{{answerId}}",
										"accept"
									]
								}
							},
							"response": []
						},
						{
							"name": "Get Question (hasAcceptedAnswer=true)",
							"event": [
								{
									"listen": "test",
									"script": {
										"exec": [
											"const response = pm.response.json();",
											"",
											"pm.test(\"Question has accepted answer\", function () {",
											"    pm.expect(response.hasAcceptedAnswer).to.eql(true);",
											"});",
											"",
											"pm.test(\"Answer has accepted property of true\", function () {",
											"    pm.expect(response.answers[0].accepted).to.be.true;",
											"})"
										],
										"type": "text/javascript",
										"packages": {}
									}
								}
							],
							"request": {
								"method": "GET",
								"header": [],
								"url": {
									"raw": "{{apiNg}}/questions/{{questionId}}",
									"host": [
										"{{apiNg}}"
									],
									"path": [
										"questions",
										"{{questionId}}"
									]
								}
							},
							"response": []
						},
						{
							"name": "Get Question from Search (HasAcceptedAnswer=true)",
							"event": [
								{
									"listen": "prerequest",
									"script": {
										"exec": [
											"setTimeout(function(){}, 1000);"
										],
										"type": "text/javascript",
										"packages": {}
									}
								},
								{
									"listen": "test",
									"script": {
										"exec": [
											"pm.test(\"Has accepted answer is true\", function () {",
											"    const json = pm.response.json();",
											"    pm.expect(json[0].hasAcceptedAnswer).to.eql(true);",
											"});"
										],
										"type": "text/javascript",
										"packages": {}
									}
								}
							],
							"protocolProfileBehavior": {
								"disableBodyPruning": true
							},
							"request": {
								"auth": {
									"type": "noauth"
								},
								"method": "GET",
								"header": [],
								"body": {
									"mode": "raw",
									"raw": ""
								},
								"url": {
									"raw": "{{apiNg}}/search?query={{questionTitle}}",
									"host": [
										"{{apiNg}}"
									],
									"path": [
										"search"
									],
									"query": [
										{
											"key": "query",
											"value": "{{questionTitle}}"
										}
									]
								}
							},
							"response": []
						},
						{
							"name": "Post another answer",
							"event": [
								{
									"listen": "prerequest",
									"script": {
										"exec": [
											"const raw = pm.variables.replaceIn(\"{{$randomLoremParagraphs}}\");",
											"",
											"// Split on newlines, wrap each line in <p> tags, then join",
											"const html = raw",
											"  .split('\\n')",
											"  .filter(p => p.trim().length > 0)",
											"  .map(p => `<p>${p}</p>`)",
											"  .join('');",
											"",
											"pm.environment.set(\"escapedContent\", JSON.stringify(html).slice(1, -1));"
										],
										"type": "text/javascript",
										"packages": {}
									}
								},
								{
									"listen": "test",
									"script": {
										"exec": [
											"const answer = pm.response.json();",
											"",
											"pm.test(\"Has properties\", function () {",
											"    pm.expect(answer).to.have.property('id');",
											"});",
											"",
											"if (pm.test(\"Has properties\")) {",
											"    pm.globals.set('answerId', answer.id);",
											"}"
										],
										"type": "text/javascript",
										"packages": {}
									}
								}
							],
							"request": {
								"auth": {
									"type": "bearer",
									"bearer": [
										{
											"key": "token",
											"value": "{{bob_token}}",
											"type": "string"
										}
									]
								},
								"method": "POST",
								"header": [],
								"body": {
									"mode": "raw",
									"raw": "{\n    \"content\": \"{{escapedContent}}\",\n    \"questionId\": \"{{questionId}}\"\n}",
									"options": {
										"raw": {
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "{{apiNg}}/questions/{{questionId}}/answers",
									"host": [
										"{{apiNg}}"
									],
									"path": [
										"questions",
										"{{questionId}}",
										"answers"
									]
								}
							},
							"response": []
						},
						{
							"name": "Accept answer (fails returns 400)",
							"event": [
								{
									"listen": "prerequest",
									"script": {
										"exec": [
											"const raw = pm.variables.replaceIn(\"{{$randomLoremParagraphs}}\");",
											"",
											"// Split on newlines, wrap each line in <p> tags, then join",
											"const html = raw",
											"  .split('\\n')",
											"  .filter(p => p.trim().length > 0)",
											"  .map(p => `<p>${p}</p>`)",
											"  .join('');",
											"",
											"pm.environment.set(\"escapedContent\", JSON.stringify(html).slice(1, -1));"
										],
										"type": "text/javascript",
										"packages": {}
									}
								},
								{
									"listen": "test",
									"script": {
										"exec": [
											"pm.test(\"Response returns 400\", function () {",
											"    pm.response.to.have.status(400);",
											"});"
										],
										"type": "text/javascript",
										"packages": {}
									}
								}
							],
							"request": {
								"auth": {
									"type": "bearer",
									"bearer": [
										{
											"key": "token",
											"value": "{{bob_token}}",
											"type": "string"
										}
									]
								},
								"method": "POST",
								"header": [],
								"body": {
									"mode": "raw",
									"raw": "",
									"options": {
										"raw": {
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "{{apiNg}}/questions/{{questionId}}/answers/{{answerId}}/accept",
									"host": [
										"{{apiNg}}"
									],
									"path": [
										"questions",
										"{{questionId}}",
										"answers",
										"{{answerId}}",
										"accept"
									]
								}
							},
							"response": []
						},
						{
							"name": "Get Question from Search (AnswerCount = 2)",
							"event": [
								{
									"listen": "prerequest",
									"script": {
										"exec": [
											"setTimeout(function(){}, 1000);"
										],
										"type": "text/javascript",
										"packages": {}
									}
								},
								{
									"listen": "test",
									"script": {
										"exec": [
											"pm.test(\"answerCount is 1\", function () {",
											"    const json = pm.response.json();",
											"    pm.expect(json[0].answerCount).to.eql(2);",
											"});",
											"",
											"pm.test(\"Has accepted answer is true\", function () {",
											"    const json = pm.response.json();",
											"    pm.expect(json[0].hasAcceptedAnswer).to.eql(true);",
											"});"
										],
										"type": "text/javascript",
										"packages": {}
									}
								}
							],
							"protocolProfileBehavior": {
								"disableBodyPruning": true
							},
							"request": {
								"auth": {
									"type": "noauth"
								},
								"method": "GET",
								"header": [],
								"body": {
									"mode": "raw",
									"raw": ""
								},
								"url": {
									"raw": "{{apiNg}}/search?query={{questionTitle}}",
									"host": [
										"{{apiNg}}"
									],
									"path": [
										"search"
									],
									"query": [
										{
											"key": "query",
											"value": "{{questionTitle}}"
										}
									]
								}
							},
							"response": []
						},
						{
							"name": "Delete answer for question",
							"event": [
								{
									"listen": "test",
									"script": {
										"exec": [
											"pm.test(\"Response returns 204\", function () {",
											"    pm.response.to.have.status(204);",
											"});"
										],
										"type": "text/javascript",
										"packages": {}
									}
								}
							],
							"request": {
								"auth": {
									"type": "bearer",
									"bearer": [
										{
											"key": "token",
											"value": "{{bob_token}}",
											"type": "string"
										}
									]
								},
								"method": "DELETE",
								"header": [],
								"url": {
									"raw": "{{apiNg}}/questions/{{questionId}}/answers/{{answerId}}",
									"host": [
										"{{apiNg}}"
									],
									"path": [
										"questions",
										"{{questionId}}",
										"answers",
										"{{answerId}}"
									]
								}
							},
							"response": []
						},
						{
							"name": "Get Question from Search (AnswerCount=1)",
							"event": [
								{
									"listen": "test",
									"script": {
										"exec": [
											"pm.test(\"answerCount is 1\", function () {",
											"    const json = pm.response.json();",
											"    pm.expect(json[0].answerCount).to.eql(1);",
											"});"
										],
										"type": "text/javascript",
										"packages": {}
									}
								},
								{
									"listen": "prerequest",
									"script": {
										"exec": [
											"setTimeout(function(){}, 1000);"
										],
										"type": "text/javascript",
										"packages": {}
									}
								}
							],
							"protocolProfileBehavior": {
								"disableBodyPruning": true
							},
							"request": {
								"auth": {
									"type": "noauth"
								},
								"method": "GET",
								"header": [],
								"body": {
									"mode": "raw",
									"raw": ""
								},
								"url": {
									"raw": "{{apiNg}}/search?query={{questionTitle}}",
									"host": [
										"{{apiNg}}"
									],
									"path": [
										"search"
									],
									"query": [
										{
											"key": "query",
											"value": "{{questionTitle}}"
										}
									]
								}
							},
							"response": []
						}
					]
				},
				{
					"name": "Get well known config Copy",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{identityApi}}/realms/overflow/.well-known/openid-configuration",
							"host": [
								"{{identityApi}}"
							],
							"path": [
								"realms",
								"overflow",
								".well-known",
								"openid-configuration"
							]
						}
					},
					"response": []
				}
			]
		},
		{
			"name": "Section 7 Webapp",
			"item": [
				{
					"name": "Login as bob",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"const user = pm.response.json();",
									"",
									"pm.test(\"Has properties\", function () {",
									"    pm.expect(user).to.have.property('access_token');",
									"});",
									"",
									"if (pm.test(\"Has properties\")) {",
									"    pm.globals.set('bob_token', user.access_token);",
									"}"
								],
								"type": "text/javascript",
								"packages": {}
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [],
						"body": {
							"mode": "urlencoded",
							"urlencoded": [
								{
									"key": "username",
									"value": "bob",
									"type": "text"
								},
								{
									"key": "password",
									"value": "Pa$$w0rd",
									"type": "text"
								},
								{
									"key": "client_id",
									"value": "postman",
									"type": "text"
								},
								{
									"key": "grant_type",
									"value": "password",
									"type": "text"
								},
								{
									"key": "client_secret",
									"value": "zWJYJbQJ2ygrDvDxFSdhs8MSroFlGZcs",
									"type": "text",
									"disabled": true
								}
							]
						},
						"url": {
							"raw": "{{identityApi}}/realms/overflow/protocol/openid-connect/token",
							"host": [
								"{{identityApi}}"
							],
							"path": [
								"realms",
								"overflow",
								"protocol",
								"openid-connect",
								"token"
							]
						}
					},
					"response": []
				},
				{
					"name": "Login as dave",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"const user = pm.response.json();",
									"",
									"pm.test(\"Has properties\", function () {",
									"    pm.expect(user).to.have.property('access_token');",
									"});",
									"",
									"if (pm.test(\"Has properties\")) {",
									"    pm.globals.set('dave_token', user.access_token);",
									"}"
								],
								"type": "text/javascript",
								"packages": {}
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [],
						"body": {
							"mode": "urlencoded",
							"urlencoded": [
								{
									"key": "username",
									"value": "dave",
									"type": "text"
								},
								{
									"key": "password",
									"value": "Pa$$w0rd",
									"type": "text"
								},
								{
									"key": "client_id",
									"value": "postman",
									"type": "text"
								},
								{
									"key": "grant_type",
									"value": "password",
									"type": "text"
								},
								{
									"key": "client_secret",
									"value": "zWJYJbQJ2ygrDvDxFSdhs8MSroFlGZcs",
									"type": "text",
									"disabled": true
								}
							]
						},
						"url": {
							"raw": "{{identityApi}}/realms/overflow/protocol/openid-connect/token",
							"host": [
								"{{identityApi}}"
							],
							"path": [
								"realms",
								"overflow",
								"protocol",
								"openid-connect",
								"token"
							]
						}
					},
					"response": []
				},
				{
					"name": "Post question as Bob",
					"event": [
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									"const raw = pm.variables.replaceIn(\"{{$randomLoremParagraphs}}\");",
									"",
									"// Split on newlines, wrap each line in <p> tags, then join",
									"const html = raw",
									"  .split('\\n')",
									"  .filter(p => p.trim().length > 0)",
									"  .map(p => `<p>${p}</p>`)",
									"  .join('');",
									"",
									"pm.environment.set(\"escapedContent\", JSON.stringify(html).slice(1, -1));",
									"",
									"const allTags = [\"aspire\", \"dotnet\", \"keycloak\", \"wolverine\", \"ef-core\", \"postgresql\", \"signalr\", \"microservices\", \"nextjs\", \"typescript\"];",
									"",
									"// Pick 1 or 2 tags at random",
									"const shuffled = allTags.sort(() => 0.5 - Math.random());",
									"const selectedTags = shuffled.slice(0, Math.floor(Math.random() * 2) + 1);",
									"",
									"// Set as environment variable for use in body",
									"pm.environment.set('selectedTags', JSON.stringify(selectedTags));"
								],
								"type": "text/javascript",
								"packages": {}
							}
						},
						{
							"listen": "test",
							"script": {
								"exec": [
									"const question = pm.response.json();",
									"",
									"pm.test(\"Has properties\", function () {",
									"    pm.expect(question).to.have.property('id');",
									"});",
									"",
									"if (pm.test(\"Has properties\")) {",
									"    pm.globals.set('questionId', question.id);",
									"    pm.globals.set('questionTitle', question.title);",
									"}"
								],
								"type": "text/javascript",
								"packages": {}
							}
						}
					],
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{bob_token}}",
									"type": "string"
								}
							]
						},
						"method": "POST",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"title\": \"{{$randomPhrase}}\",\n    \"content\": \"{{escapedContent}}\",\n    \"tags\": {{selectedTags}}\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{questionsApi}}/questions",
							"host": [
								"{{questionsApi}}"
							],
							"path": [
								"questions"
							]
						}
					},
					"response": []
				},
				{
					"name": "Post question as Bob",
					"event": [
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									"const raw = pm.variables.replaceIn(\"{{$randomLoremParagraphs}}\");",
									"",
									"// Split on newlines, wrap each line in <p> tags, then join",
									"const html = raw",
									"  .split('\\n')",
									"  .filter(p => p.trim().length > 0)",
									"  .map(p => `<p>${p}</p>`)",
									"  .join('');",
									"",
									"pm.environment.set(\"escapedContent\", JSON.stringify(html).slice(1, -1));",
									"",
									"const allTags = [\"aspire\", \"dotnet\", \"keycloak\", \"wolverine\", \"ef-core\", \"postgresql\", \"signalr\", \"microservices\", \"nextjs\", \"typescript\"];",
									"",
									"// Pick 1 or 2 tags at random",
									"const shuffled = allTags.sort(() => 0.5 - Math.random());",
									"const selectedTags = shuffled.slice(0, Math.floor(Math.random() * 2) + 1);",
									"",
									"// Set as environment variable for use in body",
									"pm.environment.set('selectedTags', JSON.stringify(selectedTags));"
								],
								"type": "text/javascript",
								"packages": {}
							}
						},
						{
							"listen": "test",
							"script": {
								"exec": [
									"const question = pm.response.json();",
									"",
									"pm.test(\"Has properties\", function () {",
									"    pm.expect(question).to.have.property('id');",
									"});",
									"",
									"if (pm.test(\"Has properties\")) {",
									"    pm.globals.set('questionId', question.id);",
									"    pm.globals.set('questionTitle', question.title);",
									"}"
								],
								"type": "text/javascript",
								"packages": {}
							}
						}
					],
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{bob_token}}",
									"type": "string"
								}
							]
						},
						"method": "POST",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"title\": \"{{$randomPhrase}}\",\n    \"content\": \"{{escapedContent}}\",\n    \"tags\": {{selectedTags}}\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{questionsApi}}/questions",
							"host": [
								"{{questionsApi}}"
							],
							"path": [
								"questions"
							]
						}
					},
					"response": []
				},
				{
					"name": "Post answer as Dave",
					"event": [
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									"const raw = pm.variables.replaceIn(\"{{$randomLoremParagraphs}}\");",
									"",
									"// Split on newlines, wrap each line in <p> tags, then join",
									"const html = raw",
									"  .split('\\n')",
									"  .filter(p => p.trim().length > 0)",
									"  .map(p => `<p>${p}</p>`)",
									"  .join('');",
									"",
									"pm.environment.set(\"escapedContent\", JSON.stringify(html).slice(1, -1));"
								],
								"type": "text/javascript",
								"packages": {}
							}
						},
						{
							"listen": "test",
							"script": {
								"exec": [
									"const answer = pm.response.json();",
									"",
									"pm.test(\"Has properties\", function () {",
									"    pm.expect(answer).to.have.property('id');",
									"});",
									"",
									"if (pm.test(\"Has properties\")) {",
									"    pm.globals.set('answerId', answer.id);",
									"}"
								],
								"type": "text/javascript",
								"packages": {}
							}
						}
					],
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{dave_token}}",
									"type": "string"
								}
							]
						},
						"method": "POST",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"content\": \"{{escapedContent}}\",\n    \"questionId\": \"{{questionId}}\"\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{questionsApi}}/questions/{{questionId}}/answers",
							"host": [
								"{{questionsApi}}"
							],
							"path": [
								"questions",
								"{{questionId}}",
								"answers"
							]
						}
					},
					"response": []
				},
				{
					"name": "Post question as Dave",
					"event": [
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									"const raw = pm.variables.replaceIn(\"{{$randomLoremParagraphs}}\");",
									"",
									"// Split on newlines, wrap each line in <p> tags, then join",
									"const html = raw",
									"  .split('\\n')",
									"  .filter(p => p.trim().length > 0)",
									"  .map(p => `<p>${p}</p>`)",
									"  .join('');",
									"",
									"pm.environment.set(\"escapedContent\", JSON.stringify(html).slice(1, -1));",
									"",
									"const allTags = [\"aspire\", \"dotnet\", \"keycloak\", \"wolverine\", \"ef-core\", \"postgresql\", \"signalr\", \"microservices\", \"nextjs\", \"typescript\"];",
									"",
									"// Pick 1 or 2 tags at random",
									"const shuffled = allTags.sort(() => 0.5 - Math.random());",
									"const selectedTags = shuffled.slice(0, Math.floor(Math.random() * 2) + 1);",
									"",
									"// Set as environment variable for use in body",
									"pm.environment.set('selectedTags', JSON.stringify(selectedTags));"
								],
								"type": "text/javascript",
								"packages": {}
							}
						},
						{
							"listen": "test",
							"script": {
								"exec": [
									"const question = pm.response.json();",
									"",
									"pm.test(\"Has properties\", function () {",
									"    pm.expect(question).to.have.property('id');",
									"});",
									"",
									"if (pm.test(\"Has properties\")) {",
									"    pm.globals.set('questionId', question.id);",
									"    pm.globals.set('questionTitle', question.title);",
									"}"
								],
								"type": "text/javascript",
								"packages": {}
							}
						}
					],
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{dave_token}}",
									"type": "string"
								}
							]
						},
						"method": "POST",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"title\": \"{{$randomPhrase}}\",\n    \"content\": \"{{escapedContent}}\",\n    \"tags\": {{selectedTags}}\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{questionsApi}}/questions",
							"host": [
								"{{questionsApi}}"
							],
							"path": [
								"questions"
							]
						}
					},
					"response": []
				},
				{
					"name": "Post question as Dave",
					"event": [
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									"const raw = pm.variables.replaceIn(\"{{$randomLoremParagraphs}}\");",
									"",
									"// Split on newlines, wrap each line in <p> tags, then join",
									"const html = raw",
									"  .split('\\n')",
									"  .filter(p => p.trim().length > 0)",
									"  .map(p => `<p>${p}</p>`)",
									"  .join('');",
									"",
									"pm.environment.set(\"escapedContent\", JSON.stringify(html).slice(1, -1));",
									"",
									"const allTags = [\"aspire\", \"dotnet\", \"keycloak\", \"wolverine\", \"ef-core\", \"postgresql\", \"signalr\", \"microservices\", \"nextjs\", \"typescript\"];",
									"",
									"// Pick 1 or 2 tags at random",
									"const shuffled = allTags.sort(() => 0.5 - Math.random());",
									"const selectedTags = shuffled.slice(0, Math.floor(Math.random() * 2) + 1);",
									"",
									"// Set as environment variable for use in body",
									"pm.environment.set('selectedTags', JSON.stringify(selectedTags));"
								],
								"type": "text/javascript",
								"packages": {}
							}
						},
						{
							"listen": "test",
							"script": {
								"exec": [
									"const question = pm.response.json();",
									"",
									"pm.test(\"Has properties\", function () {",
									"    pm.expect(question).to.have.property('id');",
									"});",
									"",
									"if (pm.test(\"Has properties\")) {",
									"    pm.globals.set('questionId', question.id);",
									"    pm.globals.set('questionTitle', question.title);",
									"}"
								],
								"type": "text/javascript",
								"packages": {}
							}
						}
					],
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{dave_token}}",
									"type": "string"
								}
							]
						},
						"method": "POST",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"title\": \"{{$randomPhrase}}\",\n    \"content\": \"{{escapedContent}}\",\n    \"tags\": {{selectedTags}}\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{questionsApi}}/questions",
							"host": [
								"{{questionsApi}}"
							],
							"path": [
								"questions"
							]
						}
					},
					"response": []
				},
				{
					"name": "Post question as Dave",
					"event": [
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									"const raw = pm.variables.replaceIn(\"{{$randomLoremParagraphs}}\");",
									"",
									"// Split on newlines, wrap each line in <p> tags, then join",
									"const html = raw",
									"  .split('\\n')",
									"  .filter(p => p.trim().length > 0)",
									"  .map(p => `<p>${p}</p>`)",
									"  .join('');",
									"",
									"pm.environment.set(\"escapedContent\", JSON.stringify(html).slice(1, -1));",
									"",
									"const allTags = [\"aspire\", \"dotnet\", \"keycloak\", \"wolverine\", \"ef-core\", \"postgresql\", \"signalr\", \"microservices\", \"nextjs\", \"typescript\"];",
									"",
									"// Pick 1 or 2 tags at random",
									"const shuffled = allTags.sort(() => 0.5 - Math.random());",
									"const selectedTags = shuffled.slice(0, Math.floor(Math.random() * 2) + 1);",
									"",
									"// Set as environment variable for use in body",
									"pm.environment.set('selectedTags', JSON.stringify(selectedTags));"
								],
								"type": "text/javascript",
								"packages": {}
							}
						},
						{
							"listen": "test",
							"script": {
								"exec": [
									"const question = pm.response.json();",
									"",
									"pm.test(\"Has properties\", function () {",
									"    pm.expect(question).to.have.property('id');",
									"});",
									"",
									"if (pm.test(\"Has properties\")) {",
									"    pm.globals.set('questionId', question.id);",
									"    pm.globals.set('questionTitle', question.title);",
									"}"
								],
								"type": "text/javascript",
								"packages": {}
							}
						}
					],
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{dave_token}}",
									"type": "string"
								}
							]
						},
						"method": "POST",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"title\": \"{{$randomPhrase}}\",\n    \"content\": \"{{escapedContent}}\",\n    \"tags\": {{selectedTags}}\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{questionsApi}}/questions",
							"host": [
								"{{questionsApi}}"
							],
							"path": [
								"questions"
							]
						}
					},
					"response": []
				},
				{
					"name": "Post answer as Bob",
					"event": [
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									"const raw = pm.variables.replaceIn(\"{{$randomLoremParagraphs}}\");",
									"",
									"// Split on newlines, wrap each line in <p> tags, then join",
									"const html = raw",
									"  .split('\\n')",
									"  .filter(p => p.trim().length > 0)",
									"  .map(p => `<p>${p}</p>`)",
									"  .join('');",
									"",
									"pm.environment.set(\"escapedContent\", JSON.stringify(html).slice(1, -1));"
								],
								"type": "text/javascript",
								"packages": {}
							}
						},
						{
							"listen": "test",
							"script": {
								"exec": [
									"const answer = pm.response.json();",
									"",
									"pm.test(\"Has properties\", function () {",
									"    pm.expect(answer).to.have.property('id');",
									"});",
									"",
									"if (pm.test(\"Has properties\")) {",
									"    pm.globals.set('answerId', answer.id);",
									"}"
								],
								"type": "text/javascript",
								"packages": {}
							}
						}
					],
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{bob_token}}",
									"type": "string"
								}
							]
						},
						"method": "POST",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"content\": \"{{escapedContent}}\",\n    \"questionId\": \"{{questionId}}\"\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{questionsApi}}/questions/{{questionId}}/answers",
							"host": [
								"{{questionsApi}}"
							],
							"path": [
								"questions",
								"{{questionId}}",
								"answers"
							]
						}
					},
					"response": []
				},
				{
					"name": "Post answer as Bob",
					"event": [
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									"const raw = pm.variables.replaceIn(\"{{$randomLoremParagraphs}}\");",
									"",
									"// Split on newlines, wrap each line in <p> tags, then join",
									"const html = raw",
									"  .split('\\n')",
									"  .filter(p => p.trim().length > 0)",
									"  .map(p => `<p>${p}</p>`)",
									"  .join('');",
									"",
									"pm.environment.set(\"escapedContent\", JSON.stringify(html).slice(1, -1));"
								],
								"type": "text/javascript",
								"packages": {}
							}
						},
						{
							"listen": "test",
							"script": {
								"exec": [
									"const answer = pm.response.json();",
									"",
									"pm.test(\"Has properties\", function () {",
									"    pm.expect(answer).to.have.property('id');",
									"});",
									"",
									"if (pm.test(\"Has properties\")) {",
									"    pm.globals.set('answerId', answer.id);",
									"}"
								],
								"type": "text/javascript",
								"packages": {}
							}
						}
					],
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{bob_token}}",
									"type": "string"
								}
							]
						},
						"method": "POST",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"content\": \"{{escapedContent}}\",\n    \"questionId\": \"{{questionId}}\"\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{questionsApi}}/questions/{{questionId}}/answers",
							"host": [
								"{{questionsApi}}"
							],
							"path": [
								"questions",
								"{{questionId}}",
								"answers"
							]
						}
					},
					"response": []
				},
				{
					"name": "Accept answer for question",
					"event": [
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									"const raw = pm.variables.replaceIn(\"{{$randomLoremParagraphs}}\");",
									"",
									"// Split on newlines, wrap each line in <p> tags, then join",
									"const html = raw",
									"  .split('\\n')",
									"  .filter(p => p.trim().length > 0)",
									"  .map(p => `<p>${p}</p>`)",
									"  .join('');",
									"",
									"pm.environment.set(\"escapedContent\", JSON.stringify(html).slice(1, -1));"
								],
								"type": "text/javascript",
								"packages": {}
							}
						},
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Response returns 204\", function () {",
									"    pm.response.to.have.status(204);",
									"});"
								],
								"type": "text/javascript",
								"packages": {}
							}
						}
					],
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{dave_token}}",
									"type": "string"
								}
							]
						},
						"method": "POST",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{questionsApi}}/questions/{{questionId}}/answers/{{answerId}}/accept",
							"host": [
								"{{questionsApi}}"
							],
							"path": [
								"questions",
								"{{questionId}}",
								"answers",
								"{{answerId}}",
								"accept"
							]
						}
					},
					"response": []
				},
				{
					"name": "Post answer as Bob",
					"event": [
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									"const raw = pm.variables.replaceIn(\"{{$randomLoremParagraphs}}\");",
									"",
									"// Split on newlines, wrap each line in <p> tags, then join",
									"const html = raw",
									"  .split('\\n')",
									"  .filter(p => p.trim().length > 0)",
									"  .map(p => `<p>${p}</p>`)",
									"  .join('');",
									"",
									"pm.environment.set(\"escapedContent\", JSON.stringify(html).slice(1, -1));"
								],
								"type": "text/javascript",
								"packages": {}
							}
						},
						{
							"listen": "test",
							"script": {
								"exec": [
									"const answer = pm.response.json();",
									"",
									"pm.test(\"Has properties\", function () {",
									"    pm.expect(answer).to.have.property('id');",
									"});",
									"",
									"if (pm.test(\"Has properties\")) {",
									"    pm.globals.set('answerId', answer.id);",
									"}"
								],
								"type": "text/javascript",
								"packages": {}
							}
						}
					],
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{bob_token}}",
									"type": "string"
								}
							]
						},
						"method": "POST",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"content\": \"{{escapedContent}}\",\n    \"questionId\": \"{{questionId}}\"\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{questionsApi}}/questions/{{questionId}}/answers",
							"host": [
								"{{questionsApi}}"
							],
							"path": [
								"questions",
								"{{questionId}}",
								"answers"
							]
						}
					},
					"response": []
				},
				{
					"name": "Post answer as Bob",
					"event": [
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									"const raw = pm.variables.replaceIn(\"{{$randomLoremParagraphs}}\");",
									"",
									"// Split on newlines, wrap each line in <p> tags, then join",
									"const html = raw",
									"  .split('\\n')",
									"  .filter(p => p.trim().length > 0)",
									"  .map(p => `<p>${p}</p>`)",
									"  .join('');",
									"",
									"pm.environment.set(\"escapedContent\", JSON.stringify(html).slice(1, -1));"
								],
								"type": "text/javascript",
								"packages": {}
							}
						},
						{
							"listen": "test",
							"script": {
								"exec": [
									"const answer = pm.response.json();",
									"",
									"pm.test(\"Has properties\", function () {",
									"    pm.expect(answer).to.have.property('id');",
									"});",
									"",
									"if (pm.test(\"Has properties\")) {",
									"    pm.globals.set('answerId', answer.id);",
									"}"
								],
								"type": "text/javascript",
								"packages": {}
							}
						}
					],
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{bob_token}}",
									"type": "string"
								}
							]
						},
						"method": "POST",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"content\": \"{{escapedContent}}\",\n    \"questionId\": \"{{questionId}}\"\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{questionsApi}}/questions/{{questionId}}/answers",
							"host": [
								"{{questionsApi}}"
							],
							"path": [
								"questions",
								"{{questionId}}",
								"answers"
							]
						}
					},
					"response": []
				}
			]
		},
		{
			"name": "Section 9 Client auth",
			"item": [
				{
					"name": "Test auth with nextjs token",
					"event": [
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									"const raw = pm.variables.replaceIn(\"{{$randomLoremParagraphs}}\");",
									"",
									"// Split on newlines, wrap each line in <p> tags, then join",
									"const html = raw",
									"  .split('\\n')",
									"  .filter(p => p.trim().length > 0)",
									"  .map(p => `<p>${p}</p>`)",
									"  .join('');",
									"",
									"pm.environment.set(\"escapedContent\", JSON.stringify(html).slice(1, -1));",
									"",
									"const allTags = [\"aspire\", \"dotnet\", \"keycloak\", \"wolverine\", \"ef-core\", \"postgresql\", \"signalr\", \"microservices\", \"nextjs\", \"typescript\"];",
									"",
									"// Pick 1 or 2 tags at random",
									"const shuffled = allTags.sort(() => 0.5 - Math.random());",
									"const selectedTags = shuffled.slice(0, Math.floor(Math.random() * 2) + 1);",
									"",
									"// Set as environment variable for use in body",
									"pm.environment.set('selectedTags', JSON.stringify(selectedTags));"
								],
								"type": "text/javascript",
								"packages": {}
							}
						},
						{
							"listen": "test",
							"script": {
								"exec": [
									"const question = pm.response.json();",
									"",
									"pm.test(\"Has properties\", function () {",
									"    pm.expect(question).to.have.property('id');",
									"});",
									"",
									"if (pm.test(\"Has properties\")) {",
									"    pm.globals.set('questionId', question.id);",
									"}"
								],
								"type": "text/javascript",
								"packages": {}
							}
						}
					],
					"protocolProfileBehavior": {
						"disableBodyPruning": true
					},
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJna0VZcWFTMXVrdjBOMlAzeVc5OElVZXQ2Q1BzYTRuWlVYTk80QURiaUVZIn0.eyJleHAiOjE3NTQyMTIyNzUsImlhdCI6MTc1NDIxMTk3NSwiYXV0aF90aW1lIjoxNzU0MjA5MDkzLCJqdGkiOiJvbnJ0YWM6NzcxYTk5OWEtZDQ1My00ZGQ0LWFmZTAtNjkwNjVjZTdhYTM5IiwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo2MDAxL3JlYWxtcy9vdmVyZmxvdyIsImF1ZCI6ImZha2UiLCJzdWIiOiIwYTY5NGY4ZS02ZDNkLTQyYmMtOTVkNy0zNzA5MmI3NjAwZTIiLCJ0eXAiOiJCZWFyZXIiLCJhenAiOiJuZXh0anMiLCJzaWQiOiJlYjM1ZGI2ZS0yZGI0LTQzODItODg1Mi1lMGExZjQ1MDExNTciLCJhY3IiOiIwIiwic2NvcGUiOiJvcGVuaWQgcHJvZmlsZSBlbWFpbCIsImVtYWlsX3ZlcmlmaWVkIjp0cnVlLCJuYW1lIjoiQm9iIEJvYmJpdHkiLCJwcmVmZXJyZWRfdXNlcm5hbWUiOiJib2IiLCJnaXZlbl9uYW1lIjoiQm9iIiwiZmFtaWx5X25hbWUiOiJCb2JiaXR5IiwiZW1haWwiOiJib2JAdGVzdC5jb20ifQ.k1N9aURw9tM86y8a92-FBu4efQ6J17XZhzUq8kXhqlus_QdDzRBDfHHJnWmYCWGMizcJrrubHBmkLns_gZU1npVVzaAJfsmsO8yac6jy7NJHiNR9jBci-TR_UamEoiv27NApr3gmYIqX-RpzDfxdt3VVAH7-Bs7TaMoPOWF3_xluLheBCr-cuUDorShJW2Z1V2S_OxBo5qmeTow9_xxrWvSx0KZacY7ZrNVvlYefVeOAWeavrkueqyLKyDzYP8gIoLNMQyQd31TZpFdjDmBqpvfd31xsLii3X4r0KhcDaRVfenTEMvJMsxzrtszYx91r4m_24k5gMiFUbNB-jobYqA",
									"type": "string"
								}
							]
						},
						"method": "GET",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"title\": \"XSS test 1\",\n  \"content\": \"<p>This is a test</p><img src=x onerror=\\\"alert('You have been hacked.  Give me all your money!!!')\\\">\",\n  \"tags\": [\"nextjs\"]\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{gateway}}/test/auth",
							"host": [
								"{{gateway}}"
							],
							"path": [
								"test",
								"auth"
							]
						}
					},
					"response": []
				}
			]
		},
		{
			"name": "Section 10 Forms",
			"item": [
				{
					"name": "Login as bob",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"const user = pm.response.json();",
									"",
									"pm.test(\"Has properties\", function () {",
									"    pm.expect(user).to.have.property('access_token');",
									"});",
									"",
									"if (pm.test(\"Has properties\")) {",
									"    pm.globals.set('bob_token', user.access_token);",
									"}"
								],
								"type": "text/javascript",
								"packages": {}
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [],
						"body": {
							"mode": "urlencoded",
							"urlencoded": [
								{
									"key": "username",
									"value": "bob",
									"type": "text"
								},
								{
									"key": "password",
									"value": "Pa$$w0rd",
									"type": "text"
								},
								{
									"key": "client_id",
									"value": "postman",
									"type": "text"
								},
								{
									"key": "grant_type",
									"value": "password",
									"type": "text"
								},
								{
									"key": "client_secret",
									"value": "zWJYJbQJ2ygrDvDxFSdhs8MSroFlGZcs",
									"type": "text",
									"disabled": true
								}
							]
						},
						"url": {
							"raw": "{{identityApi}}/realms/overflow/protocol/openid-connect/token",
							"host": [
								"{{identityApi}}"
							],
							"path": [
								"realms",
								"overflow",
								"protocol",
								"openid-connect",
								"token"
							]
						}
					},
					"response": []
				},
				{
					"name": "Post question with malicious script",
					"event": [
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									"const raw = pm.variables.replaceIn(\"{{$randomLoremParagraphs}}\");",
									"",
									"// Split on newlines, wrap each line in <p> tags, then join",
									"const html = raw",
									"  .split('\\n')",
									"  .filter(p => p.trim().length > 0)",
									"  .map(p => `<p>${p}</p>`)",
									"  .join('');",
									"",
									"pm.environment.set(\"escapedContent\", JSON.stringify(html).slice(1, -1));",
									"",
									"const allTags = [\"aspire\", \"dotnet\", \"keycloak\", \"wolverine\", \"ef-core\", \"postgresql\", \"signalr\", \"microservices\", \"nextjs\", \"typescript\"];",
									"",
									"// Pick 1 or 2 tags at random",
									"const shuffled = allTags.sort(() => 0.5 - Math.random());",
									"const selectedTags = shuffled.slice(0, Math.floor(Math.random() * 2) + 1);",
									"",
									"// Set as environment variable for use in body",
									"pm.environment.set('selectedTags', JSON.stringify(selectedTags));"
								],
								"type": "text/javascript",
								"packages": {}
							}
						},
						{
							"listen": "test",
							"script": {
								"exec": [
									"const question = pm.response.json();",
									"",
									"pm.test(\"Has properties\", function () {",
									"    pm.expect(question).to.have.property('id');",
									"});",
									"",
									"if (pm.test(\"Has properties\")) {",
									"    pm.globals.set('questionId', question.id);",
									"}"
								],
								"type": "text/javascript",
								"packages": {}
							}
						}
					],
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{bob_token}}",
									"type": "string"
								}
							]
						},
						"method": "POST",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"title\": \"{{$randomPhrase}}\",\n    \"content\": \"<p>This is a test</p><img src=x onerror=\\\"alert('You have been hacked. Gimme all your cash!!!')\\\">\",\n    \"tags\": {{selectedTags}}\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{gateway}}/questions",
							"host": [
								"{{gateway}}"
							],
							"path": [
								"questions"
							]
						}
					},
					"response": []
				},
				{
					"name": "Delete question",
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{bob_token}}",
									"type": "string"
								}
							]
						},
						"method": "DELETE",
						"header": [],
						"url": {
							"raw": "{{gateway}}/questions/{{questionId}}",
							"host": [
								"{{gateway}}"
							],
							"path": [
								"questions",
								"{{questionId}}"
							]
						}
					},
					"response": []
				}
			]
		},
		{
			"name": "Section 12 Profile Svc",
			"item": [
				{
					"name": "Login as bob",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"const user = pm.response.json();",
									"",
									"pm.test(\"Has properties\", function () {",
									"    pm.expect(user).to.have.property('access_token');",
									"});",
									"",
									"if (pm.test(\"Has properties\")) {",
									"    pm.globals.set('bob_token', user.access_token);",
									"}"
								],
								"type": "text/javascript",
								"packages": {}
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [],
						"body": {
							"mode": "urlencoded",
							"urlencoded": [
								{
									"key": "username",
									"value": "bob",
									"type": "text"
								},
								{
									"key": "password",
									"value": "Pa$$w0rd",
									"type": "text"
								},
								{
									"key": "client_id",
									"value": "postman",
									"type": "text"
								},
								{
									"key": "grant_type",
									"value": "password",
									"type": "text"
								},
								{
									"key": "client_secret",
									"value": "zWJYJbQJ2ygrDvDxFSdhs8MSroFlGZcs",
									"type": "text",
									"disabled": true
								}
							]
						},
						"url": {
							"raw": "{{identityApi}}/realms/overflow/protocol/openid-connect/token",
							"host": [
								"{{identityApi}}"
							],
							"path": [
								"realms",
								"overflow",
								"protocol",
								"openid-connect",
								"token"
							]
						}
					},
					"response": []
				},
				{
					"name": "Login as dave",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"const user = pm.response.json();",
									"",
									"pm.test(\"Has properties\", function () {",
									"    pm.expect(user).to.have.property('access_token');",
									"});",
									"",
									"if (pm.test(\"Has properties\")) {",
									"    pm.globals.set('dave_token', user.access_token);",
									"}"
								],
								"type": "text/javascript",
								"packages": {}
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [],
						"body": {
							"mode": "urlencoded",
							"urlencoded": [
								{
									"key": "username",
									"value": "dave",
									"type": "text"
								},
								{
									"key": "password",
									"value": "Pa$$w0rd",
									"type": "text"
								},
								{
									"key": "client_id",
									"value": "postman",
									"type": "text"
								},
								{
									"key": "grant_type",
									"value": "password",
									"type": "text"
								},
								{
									"key": "client_secret",
									"value": "zWJYJbQJ2ygrDvDxFSdhs8MSroFlGZcs",
									"type": "text",
									"disabled": true
								}
							]
						},
						"url": {
							"raw": "{{identityApi}}/realms/overflow/protocol/openid-connect/token",
							"host": [
								"{{identityApi}}"
							],
							"path": [
								"realms",
								"overflow",
								"protocol",
								"openid-connect",
								"token"
							]
						}
					},
					"response": []
				},
				{
					"name": "Get Me (bob)",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"const user = pm.response.json();",
									"",
									"pm.test(\"Has properties\", function () {",
									"    pm.expect(user).to.have.property('id');",
									"});",
									"",
									"if (pm.test(\"Has properties\")) {",
									"    pm.globals.set('bob_id', user.id);",
									"}"
								],
								"type": "text/javascript",
								"packages": {}
							}
						}
					],
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{bob_token}}",
									"type": "string"
								}
							]
						},
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{gateway}}/profiles/me",
							"host": [
								"{{gateway}}"
							],
							"path": [
								"profiles",
								"me"
							]
						}
					},
					"response": []
				},
				{
					"name": "Get Me (dave)",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"const user = pm.response.json();",
									"",
									"pm.test(\"Has properties\", function () {",
									"    pm.expect(user).to.have.property('id');",
									"});",
									"",
									"if (pm.test(\"Has properties\")) {",
									"    pm.globals.set('dave_id', user.id);",
									"}"
								],
								"type": "text/javascript",
								"packages": {}
							}
						}
					],
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{dave_token}}",
									"type": "string"
								}
							]
						},
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{gateway}}/profiles/me",
							"host": [
								"{{gateway}}"
							],
							"path": [
								"profiles",
								"me"
							]
						}
					},
					"response": []
				},
				{
					"name": "Get batched profiles",
					"protocolProfileBehavior": {
						"disableBodyPruning": true
					},
					"request": {
						"auth": {
							"type": "noauth"
						},
						"method": "GET",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{gateway}}/profiles/batch?ids={{bob_id}}",
							"host": [
								"{{gateway}}"
							],
							"path": [
								"profiles",
								"batch"
							],
							"query": [
								{
									"key": "ids",
									"value": "{{bob_id}}"
								}
							]
						}
					},
					"response": []
				},
				{
					"name": "Get list of profiles alphabetical",
					"protocolProfileBehavior": {
						"disableBodyPruning": true
					},
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{dave_token}}",
									"type": "string"
								}
							]
						},
						"method": "GET",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"ids\": [\"{{bob_id}}\",\"{{dave_id}}\"]\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{gateway}}/profiles",
							"host": [
								"{{gateway}}"
							],
							"path": [
								"profiles"
							]
						}
					},
					"response": []
				},
				{
					"name": "Get list of profiles by reputation",
					"protocolProfileBehavior": {
						"disableBodyPruning": true
					},
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{dave_token}}",
									"type": "string"
								}
							]
						},
						"method": "GET",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"ids\": [\"{{bob_id}}\",\"{{dave_id}}\"]\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{gateway}}/profiles?sortBy=reputation",
							"host": [
								"{{gateway}}"
							],
							"path": [
								"profiles"
							],
							"query": [
								{
									"key": "sortBy",
									"value": "reputation"
								}
							]
						}
					},
					"response": []
				},
				{
					"name": "Get profiles by id",
					"protocolProfileBehavior": {
						"disableBodyPruning": true
					},
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{dave_token}}",
									"type": "string"
								}
							]
						},
						"method": "GET",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"ids\": [\"{{bob_id}}\",\"{{dave_id}}\"]\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{gateway}}/profiles/{{bob_id}}",
							"host": [
								"{{gateway}}"
							],
							"path": [
								"profiles",
								"{{bob_id}}"
							]
						}
					},
					"response": []
				},
				{
					"name": "Edit bob profile",
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{bob_token}}",
									"type": "string"
								}
							]
						},
						"method": "PUT",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"displayName\": \"Bobby\",\n    \"description\": \"Hi I am Bob\"\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{gateway}}/profiles/edit",
							"host": [
								"{{gateway}}"
							],
							"path": [
								"profiles",
								"edit"
							]
						}
					},
					"response": []
				}
			]
		},
		{
			"name": "Section 13 Vote Svc",
			"item": [
				{
					"name": "Setup",
					"item": [
						{
							"name": "Login as dave",
							"event": [
								{
									"listen": "test",
									"script": {
										"exec": [
											"const user = pm.response.json();",
											"",
											"pm.test(\"Has properties\", function () {",
											"    pm.expect(user).to.have.property('access_token');",
											"});",
											"",
											"if (pm.test(\"Has properties\")) {",
											"    pm.globals.set('dave_token', user.access_token);",
											"}"
										],
										"type": "text/javascript",
										"packages": {}
									}
								}
							],
							"request": {
								"method": "POST",
								"header": [],
								"body": {
									"mode": "urlencoded",
									"urlencoded": [
										{
											"key": "username",
											"value": "dave",
											"type": "text"
										},
										{
											"key": "password",
											"value": "Pa$$w0rd",
											"type": "text"
										},
										{
											"key": "client_id",
											"value": "postman",
											"type": "text"
										},
										{
											"key": "grant_type",
											"value": "password",
											"type": "text"
										},
										{
											"key": "client_secret",
											"value": "zWJYJbQJ2ygrDvDxFSdhs8MSroFlGZcs",
											"type": "text",
											"disabled": true
										}
									]
								},
								"url": {
									"raw": "{{identityApi}}/realms/overflow/protocol/openid-connect/token",
									"host": [
										"{{identityApi}}"
									],
									"path": [
										"realms",
										"overflow",
										"protocol",
										"openid-connect",
										"token"
									]
								}
							},
							"response": []
						},
						{
							"name": "Login as bob",
							"event": [
								{
									"listen": "test",
									"script": {
										"exec": [
											"const user = pm.response.json();",
											"",
											"pm.test(\"Has properties\", function () {",
											"    pm.expect(user).to.have.property('access_token');",
											"});",
											"",
											"if (pm.test(\"Has properties\")) {",
											"    pm.globals.set('bob_token', user.access_token);",
											"}"
										],
										"type": "text/javascript",
										"packages": {}
									}
								}
							],
							"request": {
								"method": "POST",
								"header": [],
								"body": {
									"mode": "urlencoded",
									"urlencoded": [
										{
											"key": "username",
											"value": "bob",
											"type": "text"
										},
										{
											"key": "password",
											"value": "Pa$$w0rd",
											"type": "text"
										},
										{
											"key": "client_id",
											"value": "postman",
											"type": "text"
										},
										{
											"key": "grant_type",
											"value": "password",
											"type": "text"
										},
										{
											"key": "client_secret",
											"value": "zWJYJbQJ2ygrDvDxFSdhs8MSroFlGZcs",
											"type": "text",
											"disabled": true
										}
									]
								},
								"url": {
									"raw": "{{identityApi}}/realms/overflow/protocol/openid-connect/token",
									"host": [
										"{{identityApi}}"
									],
									"path": [
										"realms",
										"overflow",
										"protocol",
										"openid-connect",
										"token"
									]
								}
							},
							"response": []
						},
						{
							"name": "Get Me (Bob)",
							"event": [
								{
									"listen": "test",
									"script": {
										"exec": [
											"const user = pm.response.json();",
											"",
											"pm.test(\"Has properties\", function () {",
											"    pm.expect(user).to.have.property('id');",
											"});",
											"",
											"if (pm.test(\"Has properties\")) {",
											"    pm.globals.set('bob_id', user.id);",
											"}"
										],
										"type": "text/javascript",
										"packages": {}
									}
								}
							],
							"request": {
								"auth": {
									"type": "bearer",
									"bearer": [
										{
											"key": "token",
											"value": "{{bob_token}}",
											"type": "string"
										}
									]
								},
								"method": "GET",
								"header": [],
								"url": {
									"raw": "{{gateway}}/profiles/me",
									"host": [
										"{{gateway}}"
									],
									"path": [
										"profiles",
										"me"
									]
								}
							},
							"response": []
						},
						{
							"name": "Get Me (dave)",
							"request": {
								"auth": {
									"type": "bearer",
									"bearer": [
										{
											"key": "token",
											"value": "{{dave_token}}",
											"type": "string"
										}
									]
								},
								"method": "GET",
								"header": [],
								"url": {
									"raw": "{{gateway}}/profiles/me",
									"host": [
										"{{gateway}}"
									],
									"path": [
										"profiles",
										"me"
									]
								}
							},
							"response": []
						}
					]
				},
				{
					"name": "Trending tags",
					"item": [
						{
							"name": "Login as bob",
							"event": [
								{
									"listen": "test",
									"script": {
										"exec": [
											"const user = pm.response.json();",
											"",
											"pm.test(\"Has properties\", function () {",
											"    pm.expect(user).to.have.property('access_token');",
											"});",
											"",
											"if (pm.test(\"Has properties\")) {",
											"    pm.globals.set('bob_token', user.access_token);",
											"}"
										],
										"type": "text/javascript",
										"packages": {}
									}
								}
							],
							"request": {
								"method": "POST",
								"header": [],
								"body": {
									"mode": "urlencoded",
									"urlencoded": [
										{
											"key": "username",
											"value": "bob",
											"type": "text"
										},
										{
											"key": "password",
											"value": "Pa$$w0rd",
											"type": "text"
										},
										{
											"key": "client_id",
											"value": "postman",
											"type": "text"
										},
										{
											"key": "grant_type",
											"value": "password",
											"type": "text"
										},
										{
											"key": "client_secret",
											"value": "zWJYJbQJ2ygrDvDxFSdhs8MSroFlGZcs",
											"type": "text",
											"disabled": true
										}
									]
								},
								"url": {
									"raw": "{{identityApi}}/realms/overflow/protocol/openid-connect/token",
									"host": [
										"{{identityApi}}"
									],
									"path": [
										"realms",
										"overflow",
										"protocol",
										"openid-connect",
										"token"
									]
								}
							},
							"response": []
						},
						{
							"name": "Post question as Bob",
							"event": [
								{
									"listen": "prerequest",
									"script": {
										"exec": [
											"const raw = pm.variables.replaceIn(\"{{$randomLoremParagraphs}}\");",
											"",
											"// Split on newlines, wrap each line in <p> tags, then join",
											"const html = raw",
											"  .split('\\n')",
											"  .filter(p => p.trim().length > 0)",
											"  .map(p => `<p>${p}</p>`)",
											"  .join('');",
											"",
											"pm.environment.set(\"escapedContent\", JSON.stringify(html).slice(1, -1));",
											"",
											"const allTags = [\"aspire\", \"dotnet\", \"keycloak\", \"wolverine\", \"ef-core\", \"postgresql\", \"signalr\", \"microservices\", \"nextjs\", \"typescript\"];",
											"",
											"// Pick 1 or 2 tags at random",
											"const shuffled = allTags.sort(() => 0.5 - Math.random());",
											"const selectedTags = shuffled.slice(0, Math.floor(Math.random() * 2) + 1);",
											"",
											"// Set as environment variable for use in body",
											"pm.environment.set('selectedTags', JSON.stringify(selectedTags));"
										],
										"type": "text/javascript",
										"packages": {}
									}
								},
								{
									"listen": "test",
									"script": {
										"exec": [
											"const question = pm.response.json();",
											"",
											"pm.test(\"Has properties\", function () {",
											"    pm.expect(question).to.have.property('id');",
											"});",
											"",
											"if (pm.test(\"Has properties\")) {",
											"    pm.globals.set('questionId', question.id);",
											"    pm.globals.set('questionTitle', question.title);",
											"}"
										],
										"type": "text/javascript",
										"packages": {}
									}
								}
							],
							"request": {
								"auth": {
									"type": "bearer",
									"bearer": [
										{
											"key": "token",
											"value": "{{bob_token}}",
											"type": "string"
										}
									]
								},
								"method": "POST",
								"header": [],
								"body": {
									"mode": "raw",
									"raw": "{\n    \"title\": \"{{$randomPhrase}}\",\n    \"content\": \"{{escapedContent}}\",\n    \"tags\": {{selectedTags}}\n}",
									"options": {
										"raw": {
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "{{gateway}}/questions",
									"host": [
										"{{gateway}}"
									],
									"path": [
										"questions"
									]
								}
							},
							"response": []
						},
						{
							"name": "Get trending tags",
							"request": {
								"method": "GET",
								"header": [],
								"url": {
									"raw": "{{gateway}}/stats/trending-tags",
									"host": [
										"{{gateway}}"
									],
									"path": [
										"stats",
										"trending-tags"
									]
								}
							},
							"response": []
						}
					]
				},
				{
					"name": "Accept answer",
					"item": [
						{
							"name": "Login as bob",
							"event": [
								{
									"listen": "test",
									"script": {
										"exec": [
											"const user = pm.response.json();",
											"",
											"pm.test(\"Has properties\", function () {",
											"    pm.expect(user).to.have.property('access_token');",
											"});",
											"",
											"if (pm.test(\"Has properties\")) {",
											"    pm.globals.set('bob_token', user.access_token);",
											"}"
										],
										"type": "text/javascript",
										"packages": {}
									}
								}
							],
							"request": {
								"method": "POST",
								"header": [],
								"body": {
									"mode": "urlencoded",
									"urlencoded": [
										{
											"key": "username",
											"value": "bob",
											"type": "text"
										},
										{
											"key": "password",
											"value": "Pa$$w0rd",
											"type": "text"
										},
										{
											"key": "client_id",
											"value": "postman",
											"type": "text"
										},
										{
											"key": "grant_type",
											"value": "password",
											"type": "text"
										},
										{
											"key": "client_secret",
											"value": "zWJYJbQJ2ygrDvDxFSdhs8MSroFlGZcs",
											"type": "text",
											"disabled": true
										}
									]
								},
								"url": {
									"raw": "{{identityApi}}/realms/overflow/protocol/openid-connect/token",
									"host": [
										"{{identityApi}}"
									],
									"path": [
										"realms",
										"overflow",
										"protocol",
										"openid-connect",
										"token"
									]
								}
							},
							"response": []
						},
						{
							"name": "Login as dave",
							"event": [
								{
									"listen": "test",
									"script": {
										"exec": [
											"const user = pm.response.json();",
											"",
											"pm.test(\"Has properties\", function () {",
											"    pm.expect(user).to.have.property('access_token');",
											"});",
											"",
											"if (pm.test(\"Has properties\")) {",
											"    pm.globals.set('dave_token', user.access_token);",
											"}"
										],
										"type": "text/javascript",
										"packages": {}
									}
								}
							],
							"request": {
								"method": "POST",
								"header": [],
								"body": {
									"mode": "urlencoded",
									"urlencoded": [
										{
											"key": "username",
											"value": "dave",
											"type": "text"
										},
										{
											"key": "password",
											"value": "Pa$$w0rd",
											"type": "text"
										},
										{
											"key": "client_id",
											"value": "postman",
											"type": "text"
										},
										{
											"key": "grant_type",
											"value": "password",
											"type": "text"
										},
										{
											"key": "client_secret",
											"value": "zWJYJbQJ2ygrDvDxFSdhs8MSroFlGZcs",
											"type": "text",
											"disabled": true
										}
									]
								},
								"url": {
									"raw": "{{identityApi}}/realms/overflow/protocol/openid-connect/token",
									"host": [
										"{{identityApi}}"
									],
									"path": [
										"realms",
										"overflow",
										"protocol",
										"openid-connect",
										"token"
									]
								}
							},
							"response": []
						},
						{
							"name": "Post question (bob)",
							"event": [
								{
									"listen": "test",
									"script": {
										"exec": [
											"const question = pm.response.json();",
											"",
											"pm.test(\"Has properties\", function () {",
											"    pm.expect(question).to.have.property('id');",
											"});",
											"",
											"if (pm.test(\"Has properties\")) {",
											"    pm.globals.set('questionId', question.id);",
											"}"
										],
										"type": "text/javascript",
										"packages": {}
									}
								},
								{
									"listen": "prerequest",
									"script": {
										"exec": [
											"const raw = pm.variables.replaceIn(\"{{$randomLoremParagraphs}}\");",
											"",
											"// Split on newlines, wrap each line in <p> tags, then join",
											"const html = raw",
											"  .split('\\n')",
											"  .filter(p => p.trim().length > 0)",
											"  .map(p => `<p>${p}</p>`)",
											"  .join('');",
											"",
											"pm.environment.set(\"escapedContent\", JSON.stringify(html).slice(1, -1));",
											"",
											"const allTags = [\"aspire\", \"dotnet\", \"keycloak\", \"wolverine\", \"ef-core\", \"postgresql\", \"signalr\", \"microservices\", \"nextjs\", \"typescript\"];",
											"",
											"// Pick 1 or 2 tags at random",
											"const shuffled = allTags.sort(() => 0.5 - Math.random());",
											"const selectedTags = shuffled.slice(0, Math.floor(Math.random() * 2) + 1);",
											"",
											"// Set as environment variable for use in body",
											"pm.environment.set('selectedTags', JSON.stringify(selectedTags));"
										],
										"type": "text/javascript",
										"packages": {}
									}
								}
							],
							"request": {
								"auth": {
									"type": "bearer",
									"bearer": [
										{
											"key": "token",
											"value": "{{bob_token}}",
											"type": "string"
										}
									]
								},
								"method": "POST",
								"header": [],
								"body": {
									"mode": "raw",
									"raw": "{\n    \"title\": \"{{$randomPhrase}}\",\n    \"content\": \"{{escapedContent}}\",\n    \"tags\": {{selectedTags}}\n}",
									"options": {
										"raw": {
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "{{gateway}}/questions",
									"host": [
										"{{gateway}}"
									],
									"path": [
										"questions"
									]
								}
							},
							"response": []
						},
						{
							"name": "Post answer as Dave",
							"event": [
								{
									"listen": "prerequest",
									"script": {
										"exec": [
											"const raw = pm.variables.replaceIn(\"{{$randomLoremParagraphs}}\");",
											"",
											"// Split on newlines, wrap each line in <p> tags, then join",
											"const html = raw",
											"  .split('\\n')",
											"  .filter(p => p.trim().length > 0)",
											"  .map(p => `<p>${p}</p>`)",
											"  .join('');",
											"",
											"pm.environment.set(\"escapedContent\", JSON.stringify(html).slice(1, -1));"
										],
										"type": "text/javascript",
										"packages": {}
									}
								},
								{
									"listen": "test",
									"script": {
										"exec": [
											"const answer = pm.response.json();",
											"",
											"pm.test(\"Has properties\", function () {",
											"    pm.expect(answer).to.have.property('id');",
											"});",
											"",
											"if (pm.test(\"Has properties\")) {",
											"    pm.globals.set('answerId', answer.id);",
											"}"
										],
										"type": "text/javascript",
										"packages": {}
									}
								}
							],
							"request": {
								"auth": {
									"type": "bearer",
									"bearer": [
										{
											"key": "token",
											"value": "{{dave_token}}",
											"type": "string"
										}
									]
								},
								"method": "POST",
								"header": [],
								"body": {
									"mode": "raw",
									"raw": "{\n    \"content\": \"{{escapedContent}}\",\n    \"questionId\": \"{{questionId}}\"\n}",
									"options": {
										"raw": {
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "{{gateway}}/questions/{{questionId}}/answers",
									"host": [
										"{{gateway}}"
									],
									"path": [
										"questions",
										"{{questionId}}",
										"answers"
									]
								}
							},
							"response": []
						},
						{
							"name": "Accept answer for question",
							"event": [
								{
									"listen": "prerequest",
									"script": {
										"exec": [
											"const raw = pm.variables.replaceIn(\"{{$randomLoremParagraphs}}\");",
											"",
											"// Split on newlines, wrap each line in <p> tags, then join",
											"const html = raw",
											"  .split('\\n')",
											"  .filter(p => p.trim().length > 0)",
											"  .map(p => `<p>${p}</p>`)",
											"  .join('');",
											"",
											"pm.environment.set(\"escapedContent\", JSON.stringify(html).slice(1, -1));"
										],
										"type": "text/javascript",
										"packages": {}
									}
								},
								{
									"listen": "test",
									"script": {
										"exec": [
											"pm.test(\"Response returns 204\", function () {",
											"    pm.response.to.have.status(204);",
											"});"
										],
										"type": "text/javascript",
										"packages": {}
									}
								}
							],
							"request": {
								"auth": {
									"type": "bearer",
									"bearer": [
										{
											"key": "token",
											"value": "{{bob_token}}",
											"type": "string"
										}
									]
								},
								"method": "POST",
								"header": [],
								"body": {
									"mode": "raw",
									"raw": "",
									"options": {
										"raw": {
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "{{gateway}}/questions/{{questionId}}/answers/{{answerId}}/accept",
									"host": [
										"{{gateway}}"
									],
									"path": [
										"questions",
										"{{questionId}}",
										"answers",
										"{{answerId}}",
										"accept"
									]
								}
							},
							"response": []
						},
						{
							"name": "Get Me (Dave)",
							"event": [
								{
									"listen": "test",
									"script": {
										"exec": [
											"const user = pm.response.json();",
											"",
											"pm.test(\"Has properties\", function () {",
											"    pm.expect(user).to.have.property('id');",
											"});",
											"",
											"if (pm.test(\"Has properties\")) {",
											"    pm.globals.set('dave_id', user.id);",
											"}"
										],
										"type": "text/javascript",
										"packages": {}
									}
								}
							],
							"request": {
								"auth": {
									"type": "bearer",
									"bearer": [
										{
											"key": "token",
											"value": "{{dave_token}}",
											"type": "string"
										}
									]
								},
								"method": "GET",
								"header": [],
								"url": {
									"raw": "{{gateway}}/profiles/me",
									"host": [
										"{{gateway}}"
									],
									"path": [
										"profiles",
										"me"
									]
								}
							},
							"response": []
						}
					]
				},
				{
					"name": "Votes",
					"item": [
						{
							"name": "Post question as bob",
							"event": [
								{
									"listen": "prerequest",
									"script": {
										"exec": [
											"const raw = pm.variables.replaceIn(\"{{$randomLoremParagraphs}}\");",
											"",
											"// Split on newlines, wrap each line in <p> tags, then join",
											"const html = raw",
											"  .split('\\n')",
											"  .filter(p => p.trim().length > 0)",
											"  .map(p => `<p>${p}</p>`)",
											"  .join('');",
											"",
											"pm.environment.set(\"escapedContent\", JSON.stringify(html).slice(1, -1));",
											"",
											"const allTags = [\"aspire\", \"dotnet\", \"keycloak\", \"wolverine\", \"ef-core\", \"postgresql\", \"signalr\", \"microservices\", \"nextjs\", \"typescript\"];",
											"",
											"// Pick 1 or 2 tags at random",
											"const shuffled = allTags.sort(() => 0.5 - Math.random());",
											"const selectedTags = shuffled.slice(0, Math.floor(Math.random() * 2) + 1);",
											"",
											"// Set as environment variable for use in body",
											"pm.environment.set('selectedTags', JSON.stringify(selectedTags));"
										],
										"type": "text/javascript",
										"packages": {}
									}
								},
								{
									"listen": "test",
									"script": {
										"exec": [
											"const question = pm.response.json();",
											"",
											"pm.test(\"Has properties\", function () {",
											"    pm.expect(question).to.have.property('id');",
											"});",
											"",
											"if (pm.test(\"Has properties\")) {",
											"    pm.globals.set('questionId', question.id);",
											"}"
										],
										"type": "text/javascript",
										"packages": {}
									}
								}
							],
							"request": {
								"auth": {
									"type": "bearer",
									"bearer": [
										{
											"key": "token",
											"value": "{{bob_token}}",
											"type": "string"
										}
									]
								},
								"method": "POST",
								"header": [],
								"body": {
									"mode": "raw",
									"raw": "{\n    \"title\": \"{{$randomPhrase}}\",\n    \"content\": \"{{escapedContent}}\",\n    \"tags\": {{selectedTags}}\n}",
									"options": {
										"raw": {
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "{{gateway}}/questions",
									"host": [
										"{{gateway}}"
									],
									"path": [
										"questions"
									]
								}
							},
							"response": []
						},
						{
							"name": "Vote question up as dave",
							"request": {
								"auth": {
									"type": "bearer",
									"bearer": [
										{
											"key": "token",
											"value": "{{dave_token}}",
											"type": "string"
										}
									]
								},
								"method": "POST",
								"header": [],
								"body": {
									"mode": "raw",
									"raw": "{\n    \"targetId\": \"{{questionId}}\",\n    \"targetType\": \"Question\",\n    \"targetUserId\": \"{{bob_id}}\",\n    \"questionId\": \"{{questionId}}\",\n    \"voteValue\": 1\n}",
									"options": {
										"raw": {
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "{{gateway}}/votes",
									"host": [
										"{{gateway}}"
									],
									"path": [
										"votes"
									]
								}
							},
							"response": []
						},
						{
							"name": "Post answer as dave",
							"event": [
								{
									"listen": "prerequest",
									"script": {
										"exec": [
											"const raw = pm.variables.replaceIn(\"{{$randomLoremParagraphs}}\");",
											"",
											"// Split on newlines, wrap each line in <p> tags, then join",
											"const html = raw",
											"  .split('\\n')",
											"  .filter(p => p.trim().length > 0)",
											"  .map(p => `<p>${p}</p>`)",
											"  .join('');",
											"",
											"pm.environment.set(\"escapedContent\", JSON.stringify(html).slice(1, -1));"
										],
										"type": "text/javascript",
										"packages": {}
									}
								},
								{
									"listen": "test",
									"script": {
										"exec": [
											"const answer = pm.response.json();",
											"",
											"pm.test(\"Has properties\", function () {",
											"    pm.expect(answer).to.have.property('id');",
											"});",
											"",
											"if (pm.test(\"Has properties\")) {",
											"    pm.globals.set('answerId', answer.id);",
											"}"
										],
										"type": "text/javascript",
										"packages": {}
									}
								}
							],
							"request": {
								"auth": {
									"type": "bearer",
									"bearer": [
										{
											"key": "token",
											"value": "{{dave_token}}",
											"type": "string"
										}
									]
								},
								"method": "POST",
								"header": [],
								"body": {
									"mode": "raw",
									"raw": "{\n    \"content\": \"{{escapedContent}}\"\n}",
									"options": {
										"raw": {
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "{{gateway}}/questions/{{questionId}}/answers",
									"host": [
										"{{gateway}}"
									],
									"path": [
										"questions",
										"{{questionId}}",
										"answers"
									]
								}
							},
							"response": []
						},
						{
							"name": "Vote answer down as bob",
							"request": {
								"auth": {
									"type": "bearer",
									"bearer": [
										{
											"key": "token",
											"value": "{{bob_token}}",
											"type": "string"
										}
									]
								},
								"method": "POST",
								"header": [],
								"body": {
									"mode": "raw",
									"raw": "{\n    \"targetId\": \"{{answerId}}\",\n    \"targetType\": \"Answer\",\n    \"targetUserId\": \"{{dave_id}}\",\n    \"questionId\": \"{{questionId}}\",\n    \"voteValue\": -1\n}",
									"options": {
										"raw": {
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "{{gateway}}/votes",
									"host": [
										"{{gateway}}"
									],
									"path": [
										"votes"
									]
								}
							},
							"response": []
						},
						{
							"name": "Get question by id",
							"request": {
								"auth": {
									"type": "bearer",
									"bearer": [
										{
											"key": "token",
											"value": "{{dave_token}}",
											"type": "string"
										}
									]
								},
								"method": "GET",
								"header": [],
								"url": {
									"raw": "{{gateway}}/questions/{{questionId}}",
									"host": [
										"{{gateway}}"
									],
									"path": [
										"questions",
										"{{questionId}}"
									]
								}
							},
							"response": []
						},
						{
							"name": "Get votes for question (dave)",
							"request": {
								"auth": {
									"type": "bearer",
									"bearer": [
										{
											"key": "token",
											"value": "{{dave_token}}",
											"type": "string"
										}
									]
								},
								"method": "GET",
								"header": [],
								"url": {
									"raw": "{{gateway}}/votes/{{questionId}}",
									"host": [
										"{{gateway}}"
									],
									"path": [
										"votes",
										"{{questionId}}"
									]
								}
							},
							"response": []
						},
						{
							"name": "Get votes for question (bob)",
							"request": {
								"auth": {
									"type": "bearer",
									"bearer": [
										{
											"key": "token",
											"value": "{{bob_token}}",
											"type": "string"
										}
									]
								},
								"method": "GET",
								"header": [],
								"url": {
									"raw": "{{gateway}}/votes/{{questionId}}",
									"host": [
										"{{gateway}}"
									],
									"path": [
										"votes",
										"{{questionId}}"
									]
								}
							},
							"response": []
						},
						{
							"name": "Vote question down as dave",
							"request": {
								"auth": {
									"type": "bearer",
									"bearer": [
										{
											"key": "token",
											"value": "{{dave_token}}",
											"type": "string"
										}
									]
								},
								"method": "POST",
								"header": [],
								"body": {
									"mode": "raw",
									"raw": "{\n    \"targetId\": \"{{questionId}}\",\n    \"targetType\": \"question\",\n    \"targetUserId\": \"{{bob_id}}\",\n    \"questionId\": \"{{questionId}}\",\n    \"voteValue\": -1\n}",
									"options": {
										"raw": {
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "{{gateway}}/events/votes",
									"host": [
										"{{gateway}}"
									],
									"path": [
										"events",
										"votes"
									]
								}
							},
							"response": []
						}
					]
				},
				{
					"name": "Get top users",
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{bob_token}}",
									"type": "string"
								}
							]
						},
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{gateway}}/stats/top-users",
							"host": [
								"{{gateway}}"
							],
							"path": [
								"stats",
								"top-users"
							]
						}
					},
					"response": []
				}
			]
		},
		{
			"name": "Section 14 Finishing touches",
			"item": [
				{
					"name": "Get Questions With Pagination",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"const result = pm.response.json();",
									"const questions = result.items;",
									"",
									"pm.test(\"Response has at least 2 questions\", function () {",
									"    pm.expect(questions).to.be.an('array').with.length.of.at.least(2);",
									"});",
									"",
									"if (Array.isArray(questions) && questions.length >= 2) {",
									"    pm.globals.set('question1', questions[0].id);",
									"    pm.globals.set('question2', questions[1].id);",
									"}"
								],
								"type": "text/javascript",
								"packages": {}
							}
						}
					],
					"request": {
						"auth": {
							"type": "noauth"
						},
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{questionsApi}}/questions?page=2&pageSize=2",
							"host": [
								"{{questionsApi}}"
							],
							"path": [
								"questions"
							],
							"query": [
								{
									"key": "page",
									"value": "2"
								},
								{
									"key": "pageSize",
									"value": "2"
								}
							]
						}
					},
					"response": []
				},
				{
					"name": "Get Questions Newest first",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"const result = pm.response.json();",
									"const questions = result.items;",
									"",
									"pm.test(\"Response has at least 2 questions\", function () {",
									"    pm.expect(questions).to.be.an('array').with.length.of.at.least(2);",
									"});",
									"",
									"if (Array.isArray(questions) && questions.length >= 2) {",
									"    pm.globals.set('question1', questions[0].id);",
									"    pm.globals.set('question2', questions[1].id);",
									"}"
								],
								"type": "text/javascript",
								"packages": {}
							}
						}
					],
					"request": {
						"auth": {
							"type": "noauth"
						},
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{gateway}}/questions?sort=newest",
							"host": [
								"{{gateway}}"
							],
							"path": [
								"questions"
							],
							"query": [
								{
									"key": "sort",
									"value": "newest"
								}
							]
						}
					},
					"response": []
				},
				{
					"name": "Get Questions Active",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"const result = pm.response.json();",
									"const questions = result.items;",
									"",
									"pm.test(\"Response has at least 2 questions\", function () {",
									"    pm.expect(questions).to.be.an('array').with.length.of.at.least(2);",
									"});",
									"",
									"if (Array.isArray(questions) && questions.length >= 2) {",
									"    pm.globals.set('question1', questions[0].id);",
									"    pm.globals.set('question2', questions[1].id);",
									"}"
								],
								"type": "text/javascript",
								"packages": {}
							}
						}
					],
					"request": {
						"auth": {
							"type": "noauth"
						},
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{gateway}}/questions?sort=active",
							"host": [
								"{{gateway}}"
							],
							"path": [
								"questions"
							],
							"query": [
								{
									"key": "sort",
									"value": "active"
								}
							]
						}
					},
					"response": []
				},
				{
					"name": "Get Questions Unanswered",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"const result = pm.response.json();",
									"const questions = result.items;",
									"",
									"pm.test(\"Response has at least 2 questions\", function () {",
									"    pm.expect(questions).to.be.an('array').with.length.of.at.least(2);",
									"});",
									"",
									"if (Array.isArray(questions) && questions.length >= 2) {",
									"    pm.globals.set('question1', questions[0].id);",
									"    pm.globals.set('question2', questions[1].id);",
									"}"
								],
								"type": "text/javascript",
								"packages": {}
							}
						}
					],
					"request": {
						"auth": {
							"type": "noauth"
						},
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{gateway}}/questions?sort=unanswered",
							"host": [
								"{{gateway}}"
							],
							"path": [
								"questions"
							],
							"query": [
								{
									"key": "sort",
									"value": "unanswered"
								}
							]
						}
					},
					"response": []
				},
				{
					"name": "Login as bob",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"const user = pm.response.json();",
									"",
									"pm.test(\"Has properties\", function () {",
									"    pm.expect(user).to.have.property('access_token');",
									"});",
									"",
									"if (pm.test(\"Has properties\")) {",
									"    pm.globals.set('bob_token', user.access_token);",
									"}"
								],
								"type": "text/javascript",
								"packages": {}
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [],
						"body": {
							"mode": "urlencoded",
							"urlencoded": [
								{
									"key": "username",
									"value": "bob",
									"type": "text"
								},
								{
									"key": "password",
									"value": "Pa$$w0rd",
									"type": "text"
								},
								{
									"key": "client_id",
									"value": "postman",
									"type": "text"
								},
								{
									"key": "grant_type",
									"value": "password",
									"type": "text"
								},
								{
									"key": "client_secret",
									"value": "zWJYJbQJ2ygrDvDxFSdhs8MSroFlGZcs",
									"type": "text",
									"disabled": true
								}
							]
						},
						"url": {
							"raw": "{{identityApi}}/realms/overflow/protocol/openid-connect/token",
							"host": [
								"{{identityApi}}"
							],
							"path": [
								"realms",
								"overflow",
								"protocol",
								"openid-connect",
								"token"
							]
						}
					},
					"response": []
				},
				{
					"name": "Post question as Bob",
					"event": [
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									"const raw = pm.variables.replaceIn(\"{{$randomLoremParagraphs}}\");",
									"",
									"// Split on newlines, wrap each line in <p> tags, then join",
									"const html = raw",
									"  .split('\\n')",
									"  .filter(p => p.trim().length > 0)",
									"  .map(p => `<p>${p}</p>`)",
									"  .join('');",
									"",
									"pm.environment.set(\"escapedContent\", JSON.stringify(html).slice(1, -1));",
									"",
									"const allTags = [\"aspire\", \"dotnet\", \"keycloak\", \"wolverine\", \"ef-core\", \"postgresql\", \"signalr\", \"microservices\", \"nextjs\", \"typescript\"];",
									"",
									"// Pick 1 or 2 tags at random",
									"const shuffled = allTags.sort(() => 0.5 - Math.random());",
									"const selectedTags = shuffled.slice(0, Math.floor(Math.random() * 2) + 1);",
									"",
									"// Set as environment variable for use in body",
									"pm.environment.set('selectedTags', JSON.stringify(selectedTags));"
								],
								"type": "text/javascript",
								"packages": {}
							}
						},
						{
							"listen": "test",
							"script": {
								"exec": [
									"const question = pm.response.json();",
									"",
									"pm.test(\"Has properties\", function () {",
									"    pm.expect(question).to.have.property('id');",
									"});",
									"",
									"if (pm.test(\"Has properties\")) {",
									"    pm.globals.set('questionId', question.id);",
									"    pm.globals.set('questionTitle', question.title);",
									"}"
								],
								"type": "text/javascript",
								"packages": {}
							}
						}
					],
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{bob_token}}",
									"type": "string"
								}
							]
						},
						"method": "POST",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"title\": \"Squirrel\",\n    \"content\": \"{{escapedContent}}\",\n    \"tags\": {{selectedTags}}\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{questionsApi}}/questions",
							"host": [
								"{{questionsApi}}"
							],
							"path": [
								"questions"
							]
						}
					},
					"response": []
				}
			]
		},
		{
			"name": "Section 15 Deployment",
			"item": [
				{
					"name": "Populate DB",
					"item": [
						{
							"name": "Login as bob",
							"event": [
								{
									"listen": "test",
									"script": {
										"exec": [
											"const user = pm.response.json();",
											"",
											"pm.test(\"Has properties\", function () {",
											"    pm.expect(user).to.have.property('access_token');",
											"});",
											"",
											"if (pm.test(\"Has properties\")) {",
											"    pm.globals.set('bob_token', user.access_token);",
											"}"
										],
										"type": "text/javascript",
										"packages": {}
									}
								}
							],
							"request": {
								"method": "POST",
								"header": [],
								"body": {
									"mode": "urlencoded",
									"urlencoded": [
										{
											"key": "username",
											"value": "bob",
											"type": "text"
										},
										{
											"key": "password",
											"value": "Pa$$w0rd",
											"type": "text"
										},
										{
											"key": "client_id",
											"value": "postman",
											"type": "text"
										},
										{
											"key": "grant_type",
											"value": "password",
											"type": "text"
										},
										{
											"key": "client_secret",
											"value": "zWJYJbQJ2ygrDvDxFSdhs8MSroFlGZcs",
											"type": "text",
											"disabled": true
										}
									]
								},
								"url": {
									"raw": "{{identityApiProd}}/realms/overflow/protocol/openid-connect/token",
									"host": [
										"{{identityApiProd}}"
									],
									"path": [
										"realms",
										"overflow",
										"protocol",
										"openid-connect",
										"token"
									]
								}
							},
							"response": []
						},
						{
							"name": "Login as dave",
							"event": [
								{
									"listen": "test",
									"script": {
										"exec": [
											"const user = pm.response.json();",
											"",
											"pm.test(\"Has properties\", function () {",
											"    pm.expect(user).to.have.property('access_token');",
											"});",
											"",
											"if (pm.test(\"Has properties\")) {",
											"    pm.globals.set('dave_token', user.access_token);",
											"}"
										],
										"type": "text/javascript",
										"packages": {}
									}
								}
							],
							"request": {
								"method": "POST",
								"header": [],
								"body": {
									"mode": "urlencoded",
									"urlencoded": [
										{
											"key": "username",
											"value": "dave",
											"type": "text"
										},
										{
											"key": "password",
											"value": "Pa$$w0rd",
											"type": "text"
										},
										{
											"key": "client_id",
											"value": "postman",
											"type": "text"
										},
										{
											"key": "grant_type",
											"value": "password",
											"type": "text"
										},
										{
											"key": "client_secret",
											"value": "zWJYJbQJ2ygrDvDxFSdhs8MSroFlGZcs",
											"type": "text",
											"disabled": true
										}
									]
								},
								"url": {
									"raw": "{{identityApiProd}}/realms/overflow/protocol/openid-connect/token",
									"host": [
										"{{identityApiProd}}"
									],
									"path": [
										"realms",
										"overflow",
										"protocol",
										"openid-connect",
										"token"
									]
								}
							},
							"response": []
						},
						{
							"name": "Get Me (Bob)",
							"event": [
								{
									"listen": "test",
									"script": {
										"exec": [
											"const user = pm.response.json();",
											"",
											"pm.test(\"Has properties\", function () {",
											"    pm.expect(user).to.have.property('id');",
											"});",
											"",
											"if (pm.test(\"Has properties\")) {",
											"    pm.globals.set('bob_id', user.id);",
											"}"
										],
										"type": "text/javascript",
										"packages": {}
									}
								}
							],
							"request": {
								"auth": {
									"type": "bearer",
									"bearer": [
										{
											"key": "token",
											"value": "{{bob_token}}",
											"type": "string"
										}
									]
								},
								"method": "GET",
								"header": [],
								"url": {
									"raw": "{{gatewayProd}}/profiles/me",
									"host": [
										"{{gatewayProd}}"
									],
									"path": [
										"profiles",
										"me"
									]
								}
							},
							"response": []
						},
						{
							"name": "Get Me (dave)",
							"request": {
								"auth": {
									"type": "bearer",
									"bearer": [
										{
											"key": "token",
											"value": "{{dave_token}}",
											"type": "string"
										}
									]
								},
								"method": "GET",
								"header": [],
								"url": {
									"raw": "{{gatewayProd}}/profiles/me",
									"host": [
										"{{gatewayProd}}"
									],
									"path": [
										"profiles",
										"me"
									]
								}
							},
							"response": []
						},
						{
							"name": "Post question as Bob",
							"event": [
								{
									"listen": "prerequest",
									"script": {
										"exec": [
											"const raw = pm.variables.replaceIn(\"{{$randomLoremParagraphs}}\");",
											"",
											"// Split on newlines, wrap each line in <p> tags, then join",
											"const html = raw",
											"  .split('\\n')",
											"  .filter(p => p.trim().length > 0)",
											"  .map(p => `<p>${p}</p>`)",
											"  .join('');",
											"",
											"pm.environment.set(\"escapedContent\", JSON.stringify(html).slice(1, -1));",
											"",
											"const allTags = [\"aspire\", \"dotnet\", \"keycloak\", \"wolverine\", \"ef-core\", \"postgresql\", \"signalr\", \"microservices\", \"nextjs\", \"typescript\"];",
											"",
											"// Pick 1 or 2 tags at random",
											"const shuffled = allTags.sort(() => 0.5 - Math.random());",
											"const selectedTags = shuffled.slice(0, Math.floor(Math.random() * 2) + 1);",
											"",
											"// Set as environment variable for use in body",
											"pm.environment.set('selectedTags', JSON.stringify(selectedTags));"
										],
										"type": "text/javascript",
										"packages": {}
									}
								},
								{
									"listen": "test",
									"script": {
										"exec": [
											"const question = pm.response.json();",
											"",
											"pm.test(\"Has properties\", function () {",
											"    pm.expect(question).to.have.property('id');",
											"});",
											"",
											"if (pm.test(\"Has properties\")) {",
											"    pm.globals.set('questionId', question.id);",
											"    pm.globals.set('questionTitle', question.title);",
											"}"
										],
										"type": "text/javascript",
										"packages": {}
									}
								}
							],
							"request": {
								"auth": {
									"type": "bearer",
									"bearer": [
										{
											"key": "token",
											"value": "{{bob_token}}",
											"type": "string"
										}
									]
								},
								"method": "POST",
								"header": [],
								"body": {
									"mode": "raw",
									"raw": "{\n    \"title\": \"{{$randomPhrase}}\",\n    \"content\": \"{{escapedContent}}\",\n    \"tags\": {{selectedTags}}\n}",
									"options": {
										"raw": {
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "{{gatewayProd}}/questions",
									"host": [
										"{{gatewayProd}}"
									],
									"path": [
										"questions"
									]
								}
							},
							"response": []
						},
						{
							"name": "Post question as Bob",
							"event": [
								{
									"listen": "prerequest",
									"script": {
										"exec": [
											"const raw = pm.variables.replaceIn(\"{{$randomLoremParagraphs}}\");",
											"",
											"// Split on newlines, wrap each line in <p> tags, then join",
											"const html = raw",
											"  .split('\\n')",
											"  .filter(p => p.trim().length > 0)",
											"  .map(p => `<p>${p}</p>`)",
											"  .join('');",
											"",
											"pm.environment.set(\"escapedContent\", JSON.stringify(html).slice(1, -1));",
											"",
											"const allTags = [\"aspire\", \"dotnet\", \"keycloak\", \"wolverine\", \"ef-core\", \"postgresql\", \"signalr\", \"microservices\", \"nextjs\", \"typescript\"];",
											"",
											"// Pick 1 or 2 tags at random",
											"const shuffled = allTags.sort(() => 0.5 - Math.random());",
											"const selectedTags = shuffled.slice(0, Math.floor(Math.random() * 2) + 1);",
											"",
											"// Set as environment variable for use in body",
											"pm.environment.set('selectedTags', JSON.stringify(selectedTags));"
										],
										"type": "text/javascript",
										"packages": {}
									}
								},
								{
									"listen": "test",
									"script": {
										"exec": [
											"const question = pm.response.json();",
											"",
											"pm.test(\"Has properties\", function () {",
											"    pm.expect(question).to.have.property('id');",
											"});",
											"",
											"if (pm.test(\"Has properties\")) {",
											"    pm.globals.set('questionId', question.id);",
											"    pm.globals.set('questionTitle', question.title);",
											"}"
										],
										"type": "text/javascript",
										"packages": {}
									}
								}
							],
							"request": {
								"auth": {
									"type": "bearer",
									"bearer": [
										{
											"key": "token",
											"value": "{{bob_token}}",
											"type": "string"
										}
									]
								},
								"method": "POST",
								"header": [],
								"body": {
									"mode": "raw",
									"raw": "{\n    \"title\": \"{{$randomPhrase}}\",\n    \"content\": \"{{escapedContent}}\",\n    \"tags\": {{selectedTags}}\n}",
									"options": {
										"raw": {
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "{{gatewayProd}}/questions",
									"host": [
										"{{gatewayProd}}"
									],
									"path": [
										"questions"
									]
								}
							},
							"response": []
						},
						{
							"name": "Post answer as Dave",
							"event": [
								{
									"listen": "prerequest",
									"script": {
										"exec": [
											"const raw = pm.variables.replaceIn(\"{{$randomLoremParagraphs}}\");",
											"",
											"// Split on newlines, wrap each line in <p> tags, then join",
											"const html = raw",
											"  .split('\\n')",
											"  .filter(p => p.trim().length > 0)",
											"  .map(p => `<p>${p}</p>`)",
											"  .join('');",
											"",
											"pm.environment.set(\"escapedContent\", JSON.stringify(html).slice(1, -1));"
										],
										"type": "text/javascript",
										"packages": {}
									}
								},
								{
									"listen": "test",
									"script": {
										"exec": [
											"const answer = pm.response.json();",
											"",
											"pm.test(\"Has properties\", function () {",
											"    pm.expect(answer).to.have.property('id');",
											"});",
											"",
											"if (pm.test(\"Has properties\")) {",
											"    pm.globals.set('answerId', answer.id);",
											"}"
										],
										"type": "text/javascript",
										"packages": {}
									}
								}
							],
							"request": {
								"auth": {
									"type": "bearer",
									"bearer": [
										{
											"key": "token",
											"value": "{{dave_token}}",
											"type": "string"
										}
									]
								},
								"method": "POST",
								"header": [],
								"body": {
									"mode": "raw",
									"raw": "{\n    \"content\": \"{{escapedContent}}\",\n    \"questionId\": \"{{questionId}}\"\n}",
									"options": {
										"raw": {
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "{{gatewayProd}}/questions/{{questionId}}/answers",
									"host": [
										"{{gatewayProd}}"
									],
									"path": [
										"questions",
										"{{questionId}}",
										"answers"
									]
								}
							},
							"response": []
						},
						{
							"name": "Post question as Dave",
							"event": [
								{
									"listen": "prerequest",
									"script": {
										"exec": [
											"const raw = pm.variables.replaceIn(\"{{$randomLoremParagraphs}}\");",
											"",
											"// Split on newlines, wrap each line in <p> tags, then join",
											"const html = raw",
											"  .split('\\n')",
											"  .filter(p => p.trim().length > 0)",
											"  .map(p => `<p>${p}</p>`)",
											"  .join('');",
											"",
											"pm.environment.set(\"escapedContent\", JSON.stringify(html).slice(1, -1));",
											"",
											"const allTags = [\"aspire\", \"dotnet\", \"keycloak\", \"wolverine\", \"ef-core\", \"postgresql\", \"signalr\", \"microservices\", \"nextjs\", \"typescript\"];",
											"",
											"// Pick 1 or 2 tags at random",
											"const shuffled = allTags.sort(() => 0.5 - Math.random());",
											"const selectedTags = shuffled.slice(0, Math.floor(Math.random() * 2) + 1);",
											"",
											"// Set as environment variable for use in body",
											"pm.environment.set('selectedTags', JSON.stringify(selectedTags));"
										],
										"type": "text/javascript",
										"packages": {}
									}
								},
								{
									"listen": "test",
									"script": {
										"exec": [
											"const question = pm.response.json();",
											"",
											"pm.test(\"Has properties\", function () {",
											"    pm.expect(question).to.have.property('id');",
											"});",
											"",
											"if (pm.test(\"Has properties\")) {",
											"    pm.globals.set('questionId', question.id);",
											"    pm.globals.set('questionTitle', question.title);",
											"}"
										],
										"type": "text/javascript",
										"packages": {}
									}
								}
							],
							"request": {
								"auth": {
									"type": "bearer",
									"bearer": [
										{
											"key": "token",
											"value": "{{dave_token}}",
											"type": "string"
										}
									]
								},
								"method": "POST",
								"header": [],
								"body": {
									"mode": "raw",
									"raw": "{\n    \"title\": \"{{$randomPhrase}}\",\n    \"content\": \"{{escapedContent}}\",\n    \"tags\": {{selectedTags}}\n}",
									"options": {
										"raw": {
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "{{gatewayProd}}/questions",
									"host": [
										"{{gatewayProd}}"
									],
									"path": [
										"questions"
									]
								}
							},
							"response": []
						},
						{
							"name": "Post question as Dave",
							"event": [
								{
									"listen": "prerequest",
									"script": {
										"exec": [
											"const raw = pm.variables.replaceIn(\"{{$randomLoremParagraphs}}\");",
											"",
											"// Split on newlines, wrap each line in <p> tags, then join",
											"const html = raw",
											"  .split('\\n')",
											"  .filter(p => p.trim().length > 0)",
											"  .map(p => `<p>${p}</p>`)",
											"  .join('');",
											"",
											"pm.environment.set(\"escapedContent\", JSON.stringify(html).slice(1, -1));",
											"",
											"const allTags = [\"aspire\", \"dotnet\", \"keycloak\", \"wolverine\", \"ef-core\", \"postgresql\", \"signalr\", \"microservices\", \"nextjs\", \"typescript\"];",
											"",
											"// Pick 1 or 2 tags at random",
											"const shuffled = allTags.sort(() => 0.5 - Math.random());",
											"const selectedTags = shuffled.slice(0, Math.floor(Math.random() * 2) + 1);",
											"",
											"// Set as environment variable for use in body",
											"pm.environment.set('selectedTags', JSON.stringify(selectedTags));"
										],
										"type": "text/javascript",
										"packages": {}
									}
								},
								{
									"listen": "test",
									"script": {
										"exec": [
											"const question = pm.response.json();",
											"",
											"pm.test(\"Has properties\", function () {",
											"    pm.expect(question).to.have.property('id');",
											"});",
											"",
											"if (pm.test(\"Has properties\")) {",
											"    pm.globals.set('questionId', question.id);",
											"    pm.globals.set('questionTitle', question.title);",
											"}"
										],
										"type": "text/javascript",
										"packages": {}
									}
								}
							],
							"request": {
								"auth": {
									"type": "bearer",
									"bearer": [
										{
											"key": "token",
											"value": "{{dave_token}}",
											"type": "string"
										}
									]
								},
								"method": "POST",
								"header": [],
								"body": {
									"mode": "raw",
									"raw": "{\n    \"title\": \"{{$randomPhrase}}\",\n    \"content\": \"{{escapedContent}}\",\n    \"tags\": {{selectedTags}}\n}",
									"options": {
										"raw": {
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "{{gatewayProd}}/questions",
									"host": [
										"{{gatewayProd}}"
									],
									"path": [
										"questions"
									]
								}
							},
							"response": []
						},
						{
							"name": "Post question as Dave",
							"event": [
								{
									"listen": "prerequest",
									"script": {
										"exec": [
											"const raw = pm.variables.replaceIn(\"{{$randomLoremParagraphs}}\");",
											"",
											"// Split on newlines, wrap each line in <p> tags, then join",
											"const html = raw",
											"  .split('\\n')",
											"  .filter(p => p.trim().length > 0)",
											"  .map(p => `<p>${p}</p>`)",
											"  .join('');",
											"",
											"pm.environment.set(\"escapedContent\", JSON.stringify(html).slice(1, -1));",
											"",
											"const allTags = [\"aspire\", \"dotnet\", \"keycloak\", \"wolverine\", \"ef-core\", \"postgresql\", \"signalr\", \"microservices\", \"nextjs\", \"typescript\"];",
											"",
											"// Pick 1 or 2 tags at random",
											"const shuffled = allTags.sort(() => 0.5 - Math.random());",
											"const selectedTags = shuffled.slice(0, Math.floor(Math.random() * 2) + 1);",
											"",
											"// Set as environment variable for use in body",
											"pm.environment.set('selectedTags', JSON.stringify(selectedTags));"
										],
										"type": "text/javascript",
										"packages": {}
									}
								},
								{
									"listen": "test",
									"script": {
										"exec": [
											"const question = pm.response.json();",
											"",
											"pm.test(\"Has properties\", function () {",
											"    pm.expect(question).to.have.property('id');",
											"});",
											"",
											"if (pm.test(\"Has properties\")) {",
											"    pm.globals.set('questionId', question.id);",
											"    pm.globals.set('questionTitle', question.title);",
											"}"
										],
										"type": "text/javascript",
										"packages": {}
									}
								}
							],
							"request": {
								"auth": {
									"type": "bearer",
									"bearer": [
										{
											"key": "token",
											"value": "{{dave_token}}",
											"type": "string"
										}
									]
								},
								"method": "POST",
								"header": [],
								"body": {
									"mode": "raw",
									"raw": "{\n    \"title\": \"{{$randomPhrase}}\",\n    \"content\": \"{{escapedContent}}\",\n    \"tags\": {{selectedTags}}\n}",
									"options": {
										"raw": {
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "{{gatewayProd}}/questions",
									"host": [
										"{{gatewayProd}}"
									],
									"path": [
										"questions"
									]
								}
							},
							"response": []
						},
						{
							"name": "Post answer as Bob",
							"event": [
								{
									"listen": "prerequest",
									"script": {
										"exec": [
											"const raw = pm.variables.replaceIn(\"{{$randomLoremParagraphs}}\");",
											"",
											"// Split on newlines, wrap each line in <p> tags, then join",
											"const html = raw",
											"  .split('\\n')",
											"  .filter(p => p.trim().length > 0)",
											"  .map(p => `<p>${p}</p>`)",
											"  .join('');",
											"",
											"pm.environment.set(\"escapedContent\", JSON.stringify(html).slice(1, -1));"
										],
										"type": "text/javascript",
										"packages": {}
									}
								},
								{
									"listen": "test",
									"script": {
										"exec": [
											"const answer = pm.response.json();",
											"",
											"pm.test(\"Has properties\", function () {",
											"    pm.expect(answer).to.have.property('id');",
											"});",
											"",
											"if (pm.test(\"Has properties\")) {",
											"    pm.globals.set('answerId', answer.id);",
											"}"
										],
										"type": "text/javascript",
										"packages": {}
									}
								}
							],
							"request": {
								"auth": {
									"type": "bearer",
									"bearer": [
										{
											"key": "token",
											"value": "{{bob_token}}",
											"type": "string"
										}
									]
								},
								"method": "POST",
								"header": [],
								"body": {
									"mode": "raw",
									"raw": "{\n    \"content\": \"{{escapedContent}}\",\n    \"questionId\": \"{{questionId}}\"\n}",
									"options": {
										"raw": {
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "{{gatewayProd}}/questions/{{questionId}}/answers",
									"host": [
										"{{gatewayProd}}"
									],
									"path": [
										"questions",
										"{{questionId}}",
										"answers"
									]
								}
							},
							"response": []
						},
						{
							"name": "Post answer as Bob",
							"event": [
								{
									"listen": "prerequest",
									"script": {
										"exec": [
											"const raw = pm.variables.replaceIn(\"{{$randomLoremParagraphs}}\");",
											"",
											"// Split on newlines, wrap each line in <p> tags, then join",
											"const html = raw",
											"  .split('\\n')",
											"  .filter(p => p.trim().length > 0)",
											"  .map(p => `<p>${p}</p>`)",
											"  .join('');",
											"",
											"pm.environment.set(\"escapedContent\", JSON.stringify(html).slice(1, -1));"
										],
										"type": "text/javascript",
										"packages": {}
									}
								},
								{
									"listen": "test",
									"script": {
										"exec": [
											"const answer = pm.response.json();",
											"",
											"pm.test(\"Has properties\", function () {",
											"    pm.expect(answer).to.have.property('id');",
											"});",
											"",
											"if (pm.test(\"Has properties\")) {",
											"    pm.globals.set('answerId', answer.id);",
											"}"
										],
										"type": "text/javascript",
										"packages": {}
									}
								}
							],
							"request": {
								"auth": {
									"type": "bearer",
									"bearer": [
										{
											"key": "token",
											"value": "{{bob_token}}",
											"type": "string"
										}
									]
								},
								"method": "POST",
								"header": [],
								"body": {
									"mode": "raw",
									"raw": "{\n    \"content\": \"{{escapedContent}}\",\n    \"questionId\": \"{{questionId}}\"\n}",
									"options": {
										"raw": {
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "{{gatewayProd}}/questions/{{questionId}}/answers",
									"host": [
										"{{gatewayProd}}"
									],
									"path": [
										"questions",
										"{{questionId}}",
										"answers"
									]
								}
							},
							"response": []
						},
						{
							"name": "Accept answer for question",
							"event": [
								{
									"listen": "prerequest",
									"script": {
										"exec": [
											"const raw = pm.variables.replaceIn(\"{{$randomLoremParagraphs}}\");",
											"",
											"// Split on newlines, wrap each line in <p> tags, then join",
											"const html = raw",
											"  .split('\\n')",
											"  .filter(p => p.trim().length > 0)",
											"  .map(p => `<p>${p}</p>`)",
											"  .join('');",
											"",
											"pm.environment.set(\"escapedContent\", JSON.stringify(html).slice(1, -1));"
										],
										"type": "text/javascript",
										"packages": {}
									}
								},
								{
									"listen": "test",
									"script": {
										"exec": [
											"pm.test(\"Response returns 204\", function () {",
											"    pm.response.to.have.status(204);",
											"});"
										],
										"type": "text/javascript",
										"packages": {}
									}
								}
							],
							"request": {
								"auth": {
									"type": "bearer",
									"bearer": [
										{
											"key": "token",
											"value": "{{dave_token}}",
											"type": "string"
										}
									]
								},
								"method": "POST",
								"header": [],
								"body": {
									"mode": "raw",
									"raw": "",
									"options": {
										"raw": {
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "{{gatewayProd}}/questions/{{questionId}}/answers/{{answerId}}/accept",
									"host": [
										"{{gatewayProd}}"
									],
									"path": [
										"questions",
										"{{questionId}}",
										"answers",
										"{{answerId}}",
										"accept"
									]
								}
							},
							"response": []
						},
						{
							"name": "Post answer as Bob",
							"event": [
								{
									"listen": "prerequest",
									"script": {
										"exec": [
											"const raw = pm.variables.replaceIn(\"{{$randomLoremParagraphs}}\");",
											"",
											"// Split on newlines, wrap each line in <p> tags, then join",
											"const html = raw",
											"  .split('\\n')",
											"  .filter(p => p.trim().length > 0)",
											"  .map(p => `<p>${p}</p>`)",
											"  .join('');",
											"",
											"pm.environment.set(\"escapedContent\", JSON.stringify(html).slice(1, -1));"
										],
										"type": "text/javascript",
										"packages": {}
									}
								},
								{
									"listen": "test",
									"script": {
										"exec": [
											"const answer = pm.response.json();",
											"",
											"pm.test(\"Has properties\", function () {",
											"    pm.expect(answer).to.have.property('id');",
											"});",
											"",
											"if (pm.test(\"Has properties\")) {",
											"    pm.globals.set('answerId', answer.id);",
											"}"
										],
										"type": "text/javascript",
										"packages": {}
									}
								}
							],
							"request": {
								"auth": {
									"type": "bearer",
									"bearer": [
										{
											"key": "token",
											"value": "{{bob_token}}",
											"type": "string"
										}
									]
								},
								"method": "POST",
								"header": [],
								"body": {
									"mode": "raw",
									"raw": "{\n    \"content\": \"{{escapedContent}}\",\n    \"questionId\": \"{{questionId}}\"\n}",
									"options": {
										"raw": {
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "{{gatewayProd}}/questions/{{questionId}}/answers",
									"host": [
										"{{gatewayProd}}"
									],
									"path": [
										"questions",
										"{{questionId}}",
										"answers"
									]
								}
							},
							"response": []
						},
						{
							"name": "Post answer as Bob",
							"event": [
								{
									"listen": "prerequest",
									"script": {
										"exec": [
											"const raw = pm.variables.replaceIn(\"{{$randomLoremParagraphs}}\");",
											"",
											"// Split on newlines, wrap each line in <p> tags, then join",
											"const html = raw",
											"  .split('\\n')",
											"  .filter(p => p.trim().length > 0)",
											"  .map(p => `<p>${p}</p>`)",
											"  .join('');",
											"",
											"pm.environment.set(\"escapedContent\", JSON.stringify(html).slice(1, -1));"
										],
										"type": "text/javascript",
										"packages": {}
									}
								},
								{
									"listen": "test",
									"script": {
										"exec": [
											"const answer = pm.response.json();",
											"",
											"pm.test(\"Has properties\", function () {",
											"    pm.expect(answer).to.have.property('id');",
											"});",
											"",
											"if (pm.test(\"Has properties\")) {",
											"    pm.globals.set('answerId', answer.id);",
											"}"
										],
										"type": "text/javascript",
										"packages": {}
									}
								}
							],
							"request": {
								"auth": {
									"type": "bearer",
									"bearer": [
										{
											"key": "token",
											"value": "{{bob_token}}",
											"type": "string"
										}
									]
								},
								"method": "POST",
								"header": [],
								"body": {
									"mode": "raw",
									"raw": "{\n    \"content\": \"{{escapedContent}}\",\n    \"questionId\": \"{{questionId}}\"\n}",
									"options": {
										"raw": {
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "{{gatewayProd}}/questions/{{questionId}}/answers",
									"host": [
										"{{gatewayProd}}"
									],
									"path": [
										"questions",
										"{{questionId}}",
										"answers"
									]
								}
							},
							"response": []
						}
					]
				},
				{
					"name": "Setup Prod",
					"item": [
						{
							"name": "Login as dave",
							"event": [
								{
									"listen": "test",
									"script": {
										"exec": [
											"const user = pm.response.json();",
											"",
											"pm.test(\"Has properties\", function () {",
											"    pm.expect(user).to.have.property('access_token');",
											"});",
											"",
											"if (pm.test(\"Has properties\")) {",
											"    pm.globals.set('dave_token', user.access_token);",
											"}"
										],
										"type": "text/javascript",
										"packages": {}
									}
								}
							],
							"request": {
								"method": "POST",
								"header": [],
								"body": {
									"mode": "urlencoded",
									"urlencoded": [
										{
											"key": "username",
											"value": "dave",
											"type": "text"
										},
										{
											"key": "password",
											"value": "Pa$$w0rd",
											"type": "text"
										},
										{
											"key": "client_id",
											"value": "postman",
											"type": "text"
										},
										{
											"key": "grant_type",
											"value": "password",
											"type": "text"
										},
										{
											"key": "client_secret",
											"value": "zWJYJbQJ2ygrDvDxFSdhs8MSroFlGZcs",
											"type": "text",
											"disabled": true
										}
									]
								},
								"url": {
									"raw": "{{identityApiProd}}/realms/overflow/protocol/openid-connect/token",
									"host": [
										"{{identityApiProd}}"
									],
									"path": [
										"realms",
										"overflow",
										"protocol",
										"openid-connect",
										"token"
									]
								}
							},
							"response": []
						},
						{
							"name": "Login as bob",
							"event": [
								{
									"listen": "test",
									"script": {
										"exec": [
											"const user = pm.response.json();",
											"",
											"pm.test(\"Has properties\", function () {",
											"    pm.expect(user).to.have.property('access_token');",
											"});",
											"",
											"if (pm.test(\"Has properties\")) {",
											"    pm.globals.set('bob_token', user.access_token);",
											"}"
										],
										"type": "text/javascript",
										"packages": {}
									}
								}
							],
							"request": {
								"method": "POST",
								"header": [],
								"body": {
									"mode": "urlencoded",
									"urlencoded": [
										{
											"key": "username",
											"value": "bob",
											"type": "text"
										},
										{
											"key": "password",
											"value": "Pa$$w0rd",
											"type": "text"
										},
										{
											"key": "client_id",
											"value": "postman",
											"type": "text"
										},
										{
											"key": "grant_type",
											"value": "password",
											"type": "text"
										},
										{
											"key": "client_secret",
											"value": "zWJYJbQJ2ygrDvDxFSdhs8MSroFlGZcs",
											"type": "text",
											"disabled": true
										}
									]
								},
								"url": {
									"raw": "{{identityApiProd}}/realms/overflow/protocol/openid-connect/token",
									"host": [
										"{{identityApiProd}}"
									],
									"path": [
										"realms",
										"overflow",
										"protocol",
										"openid-connect",
										"token"
									]
								}
							},
							"response": []
						},
						{
							"name": "Get Me (Bob)",
							"event": [
								{
									"listen": "test",
									"script": {
										"exec": [
											"const user = pm.response.json();",
											"",
											"pm.test(\"Has properties\", function () {",
											"    pm.expect(user).to.have.property('id');",
											"});",
											"",
											"if (pm.test(\"Has properties\")) {",
											"    pm.globals.set('bob_id', user.id);",
											"}"
										],
										"type": "text/javascript",
										"packages": {}
									}
								}
							],
							"request": {
								"auth": {
									"type": "bearer",
									"bearer": [
										{
											"key": "token",
											"value": "{{bob_token}}",
											"type": "string"
										}
									]
								},
								"method": "GET",
								"header": [],
								"url": {
									"raw": "{{gatewayProd}}/profiles/me",
									"host": [
										"{{gatewayProd}}"
									],
									"path": [
										"profiles",
										"me"
									]
								}
							},
							"response": []
						},
						{
							"name": "Get Me (dave)",
							"request": {
								"auth": {
									"type": "bearer",
									"bearer": [
										{
											"key": "token",
											"value": "{{dave_token}}",
											"type": "string"
										}
									]
								},
								"method": "GET",
								"header": [],
								"url": {
									"raw": "{{gatewayProd}}/profiles/me",
									"host": [
										"{{gatewayProd}}"
									],
									"path": [
										"profiles",
										"me"
									]
								}
							},
							"response": []
						}
					]
				},
				{
					"name": "Populate Digital Ocean DB",
					"item": [
						{
							"name": "Login as bob",
							"event": [
								{
									"listen": "test",
									"script": {
										"exec": [
											"const user = pm.response.json();",
											"",
											"pm.test(\"Has properties\", function () {",
											"    pm.expect(user).to.have.property('access_token');",
											"});",
											"",
											"if (pm.test(\"Has properties\")) {",
											"    pm.globals.set('bob_token', user.access_token);",
											"}"
										],
										"type": "text/javascript",
										"packages": {}
									}
								}
							],
							"request": {
								"method": "POST",
								"header": [],
								"body": {
									"mode": "urlencoded",
									"urlencoded": [
										{
											"key": "username",
											"value": "bob",
											"type": "text"
										},
										{
											"key": "password",
											"value": "Pa$$w0rd",
											"type": "text"
										},
										{
											"key": "client_id",
											"value": "postman",
											"type": "text"
										},
										{
											"key": "grant_type",
											"value": "password",
											"type": "text"
										},
										{
											"key": "client_secret",
											"value": "zWJYJbQJ2ygrDvDxFSdhs8MSroFlGZcs",
											"type": "text",
											"disabled": true
										}
									]
								},
								"url": {
									"raw": "{{identityDO}}/realms/overflow/protocol/openid-connect/token",
									"host": [
										"{{identityDO}}"
									],
									"path": [
										"realms",
										"overflow",
										"protocol",
										"openid-connect",
										"token"
									]
								}
							},
							"response": []
						},
						{
							"name": "Login as dave",
							"event": [
								{
									"listen": "test",
									"script": {
										"exec": [
											"const user = pm.response.json();",
											"",
											"pm.test(\"Has properties\", function () {",
											"    pm.expect(user).to.have.property('access_token');",
											"});",
											"",
											"if (pm.test(\"Has properties\")) {",
											"    pm.globals.set('dave_token', user.access_token);",
											"}"
										],
										"type": "text/javascript",
										"packages": {}
									}
								}
							],
							"request": {
								"method": "POST",
								"header": [],
								"body": {
									"mode": "urlencoded",
									"urlencoded": [
										{
											"key": "username",
											"value": "dave",
											"type": "text"
										},
										{
											"key": "password",
											"value": "Pa$$w0rd",
											"type": "text"
										},
										{
											"key": "client_id",
											"value": "postman",
											"type": "text"
										},
										{
											"key": "grant_type",
											"value": "password",
											"type": "text"
										},
										{
											"key": "client_secret",
											"value": "zWJYJbQJ2ygrDvDxFSdhs8MSroFlGZcs",
											"type": "text",
											"disabled": true
										}
									]
								},
								"url": {
									"raw": "{{identityDO}}/realms/overflow/protocol/openid-connect/token",
									"host": [
										"{{identityDO}}"
									],
									"path": [
										"realms",
										"overflow",
										"protocol",
										"openid-connect",
										"token"
									]
								}
							},
							"response": []
						},
						{
							"name": "Get Me (Bob)",
							"event": [
								{
									"listen": "test",
									"script": {
										"exec": [
											"const user = pm.response.json();",
											"",
											"pm.test(\"Has properties\", function () {",
											"    pm.expect(user).to.have.property('id');",
											"});",
											"",
											"if (pm.test(\"Has properties\")) {",
											"    pm.globals.set('bob_id', user.id);",
											"}"
										],
										"type": "text/javascript",
										"packages": {}
									}
								}
							],
							"request": {
								"auth": {
									"type": "bearer",
									"bearer": [
										{
											"key": "token",
											"value": "{{bob_token}}",
											"type": "string"
										}
									]
								},
								"method": "GET",
								"header": [],
								"url": {
									"raw": "{{gatewayDO}}/profiles/me",
									"host": [
										"{{gatewayDO}}"
									],
									"path": [
										"profiles",
										"me"
									]
								}
							},
							"response": []
						},
						{
							"name": "Get Me (dave)",
							"request": {
								"auth": {
									"type": "bearer",
									"bearer": [
										{
											"key": "token",
											"value": "{{dave_token}}",
											"type": "string"
										}
									]
								},
								"method": "GET",
								"header": [],
								"url": {
									"raw": "{{gatewayDO}}/profiles/me",
									"host": [
										"{{gatewayDO}}"
									],
									"path": [
										"profiles",
										"me"
									]
								}
							},
							"response": []
						},
						{
							"name": "Post question as Bob",
							"event": [
								{
									"listen": "prerequest",
									"script": {
										"exec": [
											"const raw = pm.variables.replaceIn(\"{{$randomLoremParagraphs}}\");",
											"",
											"// Split on newlines, wrap each line in <p> tags, then join",
											"const html = raw",
											"  .split('\\n')",
											"  .filter(p => p.trim().length > 0)",
											"  .map(p => `<p>${p}</p>`)",
											"  .join('');",
											"",
											"pm.environment.set(\"escapedContent\", JSON.stringify(html).slice(1, -1));",
											"",
											"const allTags = [\"aspire\", \"dotnet\", \"keycloak\", \"wolverine\", \"ef-core\", \"postgresql\", \"signalr\", \"microservices\", \"nextjs\", \"typescript\"];",
											"",
											"// Pick 1 or 2 tags at random",
											"const shuffled = allTags.sort(() => 0.5 - Math.random());",
											"const selectedTags = shuffled.slice(0, Math.floor(Math.random() * 2) + 1);",
											"",
											"// Set as environment variable for use in body",
											"pm.environment.set('selectedTags', JSON.stringify(selectedTags));"
										],
										"type": "text/javascript",
										"packages": {}
									}
								},
								{
									"listen": "test",
									"script": {
										"exec": [
											"const question = pm.response.json();",
											"",
											"pm.test(\"Has properties\", function () {",
											"    pm.expect(question).to.have.property('id');",
											"});",
											"",
											"if (pm.test(\"Has properties\")) {",
											"    pm.globals.set('questionId', question.id);",
											"    pm.globals.set('questionTitle', question.title);",
											"}"
										],
										"type": "text/javascript",
										"packages": {}
									}
								}
							],
							"request": {
								"auth": {
									"type": "bearer",
									"bearer": [
										{
											"key": "token",
											"value": "{{bob_token}}",
											"type": "string"
										}
									]
								},
								"method": "POST",
								"header": [],
								"body": {
									"mode": "raw",
									"raw": "{\n    \"title\": \"{{$randomPhrase}}\",\n    \"content\": \"{{escapedContent}}\",\n    \"tags\": {{selectedTags}}\n}",
									"options": {
										"raw": {
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "{{gatewayDO}}/questions",
									"host": [
										"{{gatewayDO}}"
									],
									"path": [
										"questions"
									]
								}
							},
							"response": []
						},
						{
							"name": "Post question as Bob",
							"event": [
								{
									"listen": "prerequest",
									"script": {
										"exec": [
											"const raw = pm.variables.replaceIn(\"{{$randomLoremParagraphs}}\");",
											"",
											"// Split on newlines, wrap each line in <p> tags, then join",
											"const html = raw",
											"  .split('\\n')",
											"  .filter(p => p.trim().length > 0)",
											"  .map(p => `<p>${p}</p>`)",
											"  .join('');",
											"",
											"pm.environment.set(\"escapedContent\", JSON.stringify(html).slice(1, -1));",
											"",
											"const allTags = [\"aspire\", \"dotnet\", \"keycloak\", \"wolverine\", \"ef-core\", \"postgresql\", \"signalr\", \"microservices\", \"nextjs\", \"typescript\"];",
											"",
											"// Pick 1 or 2 tags at random",
											"const shuffled = allTags.sort(() => 0.5 - Math.random());",
											"const selectedTags = shuffled.slice(0, Math.floor(Math.random() * 2) + 1);",
											"",
											"// Set as environment variable for use in body",
											"pm.environment.set('selectedTags', JSON.stringify(selectedTags));"
										],
										"type": "text/javascript",
										"packages": {}
									}
								},
								{
									"listen": "test",
									"script": {
										"exec": [
											"const question = pm.response.json();",
											"",
											"pm.test(\"Has properties\", function () {",
											"    pm.expect(question).to.have.property('id');",
											"});",
											"",
											"if (pm.test(\"Has properties\")) {",
											"    pm.globals.set('questionId', question.id);",
											"    pm.globals.set('questionTitle', question.title);",
											"}"
										],
										"type": "text/javascript",
										"packages": {}
									}
								}
							],
							"request": {
								"auth": {
									"type": "bearer",
									"bearer": [
										{
											"key": "token",
											"value": "{{bob_token}}",
											"type": "string"
										}
									]
								},
								"method": "POST",
								"header": [],
								"body": {
									"mode": "raw",
									"raw": "{\n    \"title\": \"{{$randomPhrase}}\",\n    \"content\": \"{{escapedContent}}\",\n    \"tags\": {{selectedTags}}\n}",
									"options": {
										"raw": {
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "{{gatewayDO}}/questions",
									"host": [
										"{{gatewayDO}}"
									],
									"path": [
										"questions"
									]
								}
							},
							"response": []
						},
						{
							"name": "Post answer as Dave",
							"event": [
								{
									"listen": "prerequest",
									"script": {
										"exec": [
											"const raw = pm.variables.replaceIn(\"{{$randomLoremParagraphs}}\");",
											"",
											"// Split on newlines, wrap each line in <p> tags, then join",
											"const html = raw",
											"  .split('\\n')",
											"  .filter(p => p.trim().length > 0)",
											"  .map(p => `<p>${p}</p>`)",
											"  .join('');",
											"",
											"pm.environment.set(\"escapedContent\", JSON.stringify(html).slice(1, -1));"
										],
										"type": "text/javascript",
										"packages": {}
									}
								},
								{
									"listen": "test",
									"script": {
										"exec": [
											"const answer = pm.response.json();",
											"",
											"pm.test(\"Has properties\", function () {",
											"    pm.expect(answer).to.have.property('id');",
											"});",
											"",
											"if (pm.test(\"Has properties\")) {",
											"    pm.globals.set('answerId', answer.id);",
											"}"
										],
										"type": "text/javascript",
										"packages": {}
									}
								}
							],
							"request": {
								"auth": {
									"type": "bearer",
									"bearer": [
										{
											"key": "token",
											"value": "{{dave_token}}",
											"type": "string"
										}
									]
								},
								"method": "POST",
								"header": [],
								"body": {
									"mode": "raw",
									"raw": "{\n    \"content\": \"{{escapedContent}}\",\n    \"questionId\": \"{{questionId}}\"\n}",
									"options": {
										"raw": {
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "{{gatewayDO}}/questions/{{questionId}}/answers",
									"host": [
										"{{gatewayDO}}"
									],
									"path": [
										"questions",
										"{{questionId}}",
										"answers"
									]
								}
							},
							"response": []
						},
						{
							"name": "Post question as Dave",
							"event": [
								{
									"listen": "prerequest",
									"script": {
										"exec": [
											"const raw = pm.variables.replaceIn(\"{{$randomLoremParagraphs}}\");",
											"",
											"// Split on newlines, wrap each line in <p> tags, then join",
											"const html = raw",
											"  .split('\\n')",
											"  .filter(p => p.trim().length > 0)",
											"  .map(p => `<p>${p}</p>`)",
											"  .join('');",
											"",
											"pm.environment.set(\"escapedContent\", JSON.stringify(html).slice(1, -1));",
											"",
											"const allTags = [\"aspire\", \"dotnet\", \"keycloak\", \"wolverine\", \"ef-core\", \"postgresql\", \"signalr\", \"microservices\", \"nextjs\", \"typescript\"];",
											"",
											"// Pick 1 or 2 tags at random",
											"const shuffled = allTags.sort(() => 0.5 - Math.random());",
											"const selectedTags = shuffled.slice(0, Math.floor(Math.random() * 2) + 1);",
											"",
											"// Set as environment variable for use in body",
											"pm.environment.set('selectedTags', JSON.stringify(selectedTags));"
										],
										"type": "text/javascript",
										"packages": {}
									}
								},
								{
									"listen": "test",
									"script": {
										"exec": [
											"const question = pm.response.json();",
											"",
											"pm.test(\"Has properties\", function () {",
											"    pm.expect(question).to.have.property('id');",
											"});",
											"",
											"if (pm.test(\"Has properties\")) {",
											"    pm.globals.set('questionId', question.id);",
											"    pm.globals.set('questionTitle', question.title);",
											"}"
										],
										"type": "text/javascript",
										"packages": {}
									}
								}
							],
							"request": {
								"auth": {
									"type": "bearer",
									"bearer": [
										{
											"key": "token",
											"value": "{{dave_token}}",
											"type": "string"
										}
									]
								},
								"method": "POST",
								"header": [],
								"body": {
									"mode": "raw",
									"raw": "{\n    \"title\": \"{{$randomPhrase}}\",\n    \"content\": \"{{escapedContent}}\",\n    \"tags\": {{selectedTags}}\n}",
									"options": {
										"raw": {
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "{{gatewayDO}}/questions",
									"host": [
										"{{gatewayDO}}"
									],
									"path": [
										"questions"
									]
								}
							},
							"response": []
						},
						{
							"name": "Post question as Dave",
							"event": [
								{
									"listen": "prerequest",
									"script": {
										"exec": [
											"const raw = pm.variables.replaceIn(\"{{$randomLoremParagraphs}}\");",
											"",
											"// Split on newlines, wrap each line in <p> tags, then join",
											"const html = raw",
											"  .split('\\n')",
											"  .filter(p => p.trim().length > 0)",
											"  .map(p => `<p>${p}</p>`)",
											"  .join('');",
											"",
											"pm.environment.set(\"escapedContent\", JSON.stringify(html).slice(1, -1));",
											"",
											"const allTags = [\"aspire\", \"dotnet\", \"keycloak\", \"wolverine\", \"ef-core\", \"postgresql\", \"signalr\", \"microservices\", \"nextjs\", \"typescript\"];",
											"",
											"// Pick 1 or 2 tags at random",
											"const shuffled = allTags.sort(() => 0.5 - Math.random());",
											"const selectedTags = shuffled.slice(0, Math.floor(Math.random() * 2) + 1);",
											"",
											"// Set as environment variable for use in body",
											"pm.environment.set('selectedTags', JSON.stringify(selectedTags));"
										],
										"type": "text/javascript",
										"packages": {}
									}
								},
								{
									"listen": "test",
									"script": {
										"exec": [
											"const question = pm.response.json();",
											"",
											"pm.test(\"Has properties\", function () {",
											"    pm.expect(question).to.have.property('id');",
											"});",
											"",
											"if (pm.test(\"Has properties\")) {",
											"    pm.globals.set('questionId', question.id);",
											"    pm.globals.set('questionTitle', question.title);",
											"}"
										],
										"type": "text/javascript",
										"packages": {}
									}
								}
							],
							"request": {
								"auth": {
									"type": "bearer",
									"bearer": [
										{
											"key": "token",
											"value": "{{dave_token}}",
											"type": "string"
										}
									]
								},
								"method": "POST",
								"header": [],
								"body": {
									"mode": "raw",
									"raw": "{\n    \"title\": \"{{$randomPhrase}}\",\n    \"content\": \"{{escapedContent}}\",\n    \"tags\": {{selectedTags}}\n}",
									"options": {
										"raw": {
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "{{gatewayDO}}/questions",
									"host": [
										"{{gatewayDO}}"
									],
									"path": [
										"questions"
									]
								}
							},
							"response": []
						},
						{
							"name": "Post question as Dave",
							"event": [
								{
									"listen": "prerequest",
									"script": {
										"exec": [
											"const raw = pm.variables.replaceIn(\"{{$randomLoremParagraphs}}\");",
											"",
											"// Split on newlines, wrap each line in <p> tags, then join",
											"const html = raw",
											"  .split('\\n')",
											"  .filter(p => p.trim().length > 0)",
											"  .map(p => `<p>${p}</p>`)",
											"  .join('');",
											"",
											"pm.environment.set(\"escapedContent\", JSON.stringify(html).slice(1, -1));",
											"",
											"const allTags = [\"aspire\", \"dotnet\", \"keycloak\", \"wolverine\", \"ef-core\", \"postgresql\", \"signalr\", \"microservices\", \"nextjs\", \"typescript\"];",
											"",
											"// Pick 1 or 2 tags at random",
											"const shuffled = allTags.sort(() => 0.5 - Math.random());",
											"const selectedTags = shuffled.slice(0, Math.floor(Math.random() * 2) + 1);",
											"",
											"// Set as environment variable for use in body",
											"pm.environment.set('selectedTags', JSON.stringify(selectedTags));"
										],
										"type": "text/javascript",
										"packages": {}
									}
								},
								{
									"listen": "test",
									"script": {
										"exec": [
											"const question = pm.response.json();",
											"",
											"pm.test(\"Has properties\", function () {",
											"    pm.expect(question).to.have.property('id');",
											"});",
											"",
											"if (pm.test(\"Has properties\")) {",
											"    pm.globals.set('questionId', question.id);",
											"    pm.globals.set('questionTitle', question.title);",
											"}"
										],
										"type": "text/javascript",
										"packages": {}
									}
								}
							],
							"request": {
								"auth": {
									"type": "bearer",
									"bearer": [
										{
											"key": "token",
											"value": "{{dave_token}}",
											"type": "string"
										}
									]
								},
								"method": "POST",
								"header": [],
								"body": {
									"mode": "raw",
									"raw": "{\n    \"title\": \"{{$randomPhrase}}\",\n    \"content\": \"{{escapedContent}}\",\n    \"tags\": {{selectedTags}}\n}",
									"options": {
										"raw": {
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "{{gatewayDO}}/questions",
									"host": [
										"{{gatewayDO}}"
									],
									"path": [
										"questions"
									]
								}
							},
							"response": []
						},
						{
							"name": "Post answer as Bob",
							"event": [
								{
									"listen": "prerequest",
									"script": {
										"exec": [
											"const raw = pm.variables.replaceIn(\"{{$randomLoremParagraphs}}\");",
											"",
											"// Split on newlines, wrap each line in <p> tags, then join",
											"const html = raw",
											"  .split('\\n')",
											"  .filter(p => p.trim().length > 0)",
											"  .map(p => `<p>${p}</p>`)",
											"  .join('');",
											"",
											"pm.environment.set(\"escapedContent\", JSON.stringify(html).slice(1, -1));"
										],
										"type": "text/javascript",
										"packages": {}
									}
								},
								{
									"listen": "test",
									"script": {
										"exec": [
											"const answer = pm.response.json();",
											"",
											"pm.test(\"Has properties\", function () {",
											"    pm.expect(answer).to.have.property('id');",
											"});",
											"",
											"if (pm.test(\"Has properties\")) {",
											"    pm.globals.set('answerId', answer.id);",
											"}"
										],
										"type": "text/javascript",
										"packages": {}
									}
								}
							],
							"request": {
								"auth": {
									"type": "bearer",
									"bearer": [
										{
											"key": "token",
											"value": "{{bob_token}}",
											"type": "string"
										}
									]
								},
								"method": "POST",
								"header": [],
								"body": {
									"mode": "raw",
									"raw": "{\n    \"content\": \"{{escapedContent}}\",\n    \"questionId\": \"{{questionId}}\"\n}",
									"options": {
										"raw": {
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "{{gatewayDO}}/questions/{{questionId}}/answers",
									"host": [
										"{{gatewayDO}}"
									],
									"path": [
										"questions",
										"{{questionId}}",
										"answers"
									]
								}
							},
							"response": []
						},
						{
							"name": "Post answer as Bob",
							"event": [
								{
									"listen": "prerequest",
									"script": {
										"exec": [
											"const raw = pm.variables.replaceIn(\"{{$randomLoremParagraphs}}\");",
											"",
											"// Split on newlines, wrap each line in <p> tags, then join",
											"const html = raw",
											"  .split('\\n')",
											"  .filter(p => p.trim().length > 0)",
											"  .map(p => `<p>${p}</p>`)",
											"  .join('');",
											"",
											"pm.environment.set(\"escapedContent\", JSON.stringify(html).slice(1, -1));"
										],
										"type": "text/javascript",
										"packages": {}
									}
								},
								{
									"listen": "test",
									"script": {
										"exec": [
											"const answer = pm.response.json();",
											"",
											"pm.test(\"Has properties\", function () {",
											"    pm.expect(answer).to.have.property('id');",
											"});",
											"",
											"if (pm.test(\"Has properties\")) {",
											"    pm.globals.set('answerId', answer.id);",
											"}"
										],
										"type": "text/javascript",
										"packages": {}
									}
								}
							],
							"request": {
								"auth": {
									"type": "bearer",
									"bearer": [
										{
											"key": "token",
											"value": "{{bob_token}}",
											"type": "string"
										}
									]
								},
								"method": "POST",
								"header": [],
								"body": {
									"mode": "raw",
									"raw": "{\n    \"content\": \"{{escapedContent}}\",\n    \"questionId\": \"{{questionId}}\"\n}",
									"options": {
										"raw": {
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "{{gatewayDO}}/questions/{{questionId}}/answers",
									"host": [
										"{{gatewayDO}}"
									],
									"path": [
										"questions",
										"{{questionId}}",
										"answers"
									]
								}
							},
							"response": []
						},
						{
							"name": "Accept answer for question",
							"event": [
								{
									"listen": "prerequest",
									"script": {
										"exec": [
											"const raw = pm.variables.replaceIn(\"{{$randomLoremParagraphs}}\");",
											"",
											"// Split on newlines, wrap each line in <p> tags, then join",
											"const html = raw",
											"  .split('\\n')",
											"  .filter(p => p.trim().length > 0)",
											"  .map(p => `<p>${p}</p>`)",
											"  .join('');",
											"",
											"pm.environment.set(\"escapedContent\", JSON.stringify(html).slice(1, -1));"
										],
										"type": "text/javascript",
										"packages": {}
									}
								},
								{
									"listen": "test",
									"script": {
										"exec": [
											"pm.test(\"Response returns 204\", function () {",
											"    pm.response.to.have.status(204);",
											"});"
										],
										"type": "text/javascript",
										"packages": {}
									}
								}
							],
							"request": {
								"auth": {
									"type": "bearer",
									"bearer": [
										{
											"key": "token",
											"value": "{{dave_token}}",
											"type": "string"
										}
									]
								},
								"method": "POST",
								"header": [],
								"body": {
									"mode": "raw",
									"raw": "",
									"options": {
										"raw": {
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "{{gatewayDO}}/questions/{{questionId}}/answers/{{answerId}}/accept",
									"host": [
										"{{gatewayDO}}"
									],
									"path": [
										"questions",
										"{{questionId}}",
										"answers",
										"{{answerId}}",
										"accept"
									]
								}
							},
							"response": []
						},
						{
							"name": "Post answer as Bob",
							"event": [
								{
									"listen": "prerequest",
									"script": {
										"exec": [
											"const raw = pm.variables.replaceIn(\"{{$randomLoremParagraphs}}\");",
											"",
											"// Split on newlines, wrap each line in <p> tags, then join",
											"const html = raw",
											"  .split('\\n')",
											"  .filter(p => p.trim().length > 0)",
											"  .map(p => `<p>${p}</p>`)",
											"  .join('');",
											"",
											"pm.environment.set(\"escapedContent\", JSON.stringify(html).slice(1, -1));"
										],
										"type": "text/javascript",
										"packages": {}
									}
								},
								{
									"listen": "test",
									"script": {
										"exec": [
											"const answer = pm.response.json();",
											"",
											"pm.test(\"Has properties\", function () {",
											"    pm.expect(answer).to.have.property('id');",
											"});",
											"",
											"if (pm.test(\"Has properties\")) {",
											"    pm.globals.set('answerId', answer.id);",
											"}"
										],
										"type": "text/javascript",
										"packages": {}
									}
								}
							],
							"request": {
								"auth": {
									"type": "bearer",
									"bearer": [
										{
											"key": "token",
											"value": "{{bob_token}}",
											"type": "string"
										}
									]
								},
								"method": "POST",
								"header": [],
								"body": {
									"mode": "raw",
									"raw": "{\n    \"content\": \"{{escapedContent}}\",\n    \"questionId\": \"{{questionId}}\"\n}",
									"options": {
										"raw": {
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "{{gatewayDO}}/questions/{{questionId}}/answers",
									"host": [
										"{{gatewayDO}}"
									],
									"path": [
										"questions",
										"{{questionId}}",
										"answers"
									]
								}
							},
							"response": []
						},
						{
							"name": "Post answer as Bob",
							"event": [
								{
									"listen": "prerequest",
									"script": {
										"exec": [
											"const raw = pm.variables.replaceIn(\"{{$randomLoremParagraphs}}\");",
											"",
											"// Split on newlines, wrap each line in <p> tags, then join",
											"const html = raw",
											"  .split('\\n')",
											"  .filter(p => p.trim().length > 0)",
											"  .map(p => `<p>${p}</p>`)",
											"  .join('');",
											"",
											"pm.environment.set(\"escapedContent\", JSON.stringify(html).slice(1, -1));"
										],
										"type": "text/javascript",
										"packages": {}
									}
								},
								{
									"listen": "test",
									"script": {
										"exec": [
											"const answer = pm.response.json();",
											"",
											"pm.test(\"Has properties\", function () {",
											"    pm.expect(answer).to.have.property('id');",
											"});",
											"",
											"if (pm.test(\"Has properties\")) {",
											"    pm.globals.set('answerId', answer.id);",
											"}"
										],
										"type": "text/javascript",
										"packages": {}
									}
								}
							],
							"request": {
								"auth": {
									"type": "bearer",
									"bearer": [
										{
											"key": "token",
											"value": "{{bob_token}}",
											"type": "string"
										}
									]
								},
								"method": "POST",
								"header": [],
								"body": {
									"mode": "raw",
									"raw": "{\n    \"content\": \"{{escapedContent}}\",\n    \"questionId\": \"{{questionId}}\"\n}",
									"options": {
										"raw": {
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "{{gatewayDO}}/questions/{{questionId}}/answers",
									"host": [
										"{{gatewayDO}}"
									],
									"path": [
										"questions",
										"{{questionId}}",
										"answers"
									]
								}
							},
							"response": []
						}
					]
				}
			]
		}
	],
	"event": [
		{
			"listen": "prerequest",
			"script": {
				"type": "text/javascript",
				"packages": {},
				"exec": [
					""
				]
			}
		},
		{
			"listen": "test",
			"script": {
				"type": "text/javascript",
				"packages": {},
				"exec": [
					""
				]
			}
		}
	],
	"variable": [
		{
			"key": "identityApi",
			"value": "http://localhost:6001"
		},
		{
			"key": "questionsApi",
			"value": "http://localhost:7001"
		},
		{
			"key": "gateway",
			"value": "http://localhost:8001"
		},
		{
			"key": "searchApi",
			"value": "http://localhost:7002"
		},
		{
			"key": "identityApiProd",
			"value": "https://id.overflow.local"
		},
		{
			"key": "gatewayProd",
			"value": "https://api.overflow.local"
		},
		{
			"key": "identityDO",
			"value": ""
		},
		{
			"key": "gatewayDO",
			"value": ""
		}
	]
}